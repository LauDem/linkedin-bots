Okta.API=function(o,a){var t={};var i=Okta.Q;var e=Okta._okta;var r=e.reduce;var s=Okta.fn.url.urlPartsToDomain;var u=Okta.fn.cookies.checkSessionCookie;var c=Okta.fn.cookies.getCookies;var k=Okta.fn.api.setSessionData;var f=Okta.fn.api.setAuthData;var h=Okta.fn.api.getToSettings;var v=function(n){return o.getVersion().then(function(e){return h(n,{backgroundVersion:e.backgroundVersion,contentVersion:e.contentVersion})})};t.getSessionCookie=function(e,n){if(e){return o.getSessionCookie()}else{return c(n,["sid","DT","idx"]).then(function(e){return r(e,function(e,n){e[n.name]=n.value;return e},{})})}};t.makeGetRequest=function(e,n){return t.getSessionCookie(n,s(e)).then(function(n){if(!u(n)){return i.reject("can not obtain session cookies, will not make the request: "+e.href)}return v(e.href).then(function(e){k(n,e.headers);return a.ajax(e)})})};t.makeGetRequestWithToken=function(t){var r=s(t);return o.getAuthToken().then(function(e){var n=e[r];if(!n||!n["access_token"]||n["access_token"].expiresAt<Math.floor(Date.now()/1e3)){return i.reject("invalid access token on "+r)}return v(t.href).then(function(e){f(n,e.headers);return a.ajax(e)})})};return t};