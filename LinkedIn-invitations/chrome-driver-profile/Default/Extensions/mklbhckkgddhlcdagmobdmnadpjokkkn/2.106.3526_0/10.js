"use strict";(self.webpackChunkguru_ui=self.webpackChunkguru_ui||[]).push([[10],{1708:function(e,t,n){var r=n(2514),a=n(29857),o=n(61067),l=n(25108);const i=new r.Z({name:o.Z.getName()}),s=a.Z.getFlux().actions[i.name];s||l.error("error creating actions"),t.Z=s},35874:function(e,t,n){var r=n(57922),a=n(29857),o=n(47421),l=n(43696),i={addCardDiff:function(e,t,n){var a="/cards/"+e+"/versions/"+t,o={cardId:e,version:"removed"},i="/cards/"+e+"/versions/"+n,s={cardId:e,version:"added"},c={type:"GET"};r.ZP.callApi(this,l.LOAD_CARD_HISTORY_VERSION,a,c,o),r.ZP.callApi(this,l.LOAD_CARD_HISTORY_VERSION,i,c,s)},discardCardDiff:function(e){this.dispatch(o.DISCARD_CARD_DIFF,{cardId:e})}};t.Z=a.Z.addActions({carddiff:i})},11514:function(e,t,n){var r=n(57922),a=n(29857),o=n(43696),l={loadCardHistory:function(e){var t="/cards/"+e+"/versions",n=t+"/lastVerified",a={type:"GET"},l={cardId:e};r.ZP.callApi(this,o.LOAD_CARD_HISTORY,t,a,l),r.ZP.callApi(this,o.LOAD_CARD_HISTORY_LAST_VERIFIED,n,a,l)}};t.Z=a.Z.addActions({cardhistory:l})},31306:function(e,t,n){var r=n(2514),a=n(12713),o=n(29857),l=n(25108);const i=new r.Z({name:a.CardsLite}),s=o.Z.getFlux().actions[i.name];s||l.error("error creating actions"),t.Z=s},53148:function(e,t,n){var r=n(57922),a=n(47421),o=n(29857),l=n(25518),i=n(47482),s=n(95587);const{_ADD_EDIT_DATA_ITEM:c,_REMOVE_EDIT_DATA_ITEM:d}=a.default;var u=n(43696);function h(e){var t=i.ZP.getById(e);return t&&t.data&&t.data.id?t.data.id:e}var p={loadFactBoards:function(e){const t=h(e);if(t.startsWith("new-"))return;var n="/cards/"+t+(s.Z.hasNavarchyPhaseTwoAllowed()?"/folders/":"/boards/");(function(e){const t=i.ZP.getById(e);return!!t&&t.data.archived})(e)||r.ZP.callApi(this,u.LOAD_FACTBOARDS,n,{type:"GET"},{factId:e})},addFactBoards:function(e,t){const n=s.Z.hasNavarchyPhaseTwoAllowed()?"/folders/":"/boards/";var a="/cards/"+h(e)+n,o={type:"POST",contentType:"application/json",data:JSON.stringify(t)};r.ZP.callApi(this,u.ADD_FACTBOARDS,a,o,{factId:e,board:t})},deleteFactBoard:function(e,t,n){const a=s.Z.hasNavarchyPhaseTwoAllowed()?"/folders/":"/boards/";var o="/cards/"+h(e)+a+t;r.ZP.callApi(this,u.DELETE_FACTBOARD,o,{type:"DELETE"},{factId:e,boardId:t,collectionId:n})},addEditDataItem(e,t){this.dispatch(l.Z.getName()+c,{filterId:e,item:t})},removeEditDataItem(e,t){this.dispatch(l.Z.getName()+d,{filterId:e,id:t})}};t.Z=o.Z.addActions({factboards:p})},60500:function(e,t,n){var r=n(2514),a=n(12713),o=n(29857),l=n(25108);const i=new r.Z({name:a.GroupMembers}),s=o.Z.getFlux().actions[i.name];s||l.error("error creating actions"),t.Z=s},43396:function(e,t,n){var r=n(2514),a=n(12713),o=n(29857),l=n(25108);const i=new r.Z({name:a.QuestionCollections}),s=o.Z.getFlux().actions[i.name];s||l.error("error creating actions"),t.Z=s},57645:function(e,t,n){n.d(t,{x:function(){return x},m:function(){return S}});var r=n(67294),a=n(94184),o=n.n(a),l=n(45697),i=n.n(l),s=(n(33948),n(13037)),c=n(3486),d=n(54159),u=n(35288),h=n(13011),p=n(66674),m=n(87159),g=n(9248),f=n(77917);function v(e){let{content:t,icon:n,iconColor:a,iconSize:l,isSelected:i,menuItems:d,activeTab:v,handleClick:E}=e;const[b]=(0,h.Z)(c.Z.KNOWLEDGEALERTS_ALLOWED),y=d.find((e=>e.id===v)),C=o()("ghq-tab-label",{"ghq-tab-label-active":i,"ghq-tab-label-active-highlight":i&&b,"ghq-tab-icon-container":b}),[N,T]=r.useState(!1),S=i?g.ZP.Coulis:a,k=r.useRef(null),x=(0,p.Z)(((e,t)=>{t.current&&T(!1)}),[k]);return r.createElement("div",{className:"ghq-TabWithDropdown"},r.createElement("div",{tabIndex:0,role:"button",className:C,ref:k,"aria-expanded":N,"aria-label":"toggle more filters dropdown",onClick:()=>T((e=>!e)),onKeyDown:e=>{e.key===m.R.Enter&&T((e=>!e)),e.key===m.R.Escape&&T(!1)}},r.createElement(f.ZP,{icon:n,iconSize:l,iconColor:S,iconPosition:f.yT.Right},t)),N&&r.createElement("div",{ref:x,className:"ghq-TabWithDropdown__menu-container"},r.createElement(s.ZP,{className:"ghq-TabWithDropdown__menu"},d.map((e=>{if(e.type===u.Z.LABEL_ITEM)return r.createElement(s.Lb,{key:e.id},e.label);{const t=i&&y&&e.label===y.label;return r.createElement(s.sN,{selectable:!0,selected:t,key:e.id,value:e,onSelect:e=>{E(e),T(!1)}},e.label)}})))))}v.propTypes={activeTab:i().string,content:i().node,icon:i().string,iconColor:i().string,iconSize:i().number,isSelected:i().bool,handleClick:i().func,menuItems:i().arrayOf(i().shape({id:i().string,label:i().string})).isRequired},v.defaultProps={activeTab:d.Z.RECENT_CARDS_VIEWED,icon:null,iconColor:g.ZP.Vacuum,iconSize:14,handleClick:()=>{}};var E=n(33200),b=n(43814),y=n(39429);const C={left:"left",right:"right",center:"center",spaceBetween:"space-between",spaceAround:"space-around"},N={activeTab:i().string,onChange:i().func,isLoading:i().bool,alignment:i().oneOf(Object.values(C)),tabs:i().arrayOf(i().shape({id:i().string.isRequired,label:i().string,type:i().string,items:i().arrayOf(i().shape({id:i().string,label:i().string}))}))},T={activeTab:i().string};class S extends r.PureComponent{constructor(e,t){super(e,t),this.state={previousTab:e.activeTab}}getChildContext(){return{activeTab:this.props.activeTab}}handleChange(e){const{activeTab:t,onChange:n}=this.props;t!==e&&(this.setState({previousTab:t}),n(e))}render(){const{tabs:e,children:t,isReloading:n,isLoading:a,tabContent:l,hasKnowledgeAlerts:i,activeTab:s,alignment:c}=this.props;let d=s;const h=E.ZP.FORCE_MOBILE_VIEW||E.ZP.USE_EMBEDDED_GURU,p=i&&!h,g=o()("ghq-toggle-panel-header","ghq-is-aligned-".concat(c)),f=a?r.createElement("div",{className:"ghq-tabs-container__loader"},r.createElement(y.ZP,null)):t||l(d),C=o()("ghq-tabs-container",this.props.className);return r.createElement("div",{className:C,style:this.props.style,"data-testid":"tabs"},r.createElement("ul",{className:g},e.map((e=>{n&&(d=this.state.previousTab);const t=e.type&&e.type!==u.Z.TAB?e.items.some((e=>e.id===s)):e.id===s,a=o()("ghq-tab-label",{"ghq-tab-label-active":t,"ghq-tab-label-active-highlight":t&&(p||(0,b.tq)()),"ghq-tab-icon-container":p});if(!e.type||e.type===u.Z.TAB)return r.createElement("li",{tabIndex:0,role:"tab","aria-label":e.id,key:e.id,className:a,onClick:()=>{this.handleChange(e.id)},onKeyDown:t=>{t.key===m.R.Enter&&this.handleChange(e.id)}},e.content||e.label);if(e.type===u.Z.DROPDOWN){const n=e.content||e.label;return r.createElement(v,{key:e.id,popoverFilterId:"tab-with-dropdown-".concat(e.id),content:n,icon:"chevron-down",isSelected:t,menuItems:e.items,handleClick:e=>{this.handleChange(e.id)},activeTab:s})}}))),f)}}S.propTypes=N,S.childContextTypes=T;const k={activeTab:i().string};S.alignments=C,S.defaultProps={alignment:C.left};class x extends r.PureComponent{render(){const e=o()("ghq-tab-panel",this.props.className);return this.context.activeTab===this.props.id&&r.createElement("div",{className:e,ref:this.props.ref,"data-testid":this.props.id},this.props.children)}}x.contextTypes=k},1747:function(e,t,n){var r=n(67294),a=n(94184),o=n.n(a),l=n(27361),i=n.n(l),s=n(43063),c=n.n(s),d=n(45697),u=n.n(d),h=n(73935),p=n(32950),m=n(90208),g=n(39352),f=n(11609),v=n(99303),E=n(93390),b=n(94216),y=n(59426),C=n(66934),N=n(47640);function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},T.apply(this,arguments)}const S=e=>{let{popoverFilterId:t,menuIsReloading:n,highlightedIndex:a,filteredMenuItems:o,handleItemClick:l,setHighlightedIndex:i,onMount:s}=e;return o&&0!==o.length?r.createElement(g.Z,{popoverFilterId:t},r.createElement("div",{className:"ghq-chip-input-menu-popover"},r.createElement(E.Z,{isReloading:n}),r.createElement(b.Z,{className:"ghq-chip-input-menu",handleItemClick:l,highlightedIndex:a,items:o,setHighlightedIndex:i,onMount:s}))):r.createElement("noscript",null)};class k extends r.Component{constructor(e){var t;super(e),t=this,this.findNextHighlightable=(e,t)=>{let n=e[t]||e[0];for(;!n||"menu-item"!==n.type;){if(++t>=e.length)return 0;n=e[t]}return t},this.filterMenuItems=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.props;const{filterMenuItems:n}=t.props;if(n&&e.menuItems.length>0)return n(e);const{inputValue:a,menuItems:l,chips:s,notExactMatchItem:d,noResultsItem:u,ignoredStartingCharacters:h}=e;let p=!1,m=c()(l,(e=>"menu-header"!==e.type&&s.some((t=>t.id===e.value)))),g=a.toLowerCase().trim();return h.includes(g[0])&&(g=g.substring(1)),m=m.filter((e=>{if("menu-header"===e.type||"waypoint"===e.type)return!0;const t=i()(e,"meta.label","").toLowerCase()||e.label.toLowerCase(),n=e.label.toLowerCase().indexOf(g),a=n+g.length;if(-1===n)return!1;const l=e.label.substring(0,n),s=e.label.substring(n,a),c=e.label.substring(a);if(p=!!p||t===g,!e.rawContent){const t=o()("ghq-menuitem-label",{"ghq-no-description":!e.description});e.rawContent=r.createElement("div",{className:t},r.createElement("span",{className:"ghq-menuitem-label-name"},l,r.createElement("b",null,s),c),r.createElement("span",{className:"ghq-menuitem-label-description"},e.description))}return!0})),p||(p=s.some((e=>(i()(e,"meta.label","").toLowerCase()||e.label.toLowerCase())===g))),m=m.filter(((e,t)=>{const n=m[t+1]||{};return"menu-header"!==e.type||"menu-item"===n.type})),0===m.length&&u&&m.push(u),!p&&""!==a&&d&&m.push(d),m},this.dismissMenu=()=>{this.props.closePopover()},this.renderCurrentChips=()=>{const{chips:e}=this.props;return 0===e.length?null:this.props.chips.map((e=>{const t=o()("ghq-chip-input-chip",e.className),{icon:n,iconSize:a,id:l,image:i,label:s,color:c,removeChip:d,chipType:u}=e;return r.createElement(m.Z,{className:t,icon:n,iconSize:a,id:l,color:c,image:i,key:l,label:s,removeChip:d,chipType:u})}))},this.onBlur=()=>{this.setState({hasFocus:!1})},this.onFocus=()=>{this.setState({hasFocus:!0}),this.props.handleFocus()},this.onClick=()=>{this.props.openPopover()},this.onKeyDown=e=>{let{highlightedIndex:t,filteredMenuItems:n}=this.state;const{handleMenuItemSelect:r,chips:a,clearInput:o,popoverIsOpen:l,closePopover:i,openPopover:s}=this.props,{Enter:c,ArrowUp:d,ArrowDown:u,Tab:h,Escape:p,Backspace:m}=y.ZP;let g,f,v=l;switch(e.keyCode){case c:e.stopPropagation();const l=n[t];l&&v&&(r(l),v=!1,o&&o());break;case d:e.stopPropagation(),e.preventDefault(),v?(g=t-1,f=n[g]||{},"menu-header"===f.type&&g--,g<0&&(g=t),t=g):(v=!0,t=this.findNextHighlightable(n,0));break;case u:if(e.stopPropagation(),e.preventDefault(),v)for(t===n.length-1?t=n.length-1:t++,f=n[t];!f||"menu-item"!==f.type;){if(t++,t>=n.length){t=0;break}f=n[t]}else v=!0,t=this.findNextHighlightable(n,0);break;case h:case p:e.stopPropagation();break;case m:if(e.stopPropagation(),""===e.target.value&&a.length>0){const e=a[a.length-1];e.removeChip&&e.removeChip(e.id),v=!1}break;default:v=!0}v!==l&&(v?s():i()),this.setState({highlightedIndex:t})},this.renderInput=()=>r.createElement("div",{className:"ghq-chip-input-input-container",key:"ChipInputInput"},this.props.inputPlaceHolderIcon?r.createElement(f.Z,{className:"ghq-chip-input-placeholder-icon",size:18,icon:this.props.inputPlaceHolderIcon}):null,r.createElement(v.Z,{id:this.props.inputId,className:"ghq-input ghq-chip-input-live-input",placeholder:this.props.inputPlaceHolderText,ref:this.props.refKey+"LiveInput",value:this.props.inputValue,focusOnMount:this.props.focusOnMount,handleAction:this.props.handleAction,handleInputChange:this.props.handleInputChange,onBlur:this.onBlur,onFocus:this.onFocus,onKeyDown:this.onKeyDown,onClick:this.onClick,onMouseDown:this.props.onMouseDown})),this.renderContent=()=>{const e=this.renderCurrentChips(),t=this.renderInput();return r.createElement("div",{className:"ghq-chip-input-content"},e,t)},this.renderActionButton=()=>this.props.handleButtonClick?r.createElement("div",{className:"ghq-chip-input-button-container"},r.createElement(N.Z,{kind:N.Z.kinds.PRIMARY,icon:this.props.buttonIcon,disabled:0===this.props.chips.length,"data-testid":"ChipActionButton",onClick:this.props.handleButtonClick},this.props.buttonValue)):null,this.handleItemClick=e=>{const{filteredMenuItems:t}=this.state,{clearInput:n}=this.props;this.props.handleMenuItemSelect(e),this.dismissMenu();const r=this.findNextHighlightable(t,0);n&&n(),this.setState({highlightedIndex:r})},this.setHighlightedIndex=e=>{this.setState({highlightedIndex:e})},this.updatePopoverActions=()=>{p.Z.mergeData(this.props.popoverFilterId,{anchorProps:{poll:!0,target:this.popoverAnchorTarget,sameWidthAsTarget:!0}})},this.setPopoverAnchorTarget=e=>{this.popoverAnchorTarget=e,this.updatePopoverActions()};const n=this.filterMenuItems(),a=this.findNextHighlightable(n,0);this.state={filteredMenuItems:n,highlightedIndex:a,hasFocus:!1}}UNSAFE_componentWillReceiveProps(e){const{inputValue:t,popoverIsOpen:n}=this.props,{inputValue:r,popoverIsOpen:a}=e,o={filteredMenuItems:this.filterMenuItems(e)};t!==r&&(o.highlightedIndex=this.findNextHighlightable(o.filteredMenuItems,0)),n&&!a&&(o.highlightedIndex=0),this.setState(o)}componentWillUnmount(){const{closePopover:e}=this.props;e()}componentDidUpdate(e){const{chips:t}=e,{refKey:n}=this.props,r=h.findDOMNode(this.refs[n+"LiveInput"]);this.props.chips.length!==t.length&&r.focus(),this.props.popoverFilterId!==e.popoverFilterId&&this.updatePopoverActions()}render(){const{className:e,showTooltip:t,hideTooltip:n,menuIsReloading:a,popoverFilterId:l,onMount:i}=this.props,{filteredMenuItems:s,highlightedIndex:c}=this.state,d=o()(e,"ghq-chip-input",{"ghq-chip-input-active":this.state.hasFocus||this.props.inputValue||this.props.chips.length>0,"ghq-chip-input-disabled":this.props.isDisabled}),u=this.renderContent(),h=this.renderActionButton();return r.createElement("div",{className:d,ref:this.setPopoverAnchorTarget,onMouseEnter:t,onMouseLeave:n},r.createElement("div",{className:"ghq-chip-input-content-and-button-container"},u,h),r.createElement(S,{popoverFilterId:l,menuIsReloading:a,highlightedIndex:c,filteredMenuItems:s,handleItemClick:this.handleItemClick,setHighlightedIndex:this.setHighlightedIndex,onMount:i}))}}k.propTypes={handleAction:u().func.isRequired,handleInputChange:u().func.isRequired,handleMenuItemSelect:u().func.isRequired,inputValue:u().string.isRequired,refKey:u().string.isRequired,isDisabled:u().bool,buttonIcon:u().string,buttonValue:u().string,chips:u().array,className:u().string,filterMenuItems:u().func,handleButtonClick:u().func,handleFocus:u().func,ignoredStartingCharacters:u().array,inputId:u().string,inputPlaceHolderIcon:u().string,inputPlaceHolderText:u().string,menuItems:u().array,menuIsReloading:u().bool,clearInput:u().func,focusOnMount:u().bool,onMount:u().func,autoFocusOpensMenu:u().bool},k.defaultProps={chips:[],maxHeight:300,notExactMatchItem:null,noResultsItem:null,ignoredStartingCharacters:[],isDisabled:!1,focusOnMount:!1,handleFocus:()=>{},autoFocusOpensMenu:!1};const x=(0,C.Z)(k);class L extends r.Component{render(){return r.createElement(x,T({},this.props,{popoverFilterId:this.props.refKey}))}}t.Z=L},30129:function(e,t,n){n(33948);var r=n(67294),a=n(94184),o=n.n(a),l=n(45697),i=n.n(l),s=n(99355);const c={className:i().string,fullscreen:i().bool,onClick:i().func};class d extends r.Component{constructor(){var e;super(...arguments),e=this,this.handleClick=function(){const{onClick:t}=e.props;for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];t&&r[0].target===e.glass&&t(...r)}}render(){const{className:e,fullscreen:t,children:n}=this.props,a=o()("ghq-glass",e,{"ghq-is-fullscreen":t});return t?r.createElement(s.Z,null,r.createElement("div",{ref:e=>this.glass=e,className:a,onClick:this.handleClick},n)):r.createElement("div",{"data-testid":"Glass",ref:e=>this.glass=e,className:a,onClick:this.handleClick},n)}}d.propTypes=c,t.Z=d},53442:function(e,t,n){n(33948);var r=n(67294),a=n(94184),o=n.n(a),l=n(45697),i=n.n(l),s=n(59806),c=n(6759),d=n(11609),u=n(6793);function h(){return h=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}class p extends r.PureComponent{constructor(){super(...arguments),this.handleChange=e=>{const{handleInputChange:t,id:n,index:r}=this.props;t(n,e.target.value,r)},this.handleClick=()=>this.props.handleClick(),this.setInputRef=e=>{this.input=e,this.props.autofocus&&e&&setTimeout((()=>e.focus()),0),this.props.autoHighlight&&e&&setTimeout((()=>e.select()),0)},this.copyValue=()=>{u.Z.copy(this.getValue(),{plain:this.getValue()}),this.input.select(),s.Z.createToast({content:"Copied to clipboard"})},this.getValue=()=>this.input.value}render(){const{isUncontrolled:e,className:t,disabled:n,readOnly:a,invalid:l,button:i,copyable:s,handleClick:u,handleInputChange:p,textarea:m,rows:g,value:f,...v}=this.props,E=o()("ghq-input",t,{"ghq-input-active":f&&f.length>0,"ghq-input-disabled":n||a,"ghq-input-error":l,"ghq-input-textarea":m});return m?r.createElement("textarea",h({},v,{disabled:n,value:f,ref:this.setInputRef,className:E,rows:g||5,onChange:this.handleChange})):i?r.createElement("div",{className:"ghq-input-with-button"},r.createElement("input",h({},v,{disabled:n,value:f,ref:this.setInputRef,className:E,onChange:this.handleChange})),r.createElement(c.Z,{primary:!0,className:f&&f.length>0?"ghq-input-active":"",value:"Submit",onClick:this.handleClick})):s?r.createElement("div",{className:"ghq-input-copy-wrapper"},r.createElement("input",h({},v,{disabled:n,value:f,ref:this.setInputRef,className:E,onChange:this.handleChange})),r.createElement(d.Z,{size:18,icon:"copy",className:"ghq-input-copy",onClick:this.copyValue})):r.createElement("input",h({},v,{disabled:n,value:f,ref:this.setInputRef,className:E,onChange:this.handleChange}))}}t.Z=p,p.propTypes={id:i().string,type:i().string.isRequired,button:i().bool,textarea:i().bool,rows:i().number,className:i().string,handleClick:i().func,handleInputChange:i().func,isUncontrolled:i().bool,copyable:i().bool,placeholder:i().string},p.defaultProps={handleInputChange:()=>{},disabled:!1,readOnly:!1,invalid:!1,id:""}},73544:function(e,t,n){n.d(t,{A:function(){return I},Ai:function(){return w}});n(33948);var r=n(67294),a=(n(60285),n(41637),n(81510)),o=n(98052),l=n(77110),i=n(2514),s=n(29857),c=n(84801),d=n(12713),u=n(27171);c.Z.register(d.AttachmentsUpload,{POST:{path:"/attachments/upload",contentType:"multipart/form-data"}});const h=new u.Z({dataType:d.OBJECT,name:d.AttachmentsUpload});h.createStore();var p=s.Z.addStore(h.store),m=n(25108);const g=new i.Z({name:p.getName()}),f=s.Z.getFlux().actions[g.name];f||m.error("error creating actions");var v=f,E=n(47111);var b=n(36492),y=n(64469);const C=new(n(27998).Z),N=e=>{let{draftId:t,message:n}=e;return C.post({path:"/drafts/".concat(t,"/access"),body:{...n&&{message:n}}})},T=e=>{let{draftId:t,attachmentId:n}=e;return C.post({path:"/drafts/".concat(t,"/attachments"),body:{attachmentId:n}})};var S=e=>{const{data:t,isLoading:n,isError:r}=(0,b.a)(["draft",e.draftId],(()=>{return t=e.draftId,C.get({path:"/drafts/".concat(t)});var t})),a=(0,y.D)(N,{onSuccess:()=>{e.onPostSuccess&&e.onPostSuccess()}}),o=(0,y.D)(T);return{draftData:t,draftIsLoading:n,draftHasError:r,requestAccess:a.mutate,uploadAttachment:o.mutate}},k=n(13921),x=n(30303);function L(e){var t;const{card:n}=(0,k.RC)(),i=null===(t=n.editorSession)||void 0===t?void 0:t.editingDraftId,[{data:s,status:c},d]=function(e){const{filter:t}=e,[n,r]=(0,E.Z)({filterId:t,store:p,actions:v});return[n,r]}({filter:e}),{uploadAttachment:u}=S({draftId:i});return(0,r.useEffect)((()=>{c===l.S.Loaded&&u({draftId:i,attachmentId:s.attachmentId})}),[c]),(0,r.useEffect)((()=>()=>d.clearStore()),[]),e=>a.ZP.isExtension()?(e=>new Promise(((t,n)=>{const r=[e],a=URL.createObjectURL(new Blob(r,{type:"image/png"}));x.Z.tellExtension(o.UE,JSON.stringify({file:a,filename:e.name,mimeType:e.type}),(e=>{let{error:r,...a}=e;r?n(a):t({url:a.link,fileName:a.filename})}))})))(e):((e,t)=>new Promise(((n,r)=>{const a=new FormData;a.append("file",e);const o={data:a,success:e=>n({fileName:e.data.filename,url:e.data.link}),error:e=>r(e)};t.post(o)})))(e,d)}const _={contextState:{popoverMode:"default",entities:{},cardId:"",popoverData:{}},getContextState:()=>({entities:{},popoverMode:"default",cardId:"",popoverData:{}}),setContextState:()=>{},openFileDialog:()=>{},openImageDialog:()=>{},upsertEntity:()=>{},upload:()=>Promise.resolve({url:"",fileName:""})},I=(0,r.createContext)(_),w=e=>{const t=(0,r.useRef)(null),n=(0,r.useRef)(),a=(0,r.useRef)(null),o=(0,r.useRef)(),l=L(e.id),[i,s]=(0,r.useState)({..._.contextState,cardId:e.id}),c=(0,r.useRef)(i);c.current=i;const d={upsertEntity:(e,t)=>{s((n=>{var r;return{...n,entities:{...n.entities,[e]:{...null===(r=n.entities)||void 0===r?void 0:r[e],...t}}}}))},openFileDialog:e=>{var r;null===(r=t.current)||void 0===r||r.click(),n.current=e},openImageDialog:e=>{var t;null===(t=a.current)||void 0===t||t.click(),o.current=e},upload:l,getContextState:()=>c.current,contextState:i,setContextState:s};return r.createElement(r.Fragment,null,r.createElement("input",{accept:"image/*",style:{display:"none"},"data-testid":"guru-editor-image-input",ref:a,type:"file",onChange:e=>{var t;null===(t=o.current)||void 0===t||t.call(o,e),null!=a.current&&(a.current.value="")}}),r.createElement("input",{accept:"*/*",style:{display:"none"},"data-testid":"guru-editor-file-input",ref:t,type:"file",onChange:e=>{var r;null===(r=n.current)||void 0===r||r.call(n,e),null!=t.current&&(t.current.value="")}}),r.createElement(I.Provider,{value:d},e.children))}},43919:function(e,t,n){n.d(t,{y:function(){return o}});var r=n(67294),a=n(73544);function o(){return(0,r.useContext)(a.A)}},91087:function(e,t,n){n.d(t,{$4:function(){return f},tV:function(){return m},oS:function(){return g}});n(33948);var r=n(43209),a=n(23602),o=n(2697),l=n(53694);const i=(0,a.p)({children:[(0,o.V)({text:""})]});function s(e,t){const[,n]=[...r.NB.texts(e,{from:t})][0],a={path:n,offset:0};return{anchor:a,focus:a}}function c(e,t,n){const r=[...e],a=r.pop();return[...r,a+t,...n]}function d(e,t,n){return s(e,c(t,n,[]))}function u(e){if((0,l.CQ)(e))return"convertible";if(r.W_.isElement(e)){if((0,l.OC)(e))return"void";if((0,l.js)(e)||(t=e,r.W_.isElement(t)&&"code-block"===t.type))return"nested"}var t;throw new Error("Unhandled root element type of ".concat(JSON.stringify(e,null,2)))}var h=n(73443),p=n(70745);function m(e,t){return null==e.selection?null:Array.from(r.ML.nodes(e,{at:e.selection,match:t}))}function g(e,t,n){const a=n||e.selection;r.ML.withoutNormalizing(e,(()=>{if(null!=a){Array.from(r.ML.nodes(e,{at:a})).reverse().forEach((n=>{let[a,o]=n;if((0,l.CQ)(a)){const n=t(a),l=Object.keys(n),i=Object.keys(a).filter((e=>!l.includes(e)&&!["children","text"].includes(e)));r.YR.unsetNodes(e,i,{at:o}),r.YR.setNodes(e,n,{at:o});const s=r.ML.range(e,o),c=(0,p.Q)(e,s),d=r.ML.pathRef(e,o);c.length>0&&"list-item"!==n.type&&c.forEach((()=>{null!=d.current&&r.YR.liftNodes(e,{at:d.current})}))}}))}}))}const f={isInside:(e,t)=>!!r.ML.above(e,{match:e=>r.W_.isElement(e)&&e.type===t}),insertRootBlock:function(e,t){const n=e.selection||s(e,[0]),a=r.ML.above(e,{at:n.anchor.path,match:l._x});if(null==a)throw new Error("Couldn't find a place to insert block");const[o,h]=a,p=u(t),m="void"===p;switch(u(o)){case"convertible":const a=r.ML.isStart(e,n.anchor,h),l=r.ML.isEnd(e,n.anchor,h),u=r.ML.isEmpty(e,o);if(r.YR.insertNodes(e,t),u)return r.YR.removeNodes(e,{at:h}),void(m&&(r.YR.insertNodes(e,i,{at:c(h,1,[])}),r.YR.setSelection(e,d(e,h,1))));if(l&&m&&r.YR.insertNodes(e,i,{at:c(h,2,[])}),m){const t=d(e,h,a?1:2);r.YR.setSelection(e,t)}return;case"void":case"nested":if("void"!==p){if("nested"===p){const n=c(h,1,[]);r.YR.insertNodes(e,t,{at:c(h,1,[])});const a=s(e,n);return void r.YR.setSelection(e,a)}throw new Error("Does not appear to be an insertable root element")}r.YR.insertNodes(e,[t,i],{at:c(h,1,[])}),r.YR.setSelection(e,d(e,h,2));break;default:throw new Error("Unhandled")}},insertCodeBlock(e,t){f.insertRootBlock(e,{type:"code-block",language:t,children:[{type:"code-line",children:[{text:""}]}]})},insertHorizontalRule(e){f.insertRootBlock(e,{type:"divider",children:[{text:""}]})},insertCardLink(e,t,n,a){const o=r.e6.isExpanded(e.selection),i={type:t,id:n,children:o?[]:[{text:a}]};o?(r.YR.unwrapNodes(e,{match:e=>(0,l.jI)(e)}),r.YR.wrapNodes(e,i,{split:!0}),r.YR.collapse(e,{edge:"end"})):r.YR.insertNodes(e,i)},insertLink(e,t,n,a){const o=r.e6.isExpanded(e.selection),i={type:t,url:n,children:o?[]:[{text:a}]};o?(r.YR.unwrapNodes(e,{match:e=>(0,l.jI)(e)}),r.YR.wrapNodes(e,i,{split:!0}),r.YR.collapse(e,{edge:"end"})):r.YR.insertNodes(e,i)},insertNewline(e){const t=e.selection;if(t){const[n]=Array.from(r.ML.nodes(e,{at:t,match:n=>{const a=r.ML.parent(e,t);return r.W_.isElement(n)&&r.ML.isInline(e,n)||r.xv.isText(n)&&!r.ML.isEnd(e,t.anchor,a[1])}}));n&&r.ML.isEnd(e,t.anchor,n[1])&&r.YR.move(e,{unit:"offset",distance:1})}e.insertText("\n")},removeAllMarks(e){l.Rz.forEach((t=>{r.ML.removeMark(e,t)}))},toggleMark(e,t,n){const a=function(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{selection:a}=e;if(!a||!r.ML.hasPath(e,a.anchor.path)||!r.ML.hasPath(e,a.focus.path))return!1;const o=r.ML.marks(e);return!!o&&o[t]===n}(e,t,n);a?r.ML.removeMark(e,t):r.ML.addMark(e,t,n)},setConvertibleElement:g,setHeading(e,t){g(e,(()=>({type:"heading",level:t})))},setParagraph(e){g(e,(()=>({type:"p"})))},setBlockQuote(e){g(e,(()=>({type:"block-quote"})))},toggleHeading(e,t){const n=m(e,l.CQ);if(null==n)return;n.every((e=>{let[n]=e;return r.W_.isElement(n)&&"heading"===n.type&&n.level===t}))?f.setParagraph(e):g(e,(()=>({type:"heading",level:t})))},breakOutOfInlineLink(e){if(null==e.selection)return;const t=(0,h.Tt)({editor:e,type:"guru-card"}),n=(0,h.Tt)({editor:e,type:"link"}),a=t.length&&r.ML.isEnd(e,e.selection.focus,t[t.length-1][1]),o=n.length&&r.ML.isEnd(e,e.selection.focus,n[n.length-1][1]);(a||o)&&r.YR.move(e,{unit:"offset",edge:"end"})}}},53694:function(e,t,n){n.d(t,{Rz:function(){return r},bA:function(){return a.bA},Je:function(){return a.Je},CQ:function(){return a.CQ},cc:function(){return a.cc},kA:function(){return a.kA},jI:function(){return a.jI},nq:function(){return a.nq},OD:function(){return a.OD},ev:function(){return a.ev},dn:function(){return a.dn},js:function(){return a.js},_x:function(){return a._x},Dx:function(){return a.Dx},Ze:function(){return a.Ze},N1:function(){return a.N1},gB:function(){return a.gB},OC:function(){return a.OC}});const r=["bold","italic","code","highlight","strikethrough","underline","color","children","orderedMarks"];var a=n(4952)},4952:function(e,t,n){n.d(t,{CQ:function(){return v},Dx:function(){return O},Je:function(){return I},N1:function(){return Z},OC:function(){return s},OD:function(){return m},Ze:function(){return D},_x:function(){return b},bA:function(){return L},cc:function(){return p},dn:function(){return k},ev:function(){return T},gB:function(){return M},jI:function(){return d},js:function(){return C},kA:function(){return h},nq:function(){return g}});n(33948);var r=n(43209);function a(){return function(e,t){return function(t){return r.W_.isElement(t)&&e.includes(t.type)}}}function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t}const l=o("title","p","heading","block-quote"),i=o("divider","image","video","iframe"),s=a()(i,!0),c=o("link","file"),d=a()(c,!0),u=o(...c,"image","guru-card"),h=a()(u,!0),p=a()(o("guru-card"),!0),m=a()(o("list-item"),!0),g=a()(o("list"),!0),f=o(...l,"list-item"),v=a()(f,!0),E=o(...f,"divider","video","iframe","table","list","code-block","markdown"),b=a()(E,!0),y=o("table","code-line","markdown","list-item"),C=a()(y,!0),N=o("markdown"),T=a()(N,!0),S=o("markdown-line"),k=a()(S,!0),x=o("code-block"),L=a()(x,!0),_=o("code-line"),I=a()(_,!0),w=o("title"),M=a()(w,!0),P=o("table"),D=a()(P,!0),A=o("td"),O=a()(A,!0),R=o("tr"),Z=a()(R,!0)},73443:function(e,t,n){n.d(t,{aM:function(){return _},_F:function(){return f},wf:function(){return p},XG:function(){return N},C0:function(){return P},es:function(){return A},Tt:function(){return m},OY:function(){return T},wg:function(){return u},E4:function(){return q},Id:function(){return F},iL:function(){return g},Zt:function(){return S},aZ:function(){return b},dx:function(){return E},Jh:function(){return y},mJ:function(){return c},fe:function(){return h},CB:function(){return C},Al:function(){return k},eg:function(){return v},uH:function(){return x},Xi:function(){return Z},fw:function(){return w},QI:function(){return L}});n(33948),n(15306),n(27207);var r=n(87575),a=n(43209),o=n(53694),l=n(2740),i=n(70745);var s=n(43422);n(43814),n(3842);function c(e){return!!e.selection&&a.ML.hasPath(e,a.ML.path(e,e.selection))}const d=["title","code-block","code-block-line","markdown-edit","markdown-edit-line","markdown","markdown-line"],u=(e,t)=>'<h1 class="ghq-card-content__title" data-ghq-card-content-type="TITLE">'.concat(e,"</h1>").concat(t),h=e=>{let{editor:t,bannedTypes:n=d}=e;if(!(t&&t.selection&&a.ML.hasPath(t,t.selection.anchor.path)&&a.ML.hasPath(t,t.selection.focus.path)))return!1;return Array.from(a.ML.nodes(t)).some((e=>{let[t]=e;return a.W_.isElement(t)&&n.includes(t.type)}))},p=e=>{let{editor:t}=e;if(!t.selection)return null;const n=t.selection.focus.path;if(!a.ML.hasPath(t,n))return null;const r=a.NB.get(t,n);if(!a.xv.isText(r))return null;const o=a.NB.string(r),l=t.marks;return!a.e6.isCollapsed(t.selection)||o||l?a.ML.marks(t):null},m=e=>{let{editor:t,type:n}=e;return Array.from(a.ML.nodes(t,{at:t.selection,match:e=>a.W_.isElement(e)&&e.type===n}))},g=e=>{let{editor:t}=e;if(!t.selection)return!1;const n=t.selection,r=a.e6.start(n),o=a.e6.end(n),l=r.path,i=o.path,s=l[0]===i[0],c=m({editor:t,type:"list"});return!s||!!c.length&&l[1]!==i[1]},f=e=>{let{editor:t}=e;const n=p({editor:t});return null==n?void 0:n.color},v=["guru-card","file","link"],E=e=>{let{editor:t}=e;if(null!=t&&t.selection){const e=[...a.ML.nodes(t,{match:e=>a.W_.isElement(e)&&v.includes(e.type)})];return Boolean(e.length)}return!1},b=e=>{let{editor:t}=e;if(t.selection){const e=[...a.ML.nodes(t,{match:e=>a.W_.isElement(e)&&"title"===e.type})];return Boolean(e.length)}return!1},y=e=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),C=e=>e.startsWith&&!e.startsWith("javascript:")&&!e.startsWith("data:")&&!e.startsWith("#"),N=e=>{let{editor:t,commands:n}=e;if(null!=t&&t.selection&&g({editor:t}))return"Text styles";if(null!=t&&t.selection&&a.y$.equals(t.selection.anchor.path,t.selection.focus.path)){const[e]=a.ML.above(t,{match:(e,t)=>a.W_.isElement(e)&&!["td","tr","table","list-item"].includes(e.type)})||[],i=null==e?void 0:e.type;if("code-line"===i)return"Code";if("title"===i)return"Title";if("heading"===i){var r;const t=e.level;return null===(r=n.find((e=>"heading"===e.type&&e.level===t)))||void 0===r?void 0:r.name}if("list"===i){var o;return null===(o=n.find((t=>"list"===t.type&&t.listType===e.listType)))||void 0===o?void 0:o.name}var l;return null===(l=n.find((e=>e.type===i)))||void 0===l?void 0:l.name}return"---"};function T(e,t){const{selection:n}=e;if(!n)return null;const r={prev:null,curr:null,next:null},{anchor:l}=n,i=a.y$.parent(l.path),s=t||i;let c,d;try{c=a.y$.next(s)}catch(e){}try{d=a.y$.previous(s)}catch(e){}if(!a.ML.hasPath(e,s))return null;const[u]=a.ML.node(e,s);if(r.curr={path:s,node:u},c)try{const[t]=a.ML.nodes(e,{match:e=>(0,o._x)(e),at:c});r.next={path:c.concat(0),node:t[0]}}catch(e){}if(d)try{const[t]=a.ML.nodes(e,{match:e=>(0,o._x)(e),at:d});r.prev={path:d.concat(0),node:t[0]}}catch(e){}return r}function S(e,t){if(!t)return!1;const{next:n,curr:r}=t;if(!n||!r)return!1;if(a.ML.isEmpty(e,n.node))return a.YR.select(e,n.path),!0;const[,o]=a.ML.next(e,{at:r.path})||[];return a.YR.insertNodes(e,{type:"p",children:[{text:""}]},{at:o}),a.YR.select(e,n.path),!0}function k(e){if(!e.selection||a.e6.isExpanded(e.selection))return;const[t]=a.ML.above(e,{match:o._x})||[];if(!t)return!1;return a.NB.string(t).startsWith("/")}function x(e){return k(e)&&!b({editor:e})&&!(0,s.tC)(e)&&!function(e,t){const{selection:n}=e,r=t||n;return null!=r&&(0,i.Q)(e,r).length>0}(e)&&!(0,l.SY)(e)}function L(e,t,n){const[r]=a.NB.levels(t.node,t.path),o=r[0].children,{path:l}=a.ML.start(e,t.path),i=[l[0],o.length-1,l[2]],{path:s}=a.ML.end(e,i),[,c]=l,[,d]=s,[,u]=n;return{line:u,isFirst:0===c&&0===u,isLast:d===u}}const _=(e,t,n)=>e?t||n||!/^<br(\s*\/)?>(\s*)?$/g.test(e)?e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;"):e:"",I=e=>e?e.replaceAll("&nbsp;"," ").replaceAll("&gt;",">").replaceAll("&lt;","<").replaceAll("&amp;","&"):"";function w(e,t){for(const n of e){const e=n;if(t(e))break;e.children&&w(e.children,t)}}const M=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e.innerHTML;return t&&n?n.replace(/&amp;gt;/g,"&gt;").replace(/&amp;lt;/g,"&lt;"):n};function P(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=e;let a="#text"===n.nodeName?n.textContent||"":n.innerHTML;"#text"!==n.nodeName&&(a=M(n,t));try{const e=(0,r.Qc)(a||"");let t="";return w(e,(e=>{const r=e;"text"===r.type&&(t+=I(r.content)),"PRE"===n.nodeName?"element"===r.type&&"br"===r.tagName&&(t+="<br>"):"element"===r.type&&"br"===r.tagName&&(t+="\n")})),t}catch{return n.textContent?I(n.textContent):""}}const D=e=>["i","em","b","strong","u","strike","del","mark","color","code"].includes(e.nodeName.toLowerCase()),A=e=>{const t=e.nodeName.toLowerCase();return["b","strong"].includes(t)?["strong",{bold:!0}]:["i","em"].includes(t)?["em",{italic:!0}]:["u"].includes(t)?["u",{underline:!0}]:["strike","del","s"].includes(t)?["del",{strikethrough:!0}]:["mark"].includes(t)?["mark",{highlight:!0}]:["code"].includes(t)?["code",{code:!0}]:null},O=e=>{const t=e.parentElement;if(!t)return{parentIsMark:!1};const n=t.nodeName.toLowerCase(),r=D(t),a=A(t);return{parentIsMark:r,parentNodeName:n,markToUse:a&&r&&"code"!==a[0]?a[0]:null}},R=(e,t)=>{const n=e.parentElement,r=null==n?void 0:n.parentElement;if(!n||!r)return void window.Rollbar.error("Unexpectedly didn't find mark above anchor or that mark's parent");const a=n.nextSibling,o=Array.from(n.childNodes).reduce(((e,n)=>{const r=n,a=D(r)||"#text"===r.nodeName;if("A"!==r.nodeName)e.length&&e[e.length-1].nodeName===t.toUpperCase()&&!a||e.push(document.createElement(t)),e[e.length-1].appendChild(r);else{const n=document.createElement(t);n.innerHTML=r.innerHTML,r.innerHTML=n.outerHTML,e.push(r)}return e}),[]);r.removeChild(n),o.forEach((e=>{r.insertBefore(e,a)}))},Z=e=>{if(e.children){let n=e;return["i","em","b","strong","u","strike","del","mark","color","code"].forEach((t=>{e.outerHTML.startsWith("<".concat(t))&&(n=document.createElement("p"),n.innerHTML=e.outerHTML)})),w(t=n.children,(e=>{const t=e,n=D(t);if(t.parentElement){let e=O(t);var r,a;if(n)e.parentIsMark&&e.markToUse&&("#text"===(null===(r=t.previousSibling)||void 0===r?void 0:r.nodeName)||"#text"===(null===(a=t.nextSibling)||void 0===a?void 0:a.nodeName))&&R(t,e.markToUse);else if("A"===t.nodeName)for(;e.parentIsMark&&e.markToUse;)R(t,e.markToUse),e=O(t)}})),t}var t},q=e=>{const{data:{preferredPhrase:t,content:n},editFact:{data:{preferredPhrase:r,content:a}}}=e;return r!==t||a!==n},F=e=>{const{data:{preferredPhrase:t,jsonContent:n},editFact:{data:{preferredPhrase:r,jsonContent:a}}}=e;if(!n)return!1;return JSON.stringify(JSON.parse(n).value)!==JSON.stringify(JSON.parse(a).value)||t!==r}},56893:function(e,t,n){n.d(t,{Z:function(){return ih}});var r=n(67294),a=n(71041),o=n(65637),l=n(82280),i=n(21650),s=n(56457);var c=e=>{let{heading:t="Unable to load Card content"}=e;return r.createElement("div",{className:"ghq-ErrorMessage"},r.createElement("img",{draggable:"false",src:l.Z.getURL("common/images/plugs.svg"),className:"ghq-ErrorMessage__img"}),r.createElement("div",{className:"ghq-ErrorMessage__text"},r.createElement(s.ZP,{level:s.y5.H1,style:s.Lx.Normal},t),r.createElement(i.ZP,null,"Please try reloading the page. If the problem persists, please"," ",r.createElement(o.Z,{type:"link",label:"contact support"}))))},d=n(73544),u=n(23978),h=n(91087),p=(n(33948),n(18156)),m=n(73443);function g(e){e.preventDefault(),e.stopPropagation()}var f=n(43209),v=n(53694);function E(e){return Array.from(f.ML.nodes(e,{match:v.OD})).length>0}var b=n(76030);function y(e,t){const n={};Array.from(f.ML.nodes(e,{match:v.OD})).forEach((t=>{let[,r]=t;const a=r.map((e=>e.toString())).join(",");if(!n[a]){const t=f.ML.above(e,{at:r,match:v.nq});n[a]=t}}));const r=Object.values(n);r.length>0?f.ML.withoutNormalizing(e,(()=>{r.reverse().filter((e=>{let[n]=e;return n.listType!==t})).forEach((n=>{let[r,a]=n;return f.YR.setNodes(e,{listType:t},{at:a})}))})):f.ML.withoutNormalizing(e,(()=>{f.YR.setNodes(e,{type:"list-item"}),f.YR.wrapNodes(e,{type:"list",listType:t,children:[]})}))}var C=n(70745);function N(e,t){if(t.current){const n=Array.from(f.ML.nodes(e,{at:t.current,match:(t,n)=>{const r=[...n.slice(0,-1),...n.slice(-1)],a=f.ML.hasPath(e,r)?f.ML.previous(e,{at:n}):null;return null!=a&&(0,v.nq)(a[0])&&(0,v.nq)(t)}})).reverse();n.forEach((t=>{f.YR.mergeNodes(e,{at:t[1]})})),n.length>0&&N(e,t)}}function T(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{selection:n}=e;if(n){const r=(0,C.Q)(e,n);if(0===Array.from(f.ML.nodes(e,{match:v.OD})).length||r.length>=7&&t)return!0;const a=f.ML.rangeRef(e,n,{affinity:"forward"}),o=Array.from(f.ML.nodes(e,{match:v.OD}));return f.ML.withoutNormalizing(e,(()=>{if(o.reverse().forEach((n=>{let[,r]=n;const a=f.ML.pathRef(e,r);if(t){const t=f.ML.parent(e,r),n=(null==t?void 0:t[0].listType)||"ul";f.YR.wrapNodes(e,{type:"list",listType:n,children:[]},{at:r})}else{const t=f.ML.parent(e,r),n=(null==t?void 0:t[0].listType)||"ul";f.YR.liftNodes(e,{at:r});const o=null!=a.current?f.ML.parent(e,a.current)[0]:null;null==a.current||null==o||(0,v.nq)(o)||f.YR.wrapNodes(e,{type:"list",listType:n,children:[]},{at:a.current})}})),!a.current||!f.ML.hasPath(e,a.current.anchor.path)||!f.ML.hasPath(e,a.current.focus.path))return!0;N(e,a)})),!0}return!1}const S={label:"Increase Indent",icon:b.Z.Indent,type:"indent",action:e=>(T(e,!0),!0)},k={label:"Decrease Indent",icon:b.Z.Undent,type:"undent",action:e=>(T(e),!0)},x={label:"Bulleted List",icon:b.Z.FormatListBulleted,type:"list",action:e=>(y(e,"ul"),!0)},L={label:"Numbered List",icon:b.Z.FormatListNumbered,type:"list",action:e=>(y(e,"ol"),!0)};function _(e){const{selection:t}=e;if(t&&f.e6.isCollapsed(t)){const n=(0,C.Q)(e,t),r=f.ML.above(e,{at:t,match:v.OD});if(!r)return!1;const a=f.ML.isEmpty(e,r[0]);if(a&&1===n.length)return(0,h.oS)(e,(()=>({type:"p",children:[]}))),!0;if(a&&n.length>1)return T(e),!0;if(a&&n.length>0)return f.YR.unwrapNodes(e,{match:e=>(0,v.OD)(e)||(0,v.nq)(e)}),f.YR.wrapNodes(e,{type:"p",children:[]}),f.YR.setSelection(e,{anchor:f.ML.start(e,t.anchor.path.slice(0,-2)),focus:f.ML.start(e,t.anchor.path.slice(0,-2))}),!0}return!1}const I=M({enter:e=>_(e),backspace:e=>_(e),tab:e=>!!E(e)&&T(e,!0),"shift+tab":e=>!!E(e)&&T(e),"mod+alt+b":(e,t)=>(x.action(e,t),!0),"mod+alt+n":(e,t)=>(L.action(e,t),!0)}),w=e=>e.metaKey&&e.altKey&&"KeyN"===e.nativeEvent.code;function M(e){const t=Object.entries(e).map((e=>{let[t,n]=e;return[(0,p.ZP)(t),n,t]}));return function(e,n,r){for(let a=0;a<t.length;a++){const[o,l,i]=t[a],s=(0,m.aZ)({editor:n}),c=w(e),d=o(e.nativeEvent)||c&&"mod+alt+n"===i,u=s&&d&&"tab"===l.name;if((!s&&d||u)&&l(n,r))return g(e),!0}return!1}}function P(e){let{attributes:t,element:n}=e;const r=n.type;return{className:"ghq-next-card-content__".concat(r),"data-testid":"editor-element-".concat(r),"data-ghq-card-content-type":r,...t}}function D(e){return f.W_.isElement(e)&&"block-quote"===e.type}function A(e){return f.W_.isElement(e)&&"p"===e.type}var O=n(35596);n(15306),n(27207);var R=n(87575),Z=n(9044),q=n(9980),F=n.n(q),B=n(40015),H=n.n(B),U=n(73945),z=n.n(U),V=n(46345),Y=n.n(V),j=(n(5242),n(32156)),W=n.n(j);var G={allowedTags:["a","abbr","address","article","aside","audio","b","blockquote","br","caption","cite","code","col","colgroup","del","details","dd","dfn","dialog","div","dl","em","figcaption","figure","footer","h1","h2","h3","h4","h5","h6","hgroup","header","hr","i","ins","input","iframe","img","label","li","main","mark","menu","nl","ol","p","picture","pre","q","s","section","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","title","tr","u","ul","var","video"],allowedAttributes:{"*":["data-ghq-*","style","class","id","tabindex"],iframe:["src","width","height","editing","autofocus","sandbox","allowfullscreen","frameborder"],video:["src","width","height","controls","controlslist","muted","poster"],a:["href","name","target","rel"],img:["src","alt","width","height"],ol:["start"],label:["for"],input:[{name:"type",values:["checkbox"]},"name","checked"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["data","http","https","ftp","mailto"],allowedSchemesAppliedToAttributes:["href","src","cite"],disallowedTagsMode:"discard",parser:{lowerCaseTags:!1,lowerCaseAttributeNames:!1,decodeEntities:!0,recognizeSelfClosing:!0},transformTags:{input:function(e,t){return"checkbox"!==t.type?{}:{tagName:e,attribs:t}},a:function(e,t){var n;const r={...t};return(null===(n=t.href)||void 0===n?void 0:n.startsWith("#"))||(r.target="_blank",r.rel="noopener noreferrer"),{tagName:e,attribs:r}}}};const K=window;function $(e){const t=K.document.createElement("div"),n=W()(e,G);t.innerHTML=n;const r=t.children[0],a=t.children[t.children.length-1];if(!r)return n;"P"===r.tagName&&""===r.innerHTML&&t.removeChild(r),r!==a&&"P"===a.tagName&&""===a.innerHTML&&t.removeChild(a);Array.from(t.querySelectorAll("pre")).forEach((e=>{let t;t=e.querySelector("code")?[].concat(...Array.from(e.querySelectorAll("code")).map((e=>e.textContent.split("\n")))):e.textContent.split("\n"),e.innerHTML="",t.forEach(((t,n,r)=>{if(n===r.length-1&&!t)return;const a=K.document.createElement("code");a.textContent=t,e.appendChild(a)}))}));Array.from(t.querySelectorAll("style")).forEach((e=>e.parentElement.removeChild(e)));const o=Array.from(t.querySelectorAll("ol, ul")).filter((e=>"LI"===e.parentElement.tagName)),l=[];o.forEach((e=>{if(l.some((t=>t===e)))return e.parentElement.removeChild(e);const t=e.parentElement,n=Array.from(t.childNodes),r=K.document.createElement("p");let a=!1;return n.forEach(((n,o,i)=>{if(a||n.tagName!==e.tagName||(a=n),a){if("OL"===n.tagName||"UL"===n.tagName){return Array.from(n.childNodes).forEach((e=>a.appendChild(e))),void l.push(n)}t.removeChild(n)}else 3===n.nodeType&&i[o+1]&&i[o+1].tagName===e.tagName&&(n.textContent=n.textContent.replace(/\s+$/,"").replace(/\n$/g,"")),r.appendChild(n)})),t.appendChild(r),t.appendChild(e),l.push(e)}));return Array.from(t.querySelectorAll("*")).forEach((e=>{const t=e;return"CODE"!==e.tagName&&0===e.children.length&&""!==e.textContent&&(t.innerHTML=e.innerHTML.replace(/\n/g,"<br />")),t})),(0,Z.S)(t.innerHTML,{conservativeCollapse:!0,collapseWhitespace:!0})}var Q=n(52738);function J(e){var t,n;const r=null!==(t=e.getAttribute("width"))&&void 0!==t?t:"",a=null!==(n=e.getAttribute("style"))&&void 0!==n?n:"";let o;try{o=(0,Q.Z)(a)||{}}catch{o={}}const l=Number.parseInt(r,10)||0,i=Number.parseInt(o.width,10)||0;return l||(i||0)}function X(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;const n=e.querySelectorAll("img");let r=0;for(const e of n){const n=J(e);n||e.setAttribute("width",String(t)),r=Math.max(t,n,r)}return r}function ee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150;const n=[35,70,215];return e<n[0]?t:e>=n[0]&&e<n[1]?1.45*t:e>=n[1]&&e<n[2]?2.26*t:3.2*t}function te(e){const t=[],n=[],r=function(e){const t=e.querySelector("colgroup"),n=null==t?void 0:t.querySelectorAll("col");if(!t||null==n||!n.length)return[];const r=[];for(let e=0;e<n.length;e+=1){const t=n[e],a=t.getAttribute("span")||"1",o=J(t),l=Number.parseInt(a,10)||1;for(let e=0;e<l;e+=1)r.push(o)}return r}(e),a=function(e){const t=e.getAttribute("data-ghq-table-column-widths");return t?t.split(",").map((e=>Number.parseInt(e,10)||0)):[]}(e),o=e.querySelectorAll("td, th"),l=function(e){let t=0;for(let n=0;n<e.rows.length;n+=1){let r=e.rows[n].cells.length;r>t&&(t=r)}return t}(e);let i;i=o.length%l==0?o:e.querySelectorAll("td");let s=0;for(let e=0;e<i.length;e+=1){var c;const r=i[e],a=null!==(c=r.textContent)&&void 0!==c?c:"",o=X(r);t[s]=Math.max(a.length,t[s]||0),n[s]=Math.max(J(r),o,n[s]||0);r.nextElementSibling?s+=1:s=0}const d=[];for(let e=0;e<l;e+=1){const o=r[e]||0,l=n[e]||0,i=a[e]||0;if(i)d.push({width:i});else if(o)d.push({width:o});else{const n=ee(t[e]);d.push({width:Math.max(150,n,l)})}}return d}var ne=n(57956);const re=(e,t)=>{for(var n=e.toString(16);n.length<t;)n="0"+n;return n},ae=e=>{const t=/[\w*+\-./@]/;let n,r,a=String(e),o="",l=a.length,i=0;for(;i<l;)n=a.charAt(i++),t.exec(n)?o+=n:(r=n.charCodeAt(0),o+=r<256?"%"+re(r,2).toUpperCase():"%u"+re(r,4).toUpperCase());return o},oe=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.trim().startsWith("<")},le=e=>{const t=z().format(e,{parser:"markdown",plugins:[Y()]});return F()({html:!0,linkify:!1,typographer:!1}).render(t).replace(/&quot;/g,'"').replace(/&amp;/g,"&")},ie=e=>e.replace(/%px/g,"%").replace(/autopx/g,"auto").replace(/px;px/g,"px"),se=e=>{if(!e)return{width:"",unit:""};const t=ie(e),n=Number.parseFloat(t),r=Number.isNaN(n),a=null==t||t.includes("undefined")||t.includes("null"),o=Number.parseInt(t),l=t.replace(String(n),""),i=r||a?"":""===l?"px":l.replace(/;/g,""),s=a||r?"":i;return{width:String(a?"":r?t:o),unit:String(s)}},ce=e=>{const t=ie(e),n=t.split(";"),r=n.findIndex((e=>e.includes("width")));if(-1!==r){const e=n[r];if(e.includes("undefined")||e.includes("null"))return n[r]="width:px",n.join(";");{var a;const t=null===(a=e.match(/width\s*:\s*(.*)/))||void 0===a?void 0:a[1],o=Number.parseFloat(String(t));if(!Number.isNaN(o)&&t){const e=t.replace(String(o),""),a=String(Number.parseInt(String(t)));return n[r]="width:".concat(a).concat(e),n.join(";")}}}return t},de=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(oe(e))return t?(0,Z.S)(e,{conservativeCollapse:!0,collapseWhitespace:!0}):e;const n=le(e);return t?(0,Z.S)(n,{conservativeCollapse:!0,collapseWhitespace:!0}):n},ue=e=>{if("a"===e.tagName){const t=Object.values(e.attributes).filter((e=>"class"===e.key&&"ghq-card-content__guru-card"===e.value)).length;e.attributes.forEach((e=>{if("href"===e.key){let n;const{value:r}=e,a=(null==r?void 0:r.trim())||"",o=/^http[s]?:\/\/none$/.test(a);if(t||a&&"#"!==a&&!o){try{const e=a.replace(/&amp;/g,"&").replace(/&nbsp;/g,"");n=e.startsWith("mailto")?e:H()(e,{stripWWW:!1,removeTrailingSlash:!0});n.includes("%20")&&t&&(n=n.split("/").slice(0,5).join("/"))}catch(e){n=a}e.value=n}else e.value="#"}"target"===e.key&&(e.value="_blank"),"rel"===e.key&&(e.value="noopener noreferrer")}));e.attributes.find((e=>"href"===e.key))||e.attributes.push({key:"href",value:"#"});e.attributes.find((e=>{e.key}))||e.attributes.push({key:"target",value:"_blank"});e.attributes.find((e=>{e.key}))||e.attributes.push({key:"rel",value:"noopener noreferrer"})}"iframe"===e.tagName&&(e.attributes=e.attributes.filter((e=>{if("src"===e.key){let t;if(e.value&&"#"!==e.value){try{t=H()(e.value.replaceAll("&amp;amp;","&").replaceAll("&amp;","&"),{stripWWW:!1,removeTrailingSlash:!0})}catch(n){t=e.value}e.value=t}else e.value="#"}return!["mozallowfullscreen","webkitallowfullscreen"].includes(e.key)})))};function he(e){const t=function(e){const t=document.createElement("div");return t.innerHTML=e,Array.from(t.querySelectorAll("details")).forEach((e=>{const t=Array.from(e.children).reduce(((e,t)=>{if("LI"!==t.tagName)e.push(t);else if(e.length&&"UL"===e[e.length-1].tagName)e[e.length-1].appendChild(t);else{const n=document.createElement("ul");n.appendChild(t),e.push(n)}return e}),[]);e.innerHTML="",t.forEach((t=>e.appendChild(t)))})),t.innerHTML}(function(e){const t=document.createElement("div");t.innerHTML=e;const n=Array.from(t.querySelectorAll(".ghq-card-content__markdown"));let r=!1;return n.forEach((e=>{var t,n;const a=e;if(a.textContent&&null!==(t=a.dataset)&&void 0!==t&&t.ghqCardContentMarkdownContent&&(null===(n=a.innerHTML)||void 0===n||!n.startsWith("<"))){r=!0;const e=a.dataset.ghqCardContentMarkdownContent,t=unescape(e);a.innerHTML=ne.Z.getRawHTML(t)}})),r?(0,Z.S)(t.innerHTML,{collapseWhitespace:!0,conservativeCollapse:!0}):e}(e)),n=(e,t)=>{var r,a;"code"!==(null==t?void 0:t.tagName)&&"pre"!==(null==t?void 0:t.tagName)||(null===(a=t.children)||void 0===a||a.forEach((e=>{e.isCode=!0})));const o=!t.isCode,l=!(null!==(r=t.content)&&void 0!==r&&r.includes("\n\n")),i=new RegExp(/\n\s+/g);var s;o&&l&&("\n"===t.content&&(t.content=t.content.replaceAll("\n","")),null!==(s=t.content)&&void 0!==s&&s.match(i)&&(t.content=t.content.replaceAll(i,"")));return"\n"!==t.content&&"\t"!==t.content||"text"!==t.type?t.children?[...e,{...t,children:t.children.reduce(n,[])}]:[...e,t]:e};let r;try{r=(0,R.Qc)(t)}catch(e){r=(0,R.Qc)($(t))}return r.reduce(n,[]),(0,m.fw)(r,(e=>{const t=e;if(ue(t),"table"===t.tagName){var n;let e,r,a;t.attributes=t.attributes.filter((e=>"data-ghq-table-column-widths"!==e.key||""!==e.value)),null!==(n=t.children)&&void 0!==n&&n.length&&t.children.forEach(((n,o)=>{"colgroup"===n.tagName&&(e=n.children.length||0,0===e&&t.children.splice(o,1)),"tbody"===n.tagName&&e>0&&n.children.forEach((t=>{var n,o;if(r=(null===(n=t.children)||void 0===n||null===(o=n.filter((e=>"element"===e.type)))||void 0===o?void 0:o.length)||0,r>0)if(r<e)a=e-r;else{const n=r-e||0;for(let e=0;e<n;e++)t.children.pop()}})),t.children.forEach((e=>{if("colgroup"===e.tagName&&a>0)for(let t=0;t<a;t++)e.children.pop()}))})),a>0&&t.attributes.forEach((e=>{if("data-ghq-table-column-widths"===e.key){const t=e.value.split(",");for(let e=0;e<a;e++)t.pop();e.value=t.join(",")}}))}var r;"code"!==t.tagName&&"pre"!==t.tagName&&(null!==(r=t.children)&&void 0!==r&&r.length&&t.children.forEach((e=>{if("text"===e.type){var t;const n=document.createElement("div");n.innerHTML=e.content,e.content=null===(t=n.innerHTML)||void 0===t?void 0:t.replace(/&nbsp;/g," ")}})));if("img"===t.tagName&&(t.attributes=t.attributes.filter((e=>{const n="width"===e.key&&""===e.value,r="style"===e.key&&"width:px"===e.value,a="alt"===e.key&&""===e.value,o=n||r;return t.attributes.length>2?!o:!a}))),"div"===t.tagName&&t.attributes.forEach((e=>{"class"===e.key&&"ghq-card-content__paragraph"===e.value&&(t.tagName="p")})),"form"===t.tagName&&(t.tagName="p"),["p","hr","a"].includes(t.tagName)){const e=t.tagName,n={p:"ghq-card-content__paragraph",hr:"ghq-card-content__horizontal-rule",a:"ghq-card-content__link"},r=t.attributes.find((e=>"class"===e.key));t.attributes.find((e=>e.key.includes("data-ghq-card-content-type")))&&!r&&t.attributes.push({key:"class",value:n[e]})}})),(0,R.Pz)(r).replaceAll(/%3E\/iframe%3E/g,"%3E").replaceAll("&nbsp;"," ").replaceAll("ghq-card-content**","ghq-card-content__").replaceAll(/ghq-card-content\\_\\_/g,"ghq-card-content__").replaceAll(/ghq-card-content\\__/g,"ghq-card-content__").replaceAll("ghq-card-contentbold","ghq-card-content__bold").replaceAll("ghq-card-contentitalic","ghq-card-content__italic").replaceAll("ghq-card-contentlink","ghq-card-content__link").replaceAll("ghq-card-contentparagraph","ghq-card-content__paragraph").replaceAll("ghq-card-contentimage","ghq-card-content__image").replaceAll("ghq-card-contentcode","ghq-card-content__code").replaceAll("ghq-card-contentcode","ghq-card-content__code").replaceAll('data-ghq-card-content-type="BULLETEDLISTITEM"','data-ghq-card-content-type="BULLETED_LIST_ITEM"').replaceAll('data-ghq-card-content-type="NUMBEREDLISTITEM"','data-ghq-card-content-type="NUMBERED_LIST_ITEM"').replaceAll("ghq-card-contentbulleted",'ghq-card-content__bulleted"').replaceAll("ghq-card-contentnumbered","ghq-card-content__numbered")}const pe=e=>{var t;return"MARKDOWN"===(null===(t=e.dataset)||void 0===t?void 0:t.ghqCardContentType)},me=e=>{var t;return"CODE_BLOCK"===(null===(t=e.dataset)||void 0===t?void 0:t.ghqCardContentType)||"PRE"===e.nodeName},ge=e=>{var t;if(pe(e))return!1;const n=null===(t=e.parentElement)||void 0===t?void 0:t.closest('[data-ghq-card-content-type="MARKDOWN"]');return Boolean(n)},fe=e=>{var t,n;if(me(e))return!1;const r=e,a=(null===(t=r.parentElement)||void 0===t?void 0:t.closest('[data-ghq-card-content-type="CODE_BLOCK"]'))||(null===(n=r.parentElement)||void 0===n?void 0:n.closest("pre"));return Boolean(a)},ve=(e,t)=>!ge(e)&&"#text"!==e.nodeName&&t.toLowerCase()===e.nodeName.toLowerCase(),Ee=(e,t)=>{var n;if(!e)return!1;const r=e,a="#text"===r.nodeName,o=null===(n=r.dataset)||void 0===n?void 0:n.ghqCardContentType;if(!o)return!1;return t.toLowerCase().includes("heading")&&["LARGE_HEADING","MEDIUM_HEADING","SMALL_HEADING"].includes(o)&&!a?o===t&&!ge(e):!a&&o===t&&!ge(e)};function be(){return be=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},be.apply(this,arguments)}const ye={label:"Block Quote",icon:b.Z.FormatQuote,type:"block-quote",action:e=>(h.$4.setBlockQuote(e),!0)},Ce=e=>{let{attributes:t,element:n,children:a}=e;return r.createElement("blockquote",P({attributes:t,element:n}),a)},Ne=M({"mod+alt+'":e=>(h.$4.setBlockQuote(e),!0)}),Te=(e,t,n)=>(function(e){const{normalizeNode:t}=e;e.normalizeNode=n=>{const[r,a]=n;if(!(D(r)&&(0,m.mJ)(e)&&f.ML.hasPath(e,a)))return t(n);f.YR.unwrapNodes(e,{at:a,match:e=>A(e)})}}(t),{...e,editableProps:{...e.editableProps,onKeyDown:r=>{var a,o;if(!Ne(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)},renderElement:t=>{var n,a;return"block-quote"===t.element.type?r.createElement(Ce,be({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},serializeElement:(t,n)=>D(t)?((e,t)=>(0,O.U)({node:e,classType:"block-quote",contentTypeValue:"BLOCK_QUOTE",element:"blockquote",serialize:t}))(t,n):e.serializeElement(t,n),parseHtmlElement:t=>Ee(t,"BLOCK_QUOTE")||ve(t,"blockquote")?{type:"block-quote",children:[{text:t.textContent||""}]}:e.parseHtmlElement(t)});var Se=n(15660),ke=n.n(Se);n(86405),n(35249),n(85795),n(77533),n(18508),n(31093),n(10856),n(54019),n(92776),n(24940),n(57874),n(94446),n(53292),n(76609),n(4279),n(35433),n(46213),n(2731),n(79016),n(15251),n(57065),n(40728),n(77158),n(68805),n(73299),n(49472),n(79787),n(27046),n(17117),n(40485),n(39181),n(70110),n(81295),n(50057),n(56521),n(29525),n(18848),n(52503),n(39980),n(74277),n(62356),n(56543),n(32334),n(90319),n(37802),n(26555),n(66841),n(48443),n(24064),n(24335),n(61169),n(33436),n(11426),n(20288),n(99945),n(86862),n(45820),n(37345),n(24319),n(80366),n(82939),n(54803),n(59385),n(70767),n(89865),n(12886),n(51412),n(92447),n(35266),n(90874),n(60075),n(71429),n(96836),n(34438),n(83082),n(31693),n(73358);ke().languages.scss=ke().languages.extend("scss",{}),ke().languages.insertBefore("scss","selector",{comment:[{pattern:/^\s*?\/\/.*/,greedy:!0},{pattern:/^\s*?\/\*.*/,greedy:!0},{pattern:/^\s*?\*(?!\/).*/,greedy:!0},{pattern:/^\s*?\*\//,greedy:!1}]}),ke().languages.css=ke().languages.extend("css",{}),ke().languages.insertBefore("css","selector",{comment:[{pattern:/^\s*?\/\*.*/,greedy:!0},{pattern:/^\s*?\*(?!\/).*/,greedy:!0},{pattern:/^\s*?\*\//,greedy:!1}]}),ke().languages.python=ke().languages.extend("python",{}),ke().languages.insertBefore("python","string",{comment:{pattern:/#[^\n]*/,alias:"comment"}}),ke().languages.insertBefore("python","string",{string:{pattern:/'.*'|".*"/,alias:"string"}}),ke().languages.clike=ke().languages.extend("clike",{comment:[{pattern:/^\s*?\/\/.*/,greedy:!0,alias:"comment"},{pattern:/^\s*?\/\*.*/,greedy:!0,alias:"comment"},{pattern:/^\s*?\*(?!\/).*/,greedy:!0,alias:"comment"},{pattern:/^\s*?\*\//,greedy:!1,alias:"comment"}]});["c","objectivec","cpp","java","javascript","csharp","go","aspnet","typescript"].forEach((e=>{ke().languages[e].comment=ke().util.clone(ke().languages.clike.comment)}));var xe=n(28566),Le=n.n(xe);let _e;!function(e){e.ToolbarAssist="TOOLBAR_ASSIST"}(_e||(_e={}));var Ie={Colors:["#F93679","#F7412D","#FF8A60","#FFC200","#66A030","#9013FE","#00BCD6","#2F3BA2","#BAB0BF"]},we=n(39146);const Me=e=>{var t;let n=((null==e||null===(t=e.outerHTML)||void 0===t?void 0:t.match(/(<\w*(\s)?)/gm))||[]).map((e=>e.replace("<","").replace(" ",""))).filter((e=>we.u5.includes(e)));return n.forEach(((e,t)=>{"mark"===e&&(n[t]="highlight"),"del"===e&&(n[t]="strikethrough"),"span"===e&&(n[t]="color"),"u"===e&&(n[t]="underline"),"strong"!==e&&"b"!==e||(n[t]="bold"),"em"!==e&&"i"!==e||(n[t]="italic"),"code"===e&&(n[t]="code")})),n};function Pe(e,t){const n=t.reduce(((e,t,n)=>(e["_".concat(n)]=t,e)),{});if(!e)return null;let r;try{r=Le().from(n)(e)}catch(e){}return r?r.value:null}function De(e,t){const n=new RegExp("(^|;|\\s)".concat(t,":\\s*([^};]*)"),"gi").exec(e);return n?n[2].trim().replace(";",""):""}function Ae(e){var t,n,r,a,o,l,i,s;const c=null==e?void 0:e.parentNode;let d=[];const u=e=>{for(let n=0,r=e.children.length;n<r;n++){var t;d.push(e.children[n].nodeName);const r=e.children[n];null!==(t=r.dataset)&&void 0!==t&&t.ghqCardContentType&&d.push(r.dataset.ghqCardContentType),e.children[n].children.length&&u(e.children[n])}return d};let h=e.children?u(e):[];const p=(null===(t=e.querySelector)||void 0===t||null===(n=t.call(e,'[data-ghq-card-content-type="TEXT_COLOR"]'))||void 0===n||null===(r=n.attributes)||void 0===r||null===(a=r.getNamedItem("style"))||void 0===a?void 0:a.value)||"",m=(null==e||null===(o=e.attributes)||void 0===o||null===(l=o.getNamedItem("style"))||void 0===l?void 0:l.value)||(null==c||null===(i=c.attributes)||void 0===i||null===(s=i.getNamedItem("style"))||void 0===s?void 0:s.value)||"",g=["500","600","700","800","900","bold"].includes(De(m,"font-weight"))||h.includes("STRONG")||h.includes("B")||h.includes("BOLD"),f="italic"===De(m,"font-style")||h.includes("I")||h.includes("EM")||h.includes("ITALIC"),v=De(m,"text-decoration").includes("line-through")||h.includes("DEL")||h.includes("S")||h.includes("STRIKETHROUGH"),E=function(e){return Pe(De(e,"color"),[...Ie.Colors,"#000000"])}(p||m),b=De(m,"background-color"),y="#fde892"===Pe(b,["#ffffff","#fde892","#000000"])||h.includes("MARK")||h.includes("HIGHLIGHT"),C=De(m,"text-decoration").includes("underline")||h.includes("U")||h.includes("UNDERLINE"),N=h.includes("CODE_SNIPPET")||h.includes("CODE"),T={bold:g,color:b&&"#FDE892"!==b.toUpperCase()&&"#000000"!==E||"#000000"===E?null:E,highlight:y,italic:f,strikethrough:v,underline:C,code:N};return Object.keys(T).forEach((e=>{T[e]||delete T[e]})),T}function Oe(e){const t=we.u5.concat("br","#text","i","b","u","s");return Array.from(e.childNodes).some((e=>{const n=e.nodeName.toLowerCase();return!t.includes(n)}))}var Re=n(48306);const Ze=e=>Number.isNaN(Number(e.type))?e.type:e.alias,qe=e=>"string"==typeof e?e.length:"string"==typeof e.content?e.content.length:e.content.reduce(((e,t)=>e+qe(t)),0);function Fe(e,t){var n;const[r,a]=e,o=[];if(!(0,v.Je)(r))return o;const[l]=f.ML.parent(t,a)||[];if(!(0,v.bA)(l))return o;let i=null!==(n=l.language)&&void 0!==n?n:"";i===Re.rI&&(i="");const s=Se.languages[i];if(!s)return o;const c=f.NB.string(r),d=(0,Se.tokenize)(c,s);let u=0;for(const e of d){const t=u+qe(e);e instanceof Se.Token&&o.push({tokenType:Ze(e),codeSyntax:!0,anchor:{path:a,offset:u},focus:{path:a,offset:t}}),u=t}return o}var Be=n(2740);const He={icon:b.Z.Code,label:"Code Block",type:"code-block",action:e=>((0,Be.Zn)(e),!0)},Ue=M({"mod+alt+c":(e,t)=>(He.action(e,t),!0)}),ze=M({backspace(e,t){const[n]=Be.ki(e)||[],r=Be.OY(e,n),{selection:a}=e;if(!r||!a)return!1;const{curr:o,prev:l}=r,i=f.y$.parent(a.anchor.path),s=f.e6.end(a);if(l&&o&&i&&f.ML.isEmpty(e,l.node)){const t=(0,m.QI)(e,o,i);if(t.isFirst&&!t.isLast&&0===s.offset)return f.YR.moveNodes(e,{at:i,to:l.path}),!0;if(t.isLast&&0===s.offset)return f.YR.liftNodes(e),f.YR.moveNodes(e,{at:i,to:l.path}),!0}return!1},"shift+enter":e=>(e.insertBreak(),!0),"mod+alt+c":(e,t)=>(He.action(e,t),!0),"mod+enter"(e){const[t]=Be.ki(e)||[],n=Be.OY(e,t);return Be.Zt(e,n)},"mod+a"(e,t){const{selection:n}=e;if(!n)return!1;const[r]=f.ML.above(e)||[];if(!(0,v.Je)(r))return!1;const{anchor:a}=n,o=f.y$.parent(a.path),l=f.y$.parent(o);if(!f.ML.hasPath(e,l))return!1;const i=f.NB.get(e,l),[s]=f.NB.levels(i,l),c=s[0].children,{path:d}=f.ML.start(e,l),u=[d[0],c.length-1,d[2]],{path:h}=f.ML.end(e,u),p={offset:0,path:d},m={offset:f.ML.string(e,h).length,path:h};return f.YR.setSelection(e,{anchor:p,focus:m}),!0},tab:e=>Be.WY(e),"shift+tab":e=>Be.Sb(e)});var Ve=n(94184),Ye=n.n(Ve),je=n(86178),We=n(32195);function Ge(e){let{element:t}=e;const n=(0,u._7)();return r.createElement(We.ZP,{aria:"default-block-delete-button",icon:b.Z.Delete,tooltipLabel:"Delete",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>function(e){let{editor:t,element:n}=e;const r=u.F3.findPath(t,n);return f.YR.removeNodes(t,{at:r}),r}({editor:n,element:t})})}const Ke=new Map([["center","--center"],["right","--right"]]);function $e(e){let{children:t,align:n="right",className:a="",style:o={}}=e;return r.createElement("div",{"data-testid":"Block Edit Menu",className:Ye()(a,"ghq-BlockMenu",Ke.get(n)),style:o,contentEditable:!1},t)}function Qe(){const e=(0,u.vt)(),t=(0,u.UE)();return e&&t}function Je(e){let{onCopy:t}=e;return r.createElement(We.ZP,{aria:"code-block-copy-button",icon:b.Z.Copy,tooltipLabel:"Copy code",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:e=>{null==e||e.preventDefault(),t()}})}var Xe=n(24908);function et(e){let{language:t,onSelect:n,options:a}=e;return r.createElement("div",{className:"ghq-select-code-language","data-testid":"code-block-select-language"},r.createElement(Xe.ZP,{label:"Select language",name:"form-element-name",value:t,onChange:e=>{n(e)}},a.map((e=>{let{label:t,value:n}=e;return r.createElement(Xe.$m,{key:t,label:t,value:n})}))))}function tt(){return tt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tt.apply(this,arguments)}function nt(e){var t;let{attributes:n,element:a,children:o}=e;const l=Qe(),i=(0,u.GQ)(),s=(0,u._7)(),c=P({attributes:n,element:a}),d=Ye()(c.className,{"ghq-is-highlighted":l,"ghq-is-read-only":i}),[h,p]=r.useState(a.language||Re.rI),m=(0,Be.yj)();return r.createElement("div",tt({},c,{className:d}),r.createElement($e,{className:Ye()("".concat(c.className,"__block-menu"),{"ghq-is-visible":l||i})},i?r.createElement("span",{className:"".concat(c.className,"__language-name")},null===(t=Re.V1.find((e=>e.value===h)))||void 0===t?void 0:t.label):r.createElement(et,{language:h,options:Re.V1,onSelect:e=>{p(e),f.YR.setNodes(s,{language:e},{at:u.F3.findPath(s,a)}),u.F3.focus(s)}}),r.createElement("div",{className:"".concat(c.className,"__code-separator")}),r.createElement(Je,{onCopy:()=>(0,Be.JG)({factId:m,element:a})}),!i&&r.createElement(Ge,{element:a})),r.createElement("pre",{className:"".concat(c.className,"__pre")},o))}function rt(){return rt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rt.apply(this,arguments)}function at(e){let{attributes:t,element:n,children:a}=e;const o=P({attributes:t,element:n});return r.createElement("code",rt({},o,{spellCheck:!1}),a)}var ot=n(32989),lt=n(54911);function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},it.apply(this,arguments)}const st=(e,t,n)=>({...e,editableProps:{...e.editableProps,decorate(n){var r,a;return[...(null===(r=(a=e.editableProps).decorate)||void 0===r?void 0:r.call(a,n))||[],...Fe(n,t)]},onPaste(n){var r,a;const{selection:o}=t;if(Be.SY(t)){if(!o)return void n.preventDefault();const{isNextEditorCodeBlock:e,lines:r}=Be.S_(n);if(e)return t.insertFragment(r),void n.preventDefault();const a=Array.from(n.clipboardData.types);if(a.includes("text/plain")&&!a.includes("application/x-slate-fragment"))return}return null===(r=(a=e.editableProps).onPaste)||void 0===r?void 0:r.call(a,n)},onKeyDown:r=>{var a,o;(function(e,t,n){return!(!Be.SY(t)||!ze(e,t,n))||!(Be.SY(t)||!Ue(e,t,n))})(r,t,n)?r.preventDefault():null===(a=(o=e.editableProps).onKeyDown)||void 0===a||a.call(o,r)},renderElement:t=>{var n,a;return"code-block"===t.element.type?r.createElement(nt,it({},t,{element:t.element})):"code-line"===t.element.type?r.createElement(at,it({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},serializeElement:(t,n)=>(0,v.bA)(t)?(0,ot.x)(t,n):(0,v.Je)(t)?(0,lt.$)(t,n):e.serializeElement(t,n),parseHtmlElement:t=>{if(pe(t)||ge(t))return e.parseHtmlElement(t);const n=t,r=Me(n);if(Ee(n,"CODE_BLOCK_LINE")||ve(n,"code")&&!Ee(n,"CODE_SNIPPET"))return{type:"code-line",children:[{text:(0,m.C0)(t)||"",...r.length>1&&{orderedMarks:r}}]};if(Ee(n,"CODE_BLOCK")||ve(n,"pre")){var a;const e=(null===(a=n.dataset)||void 0===a?void 0:a.ghqCodeBlockPrism)||Re.rI,t=n.querySelectorAll('[data-ghq-card-content-type="CODE_BLOCK_LINE"]');let o=Array.from(n.querySelectorAll("code")),l=!1;0===o.length&&(l=!0,o=Array.from(n.childNodes),o.forEach((e=>{e.textContent=(0,m.aM)(e.textContent||"",!0,!0)})));const i=t.length?t:o;return{type:"code-block",language:e,children:Array.from(i).map((e=>({type:"code-line",children:[{text:(0,m.C0)(e,l),...r.length>1&&{orderedMarks:r}}]})))}}return e.parseHtmlElement(t)}});function ct(e){return f.W_.isElement(e)&&"divider"===e.type}function dt(e){const[t]=f.ML.above(e,{at:e.selection,match:ct})||[];return Boolean(t)}function ut(e,t){const n=(0,m.OY)(e);if(!n||!n[t])return!1;const r=n[t],a="prev"===t;if(r&&f.W_.isElement(r.node)){if(f.YR.move(e,{distance:1,unit:"line",reverse:a}),"prev"===t)return!0;const n=f.ML.isEmpty(e,r.node),o="p"===r.node.type;if(!n){const t=f.ML.edges(e,r.path)[1].offset;if(t>0)return f.YR.move(e,{distance:t,unit:"character"}),!0;if(o){let t=0;for(const e of r.node.children)t+=f.NB.string(e).length;return f.YR.move(e,{distance:t,unit:"character"}),!0}}return!0}return!1}const ht={icon:b.Z.HorizontalRule,label:"Divider",type:"divider",action:e=>(function(e){const t=(0,m.OY)(e);if(!t)return;const n=(0,m.Tt)({editor:e,type:"td"});t.curr&&f.ML.isEmpty(e,t.curr.node)&&!n.length?f.YR.insertFragment(e,[{type:"divider",children:[{text:""}]}]):f.YR.insertNodes(e,{type:"divider",children:[{text:""}]})}(e),!0)},pt=M({"mod+alt+-":(e,t)=>(ht.action(e,t),!0),backspace(e){const t=(0,m.OY)(e);if(!t)return!1;const{prev:n,curr:r}=t,a=n&&ct(n.node),o=r&&f.ML.isEmpty(e,r.node);return!(!a||!o)&&(f.YR.removeNodes(e,{at:r.path}),f.YR.select(e,n.path),!0)}}),mt=M({up:e=>ut(e,"prev"),down:e=>ut(e,"next"),"mod+alt+-":(e,t)=>(ht.action(e,t),!0),enter(e){const t=(0,m.OY)(e);return!!t&&(0,m.Zt)(e,t)}});function gt(){return gt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gt.apply(this,arguments)}function ft(e){let{attributes:t,children:n,element:a}=e;const o=Qe(),l=(0,u.GQ)(),i=P({attributes:t,element:a});return r.createElement("div",gt({},i,{className:Ye()(i.className,{"ghq-is-highlighted":o,"ghq-is-read-only":l})}),r.createElement("div",{className:"".concat(i.className,"__inner"),contentEditable:!1},r.createElement("hr",{"data-testid":"divider"}),r.createElement($e,{className:Ye()("".concat(i.className,"__block-menu"),{"ghq-is-visible":o&&!l,"ghq-is-hidden":l})},r.createElement(Ge,{element:a}))),n)}function vt(){return vt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vt.apply(this,arguments)}const Et=(e,t,n)=>({...e,editableProps:{...e.editableProps,onKeyDown:r=>{var a,o;(function(e,t,n){return!(!dt(t)||!mt(e,t,n))||!(dt(t)||!pt(e,t,n))})(r,t,n)?r.preventDefault():null===(a=(o=e.editableProps).onKeyDown)||void 0===a||a.call(o,r)},renderElement:t=>{var n,a;return ct(t.element)?r.createElement(ft,vt({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},toolbarActions:[...e.toolbarActions,ht],serializeElement:(t,n)=>ct(t)?((e,t)=>(0,O.U)({node:e,classType:"horizontal-rule",contentTypeValue:"DIVIDER",element:"hr",serialize:t}))(t,n):e.serializeElement(t,n),parseHtmlElement:t=>Ee(t,"DIVIDER")||ve(t,"hr")?{type:"divider",children:[{text:""}]}:e.parseHtmlElement(t)}),bt=(e,t)=>({...e,popoverMode:e.popoverMode!==t?t:"default"});var yt=n(43422);function Ct(e){return/^(http(s)?:\/\/)?(www\.)?youtube\.com\/(watch|embed)\?v=[A-Za-z0-9_\-]{11}$/gi.test(e)||/^(http(s)?:\/\/)?(www\.)?youtube\.com\/(watch|embed)\/\?v=[\w\d_\-]{11}$/gi.test(e)||/^(http(s)?:\/\/)?(www\.)?youtube\.com\/(watch|embed)\/[\w\d_\-]{11}$/gi.test(e)||/^(http(s)?:\/\/)?(www\.)?youtu\.be\/[A-Za-z0-9_\-]{11}(\?t=\d+)?$/gi.test(e)}function Nt(e){return/^(http(s)?:\/\/)?(www\.)?vimeo\.com\/\d+$/gi.test(e)||/^(http(s)?:\/\/)?(www\.)?player\.vimeo\.com\/video\/\d+/gi.test(e)}function Tt(e){return/^(http(s)?:\/\/)?(www\.)?[\-a-zA-Z0-9@:%_+\.~#?&//=]{2,256}\.wistia\.com\/medias\/[A-Za-z0-9_\-]{10}$/gi.test(e)||/^(http(s)?:\/\/)?(www\.)?fast\.wistia\.net\/embed\/iframe\/[A-Za-z0-9_\-]{10}(\?[\w-]+(=[\w-]*)?(&[\w-]+(=[\w-]*)?)*)?$/gi.test(e)}function St(e){return/^(http(s)?:\/\/)?(www\.)?(useloom|loom)\.com\/(share|embed)\/[a-z0-9]+$/gi.test(e)}function kt(e){return!!e&&(Tt(e)||Nt(e)||Ct(e)||St(e)||function(e){const t=[".mp4",".3gp",".ogg",".webm"];for(const n of t)if(e.endsWith(n))return!0;return!1}(e))}function xt(e){return/^<iframe[\s\S]*>[\s\S]*<\/iframe>$/gi.test(e)||/^<iframe[\s\S]*\/>$/gi.test(e)}function Lt(e){const t=/src\s*=\s*["\u201c\u201d](.+?)["\u201c\u201d]/g.exec(e);return t?t[1]:""}function _t(e){return Ct(e)?function(e){const t=e.split("/");let n=t[t.length-1].replace("watch?v=","");return n=n.replace(/\?t=\d+$/i,(e=>e.replace("?t=","?start="))),"https://www.youtube.com/embed/".concat(n)}(e):Nt(e)?function(e){const t=e.split("/"),n=t[t.length-1];return"https://player.vimeo.com/video/".concat(n)}(e):Tt(e)?function(e){const t=e.split("/"),n=t[t.length-1];return"https://fast.wistia.net/embed/iframe/".concat(n)}(e):St(e)?function(e){return e.replace("/share/","/embed/")}(e):e}function It(e){return xt(e)?Lt(e):_t(e)}const wt=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"src",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return"src"!==t?e.getAttribute("data-ghq-card-content-video-original-src")||n:e.getAttribute("src")||n},Mt=e=>{if(Ee(e,"VIDEO"))return!0;return ve(e,"iframe")&&kt(wt(e))};function Pt(e){var t;const n=_t(e),r=/"*<iframe.*?src=['"](.*?)['"]/,a=r.exec(e)&&(null===(t=r.exec(e))||void 0===t?void 0:t[1]);return a&&a!==e?a:n!==e?n:e}function Dt(e){return e.includes("<iframe")?Lt(e):e.replace(/http[s]?:\/\//g,"https://")}const At=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,topLeft:!1,bottomLeft:!1};return{...t,...e}};function Ot(e){let{editor:t,iframeUrl:n,originalSrc:r}=e;const{selection:a}=t;if(!a)return;const o=f.y$.parent(a.anchor.path),l=[o[0]+1];if(!f.ML.hasPath(t,o))return;const i=f.NB.get(t,o),s=f.ML.isEmpty(t,i);s&&f.YR.removeNodes(t);let c=a;try{const e=f.NB.get(t,l);c="iframe"===e.type||f.ML.isVoid(t,e)?s?o:[o[0]+1]:s?o:a}catch(e){c=void 0}return f.YR.insertNodes(t,{type:"iframe",url:n,originalSrc:r,children:[{text:""}]},{at:c})}function Rt(e){return f.W_.isElement(e)&&"iframe"===e.type}var Zt=n(57557),qt=n.n(Zt);var Ft=e=>{let{className:t,children:n}=e;const a=Ye()("ghq-PopoverContent",t);return r.createElement("div",{className:a},r.createElement("div",{className:"ghq-PopoverContent__content"},n))},Bt=n(2803),Ht=n(18633);function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ut.apply(this,arguments)}const zt=r.forwardRef(((e,t)=>{let{style:n,element:a,setPopoverMode:o,...l}=e;const[i,s]=(0,r.useState)((null==a?void 0:a.url)||""),c=(0,u._7)(),d=(0,r.useRef)(null);(0,r.useEffect)((()=>{const e=setTimeout((()=>{null!=d.current&&(null==d||d.current.focus())}));return()=>clearTimeout(e)}),[null==d?void 0:d.current]);const h=()=>{if(!i)return;const e=Dt(i),t=i;if(null!=a&&a.url){const n=u.F3.findPath(c,a);f.YR.setNodes(c,{url:e,originalSrc:t},{at:n})}else Ot({iframeUrl:e,editor:c,originalSrc:t});o("hidden"),u.F3.focus(c)},p=()=>{o("default"),u.F3.focus(c)};return r.createElement("div",Ut({},qt()(l,["popoverMode"]),{ref:t,"data-testid":"PopoverIframeEdit",style:{...n,position:"fixed"}}),r.createElement(Ft,{className:"ghq-PopoverIframeEdit"},r.createElement("div",{className:"ghq-PopoverIframeEdit__field"},r.createElement("label",{className:"ghq-PopoverContent__field-label",htmlFor:"iframeUrl"},"Iframe URL"),r.createElement("input",{ref:d,"data-testid":"Iframe URL",id:"iframeUrl",className:"ghq-input ghq-next-fact-editor-popover__field-input",value:i,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),h()):"Escape"===e.key&&(e.preventDefault(),p())}}),r.createElement("div",null,r.createElement(Ht.Z,{style:Ht.W.Dim},"Works best with embed codes and popular GSuite apps.")),r.createElement("div",{className:"ghq-PopoverIframeEdit__buttons"},r.createElement(Bt.ZP,{label:"Save",disabled:!i,size:Bt.qE.Small,theme:Bt.bn.Primary,onClick:h}),r.createElement(Bt.ZP,{label:"Cancel",size:Bt.qE.Small,theme:Bt.bn.Gray,style:Bt.ZJ.Outline,onClick:p})))))}));var Vt=n(41610),Yt=n(45697),jt=n.n(Yt);class Wt extends r.PureComponent{render(){const{shown:e,className:t,position:n}=this.props,a=Ye()("ghq-editor-no-copy ghq-ResizeHandle",t,{"ghq-is-shown":e,["ghq-is-on-".concat(n)]:Boolean(n)});return r.createElement("span",{className:a})}}Wt.propTypes={shown:jt().bool,className:jt().string,position:jt().string},Wt.defaultProps={shown:!1,position:"right"};var Gt=n(43919),Kt=n(95587),$t=n(9248),Qt=n(65680),Jt=n(39429);function Xt(){return Xt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Xt.apply(this,arguments)}function en(e){let{attributes:t,children:n,element:a,editor:o}=e;const l=Qe(),i=(0,u.GQ)(),[s,c]=r.useState(!1),[d,h]=r.useState(!1),p=r.useRef(-1),{setContextState:m}=(0,Gt.y)(),{url:g,isFullWidth:v}=a,[E,y]=r.useState(i);r.useEffect((()=>{if(!i)return l?y(!0):l&&!u.F3.isFocused(o)||!l&&u.F3.isFocused(o)?y(!1):void 0}),[l]);const C=r.useCallback((e=>{e&&(p.current=window.setTimeout((()=>{h(!0)}),3e4))}),[]);r.useEffect((()=>()=>{p.current>0&&window.clearTimeout(p.current)}),[]);const N=r.useMemo((()=>Kt.Z.hasSandboxIframes()?{sandbox:ne.Z.SANDBOX_PERMISSIONS}:{}),[]),T=!function(e){return!(xt(e)||!/^http[s]?:\/\//g.test(e))||xt(e)}(g)||d,S=r.useCallback((e=>{const t=u.F3.findPath(o,a);f.YR.setNodes(o,e,{at:t})}),[]);return r.createElement("div",Xt({className:Ye()("ghq-RenderIframe",{"ghq-is-full-width":v}),"data-testid":"Iframe Wrapper"},t),!i&&r.createElement($e,null,r.createElement(We.ZP,{aria:"edit-iframe-block-button",icon:b.Z.Pencil,tooltipLabel:"Edit",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:e=>{null==e||e.preventDefault(),m((e=>({...e,popoverMode:"editingIframe"})))}}),r.createElement(We.ZP,{aria:"expand-iframe-block-button",icon:v?b.Z.CollapseBlock:b.Z.ExpandBlock,tooltipLabel:v?"Toggle content width":"Toggle full width",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:e=>{null==e||e.preventDefault(),S({isFullWidth:!v})}}),r.createElement(Ge,{element:a})),r.createElement(Vt.Z,{size:{height:a.height||"auto",width:"auto"},enable:i?At():At({bottom:l}),minHeight:200,minWidth:"100%",className:"ghq-RenderIframe__responsive",onResize:(e,t,n,r)=>{n.style.width="auto",n.style.height="".concat(n.clientHeight+r.height)},onResizeStop:(e,t,n,r)=>{S({width:n.clientWidth,height:n.clientHeight})}},T?r.createElement("div",{"data-testid":"Iframe Error Block",className:Ye()("ghq-RenderIframe__inner","ghq-is-error",{"ghq-is-highlighted":l,"ghq-is-read-only":i})},r.createElement(Qt.Z,{icon:b.Z.IframeError,color:$t.ZP.Fruitpunch})):r.createElement(r.Fragment,null,!s&&r.createElement("div",{"data-testid":"Iframe Loading Block",className:Ye()("ghq-RenderIframe__inner","ghq-loader",{"ghq-is-highlighted":l})},r.createElement(Jt.ZP,{size:Jt.wx.Small,color:Jt.Cl.Slime})),r.createElement("iframe",Xt({allowFullScreen:!0},N,{"data-testid":"Iframe Block",className:Ye()("ghq-RenderIframe__iframe",{"ghq-is-highlighted":l,"ghq-is-hidden":!s}),src:Pt(g),frameBorder:0,contentEditable:!1,tabIndex:-1,ref:C,onError:()=>h(!0),onLoad:()=>{window.clearTimeout(p.current),c(!0)}})),r.createElement("div",{contentEditable:!1,className:Ye()("ghq-RenderIframe__iframe-overlay",{"ghq-can-interact-with":E}),onClick:()=>y(!0)})),r.createElement("div",{contentEditable:!1},r.createElement(Wt,{position:"bottom",shown:l&&!i}))),n)}const tn=/["'&<>]/;function nn(e){var t,n=""+e,r=tn.exec(n);if(!r)return n;var a="",o=0,l=0;for(o=r.index;o<n.length;o++){switch(n.charCodeAt(o)){case 34:t="&quot;";break;case 38:t="&amp;";break;case 39:t="&#39;";break;case 60:t="&lt;";break;case 62:t="&gt;";break;default:continue}l!==o&&(a+=n.substring(l,o)),l=o+1,a+=t}return l!==o?a+n.substring(l,o):a}function rn(){return rn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rn.apply(this,arguments)}const an={icon:b.Z.EmbedIframe,label:"Iframe",type:"iframe",action:(e,t)=>(t.setContextState((e=>bt(e,"insertingIframe"))),!0)},on=M({"mod+alt+e":(e,t)=>(an.action(e,t),!0)}),ln=(e,t,n)=>{const{insertBreak:a,deleteBackward:o}=t;return t.deleteBackward=e=>{const{selection:n}=t;if(!n)return o(e);if(n.anchor.path[0]<1)return o(e);const[r]=Array.from(f.ML.above(t)||[]),a=f.ML.isEmpty(t,r),{anchor:{path:l}}=n;if(a){const[e,n]=f.ML.above(t,{at:l,match:e=>(0,v._x)(e)})||[],[r,a]=f.ML.previous(t,{at:n})||[];if(null!=r&&null!=e&&Rt(r)&&A(e)){if(f.YR.removeNodes(t,{at:n}),null!=a){const e=f.ML.end(t,a);f.YR.setSelection(t,{anchor:e,focus:e})}return}}return o(e)},t.insertBreak=()=>{const[e]=Array.from(f.ML.above(t)||[]);if("iframe"===e.type){const[e]=Array.from(f.ML.next(t)||[]);return""===(null==e?void 0:e.text)?(f.YR.move(t,{unit:"line"}),!0):(f.ML.insertNode(t,{type:"p",children:[{text:""}]}),!0)}return a()},{...e,editableProps:{...e.editableProps,onPaste(n){var r,a;const{types:o}=n.clipboardData,l=n.clipboardData.getData("text/plain"),{selection:i}=t;return i&&!(0,yt.tC)(t)&&o.includes("text/plain")&&l.includes("<iframe")?(n.preventDefault(),void Ot({editor:t,iframeUrl:Dt(l),originalSrc:l})):null===(r=(a=e.editableProps).onPaste)||void 0===r?void 0:r.call(a,n)},onKeyDown:r=>{var a,o;if(!on(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)},renderElement:n=>{var a,o;return Rt(n.element)?r.createElement(en,rn({},n,{element:n.element,actions:e.popoverActions,editor:t})):(null===(a=(o=e.editableProps).renderElement)||void 0===a?void 0:a.call(o,n))||r.createElement(u.Qr,n)}},toolbarActions:[...e.toolbarActions,an],serializeElement:(t,n)=>Rt(t)?((e,t)=>{const n=nn(e.originalSrc).replace(/&lt;/g,"<").replace(/&gt;/g,">"),r={allowfullscreen:"",frameborder:0,src:Pt(e.url),title:"ghq-iframe","data-ghq-card-content-iframe-original-src":n};e.height&&(r.height=e.height),e.width&&(r.width=e.width),!0!==e.isFullWidth&&!1!==e.isFullWidth||(r["data-ghq-card-content-is-full-width"]=e.isFullWidth);const a=(0,O.U)({node:e,classType:"iframe",contentTypeValue:"IFRAME",element:"iframe",serialize:t,attributes:r});return'<div class="ghq-card-content__iframe-responsive-wrapper">'.concat(a).concat("</div>")})(t,n):e.serializeElement(t,n),parseHtmlElement:t=>{const n=t;if(!(ve(n,"iframe")&&!kt(n.src)&&"ghq-card-content__video"!==n.className||"ghq-card-content__iframe"===n.className)||ge(n))return e.parseHtmlElement(t);const{src:r}=n,a=n.dataset.ghqCardContentIsFullWidth,o=n.dataset.ghqCardContentIframeOriginalSrc,l=Number.parseFloat(String(n.getAttribute("height")))||null,i=String(n.getAttribute("width"));return{type:"iframe",url:r,originalSrc:o,children:[{text:""}],height:l,width:i.includes("%")?n.getAttribute("width"):Number.parseFloat(i)||null,...a&&{isFullWidth:JSON.parse(a)}}},renderPopover:n=>{const{popoverMode:a,element:o}=n;if("insertingIframe"===a)return r.createElement(zt,rn({},n,{element:o}));if("editingIframe"===a){const[e]=Array.from(f.ML.above(t)||[]);if(Rt(e))return r.createElement(zt,rn({},n,{element:e}))}return e.renderPopover(n)}}},sn="application/x-guru-entities",cn=e=>f.W_.isElement(e)&&e.hasOwnProperty("entityKey");function dn(e,t,n){var r;const a=function(e,t){if(null==e.selection)return;const n=e.selection||[],r=f.ML.nodes(e,{at:n,match:cn}),a=Array.from(r).map((e=>{let[t]=e;return t.entityKey})),o={};return a.forEach((e=>{null!=e&&(o[e]=t.getContextState().entities[e])})),o}(t,n);null===(r=e.clipboardData)||void 0===r||r.setData(sn,JSON.stringify(a))}var un=n(25108);const hn=(e,t,n)=>({...e,editableProps:{...e.editableProps,onCopy:r=>{var a,o;dn(r,t,n),null===(a=(o=e.editableProps).onCopy)||void 0===a||a.call(o,r)},onCut:r=>{var a,o;dn(r,t,n),null===(a=(o=e.editableProps).onCut)||void 0===a||a.call(o,r)},onPaste:t=>{var r,a;try{if(Array.from(t.clipboardData.types).includes(sn)){var o;const e=JSON.parse(null===(o=t.clipboardData)||void 0===o?void 0:o.getData(sn));n.setContextState((t=>({...t,entities:{...t.entities,...e}})))}}catch(e){un.warn("could not find clipboard data for ".concat(sn)),un.error(e)}null===(r=(a=e.editableProps).onPaste)||void 0===r||r.call(a,t)}}});var pn=n(28721),mn=n(59806),gn=n(7813),fn=n.n(gn);function vn(e){let{files:t,editor:n,context:r,selection:a}=e;const o=r.contextState.cardId;return Promise.all(t.map((e=>{const t=(0,pn.Z)(),{name:l}=e,i=a||n.selection;if(!i)return Promise.reject(new Error("No selection set."));r.upsertEntity(t,{name:l});const s={type:"file",entityKey:t,children:[]};return f.e6.isCollapsed(i)?(s.children.push({text:l}),f.YR.insertNodes(n,s,{at:i})):(f.YR.wrapNodes(n,s,{split:!0}),f.YR.collapse(n,{edge:"end"})),r.upload(e).then((e=>{let{url:n}=e;r.upsertEntity(t,{name:l,url:n})})).catch((e=>{var n;r.upsertEntity(t,{hasError:!0}),mn.Z.createToast({content:"".concat(l||"File"," failed to upload"),id:"next-fact-editor-".concat(o),type:fn().ERROR,options:{dismissable:!0}}),null===(n=window.Rollbar)||void 0===n||n.error(e)}))})))}var En=n(3842),bn=n(6793);const yn=e=>{let{url:t,factId:n}=e;mn.Z.createToast({content:"Image link copied!",id:"next-fact-editor-".concat(n)}),bn.Z.copy(t)},Cn=e=>/\.(jpg|jpeg|png|webp|avif|gif|svg)$/.test(e);var Nn=n(11609);const Tn=e=>{var t;return null===(t=(0,Gt.y)().contextState.entities)||void 0===t?void 0:t[e]};var Sn=n(99355);const kn=e=>{var t;const n=null===(t=window.document.activeElement)||void 0===t?void 0:t.shadowRoot,r=n?null==n?void 0:n.activeElement:document.body.getElementsByClassName(e?"ghq-CardHome__full-width-scroller":"ghq-next-fact-editor__scroll-window")[0];return((null==r?void 0:r.scrollTop)||0)-((null==r?void 0:r.getBoundingClientRect())||{top:0}).top};var xn=n(66674);const Ln=e=>{let{target:t,element:n,popoverMode:a,setPopoverMode:o,renderPopover:l,...i}=e;const s=(0,r.useRef)(null),c=(0,u.ui)(),d=(0,r.useRef)(a),h=(0,r.useRef)(c.selection);(0,r.useEffect)((()=>{if("hidden"===d.current&&"hidden"===a&&null!=h.current&&null!=c.selection&&!f.e6.equals(h.current,c.selection)){let e="default";"guru-card"===(null==n?void 0:n.type)?e="guruCard":"link"===(null==n?void 0:n.type)&&(e="link"),o(e)}d.current=a,h.current=c.selection}),[a,c.selection]);const p=((e,t,n)=>{const a=(0,u.ui)(),o=(0,u.UE)(),l=(0,u.GQ)(),[i,s]=(0,r.useState)(0),[c,d]=(0,r.useState)();(0,r.useEffect)((()=>{if(null!=e.current){const e=()=>{const e=kn(l);s(e)};return document.addEventListener("scroll",e,!0),s(kn(l)),()=>document.removeEventListener("scroll",e,!0)}}),[e]);const h=(0,r.useRef)();return(0,r.useEffect)((()=>{var e;const t=null===(e=window.document.activeElement)||void 0===e?void 0:e.shadowRoot;if(null!=a.selection){const e=t?t.getSelection():window.getSelection();if(null==(null==e?void 0:e.getRangeAt)||0===(null==e?void 0:e.rangeCount))return;const n=e.getRangeAt(0),r=f.y$.parent(a.selection.anchor.path);if(!f.ML.hasPath(a,r))return;const o=f.NB.get(a,r);let i;i=a.isVoid(o)?u.F3.toDOMNode(a,o).getBoundingClientRect():n.getBoundingClientRect(),h.current={top:i.top+kn(l),left:i.left,width:i.width}}}),[a.selection]),(0,r.useEffect)((()=>{const r=null==e?void 0:e.current,{selection:l}=a;if(!r)return;if((!l||!o||f.e6.isCollapsed(l)||""===f.ML.string(a,l))&&("default"===t||"hidden"===t)&&null==(null==n?void 0:n.current))return void d(void 0);let s=null;if(null!=(null==n?void 0:n.current)){const{width:e,left:t,top:r}=n.current.getBoundingClientRect();s={width:e,left:t,top:r+i}}else null!=h.current&&(s=h.current);const c=Math.max(s.top-r.offsetHeight-10-i,0);null!=s&&d({zIndex:2147483647,opacity:c<=0?"0":"1",top:"".concat(Math.max(s.top-r.offsetHeight-10-i,0),"px"),left:"".concat(Math.max(s.left-r.offsetWidth/2+s.width/2,0),"px")})}),[a.selection,t,n,i]),c})(s,a,t);(0,xn.Z)((()=>{null==(null==s?void 0:s.current)||null==c.selection||f.e6.isExpanded(c.selection)||o("hidden")}),[null==s?void 0:s.current,t,c.selection]);const m=l({...i,ref:s,element:n,style:p,popoverMode:a,setPopoverMode:o});return null!=m&&"hidden"!==a?r.createElement(Sn.Z,null,m):null};var _n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250;const[n,a]=(0,r.useState)(e);return(0,r.useEffect)((()=>{const n=setTimeout((()=>{a(e)}),t);return()=>{clearTimeout(n)}}),[e,t]),n};function In(e){return/(http(s)?:\/\/)?content\.(qa)?api.getguru.com\/files\/view\/.*/.test(e)}function wn(e){return function(e){return/(http(s)?:\/\/)?content\.(qa)?api.getguru.com\/files\/dn\/.*/.test(e)}(e)?e.replace("/files/dn","/files/view"):e}class Mn extends r.PureComponent{render(){const{className:e}=this.props;return r.createElement("span",{"data-testid":"Pulsing Loader",className:Ye()("ghq-PulsingLoader",e)},r.createElement("span",{className:"ghq-PulsingLoader__ball ghq-is-first"}),r.createElement("span",{className:"ghq-PulsingLoader__ball ghq-is-second"}),r.createElement("span",{className:"ghq-PulsingLoader__ball ghq-is-third"}))}}Mn.propTypes={className:jt().string};var Pn=n(13921),Dn=n(31439),An=n(42584),On=n.n(An),Rn=n(47482),Zn=n(37206);function qn(){return qn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qn.apply(this,arguments)}const Fn=r.forwardRef(((e,t)=>{var n;let{style:a,element:o,setPopoverMode:l,...i}=e;const s=(0,u._7)(),c=(0,u.GQ)(),d=Tn((null==o?void 0:o.entityKey)||""),h=!d.hasError&&null==d.url,p=r.useContext(Pn.ZP),m=null==p||null===(n=p.id)||void 0===n?void 0:n.replace("-readonly",""),g=o&&u.F3.findPath(s,o),v={trackableLink:'<a href="'.concat(d.url,'">').concat(null==o?void 0:o.children[0].text,"</a>")};return r.createElement("div",qn({},qt()(i,["popoverMode"]),{ref:t,"data-testid":"PopoverFile",style:{...a,position:"fixed"}}),r.createElement(Ft,{className:"ghq-PopoverFile"},r.createElement("div",{className:"ghq-PopoverFile__content-wrapper"},r.createElement("div",{className:"ghq-PopoverFile__icon-wrapper"},r.createElement(Qt.Z,{icon:b.Z.Clip})),h?r.createElement(Mn,null):d.hasError?r.createElement("span",{className:"ghq-PopoverFile__error"},"File unavailable"):r.createElement("a",{href:d.url,target:"_blank",rel:"noreferrer noopener"},d.name),!d.hasError&&r.createElement(We.ZP,{dataTestId:"file-popover-download-button",aria:"Download File",icon:b.Z.Download,tooltipLabel:"Download File",tooltipPosition:We.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{window.open(wn(d.url),"_blank")}}),c&&!d.hasError&&r.createElement(We.ZP,{dataTestId:"file-popover-copy-link-button",aria:"file-popover-copy-link-button",icon:b.Z.Link,tooltipLabel:"Copy Link to File",tooltipPosition:We.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{(e=>{let{url:t,id:n}=e;mn.Z.createToast({content:"File link copied!",id:"next-fact-editor-".concat(n)}),Zn.Z.copyLinkInCard(t,n)})({id:m,url:d.url})}}),c&&(null==p?void 0:p.hasContentROI)&&!d.hasError&&r.createElement(We.ZP,{dataTestId:"file-popover-copy-trackable-link-button",aria:"file-popover-copy-trackable-link-button",icon:b.Z.TrackLink,tooltipLabel:"Copy Trackable Link",tooltipPosition:We.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{l("hidden"),(e=>{let{factId:t,linkData:n}=e;Rn.ZP.getById(t)?Dn.Z.startContentROI(t,n):Dn.Z.openFact(t,{activity:On().Activities.BOARD,activityId:"",boardId:"",maximized:!0,callBack:()=>{Dn.Z.startContentROI(t,n)}})})({factId:m,linkData:v})}}),!c&&r.createElement(r.Fragment,null,r.createElement(We.ZP,{dataTestId:"file-popover-unlink-button",aria:"file-popover-unlink-button",icon:b.Z.Unlink,tooltipLabel:"Unattach File",tooltipPosition:We.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>f.YR.unwrapNodes(s,{at:g})}),r.createElement(We.ZP,{dataTestId:"file-popover-delete-link-button",aria:"file-popover-delete-link-button",icon:b.Z.Delete,tooltipLabel:"Delete File",tooltipPosition:We.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>f.YR.removeNodes(s,{at:g})})))))}));function Bn(){return Bn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bn.apply(this,arguments)}function Hn(e){let{attributes:t,children:n,element:a}=e;const o=(0,u.GQ)(),l=(0,u._7)(),i=(0,u.vt)(),[s,c]=(0,r.useState)(!1),[d,h]=(0,r.useState)("file"),p=Tn(a.entityKey||""),{selection:m}=l,g=(i||s)&&(!m||f.e6.isCollapsed(m)),v=_n(g,100),E=Ye()("ghq-FileLink",{"ghq-is-readonly":o});(0,r.useEffect)((()=>{h(v?"file":"hidden")}),[v]);const b=(0,r.useCallback)((()=>{"hidden"===d&&h("file"),c(!0)}),[d]),y=(0,r.useCallback)((()=>{c(!1)}),[d]),C="hidden"!==d&&"file"===d&&v;return p?r.createElement("a",Bn({},P({attributes:t,element:a}),{target:"_blank",rel:"noreferrer noopener",className:E,href:p.url,onClick:e=>{"hidden"===d&&h("file"),c(!0)},onMouseOver:b,onMouseLeave:y}),r.createElement(Nn.Z,{contentEditable:!1,color:"#005DFF",icon:"clip",size:1,sizeModifier:"em",className:"ghq-editor-no-copy ghq-FileLink__icon"}),C&&r.createElement(Ln,{renderPopover:e=>r.createElement(Fn,Bn({target:t.ref.current},e,{element:e.element})),popoverMode:d,setPopoverMode:h,target:t.ref,element:a,onMouseOver:b,onMouseLeave:y}),n):null}const Un=(e,t,n)=>(0,O.U)({node:e,classType:"file",contentTypeValue:"FILE",element:"a",serialize:t,attributes:{target:"_blank",rel:"noopener noreferrer",href:nn(n.url),"data-ghq-card-content-filename":e.serializedFileName}});function zn(){return zn=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zn.apply(this,arguments)}function Vn(e){return f.W_.isElement(e)&&"file"===e.type}const Yn={icon:b.Z.Clip,label:"File",type:"file",action:(e,t)=>(t.openFileDialog((n=>{const r=n.target.files;null!=r&&vn({files:Array.from(r),editor:e,context:t}).then((()=>{})).catch((e=>{var t;return null===(t=window.Rollbar)||void 0===t?void 0:t.error(e)}))})),!0)},jn=M({"mod+alt+f":(e,t)=>(Yn.action(e,t),!0)}),Wn=(e,t,n)=>({...e,editableProps:{...e.editableProps,onPaste:r=>{var a,o;const l=r.clipboardData.files,{selection:i}=t,s=Array.from(l).filter((e=>!e.type.includes("image")&&!Cn(e.name)));if(null!=s&&s.length&&null!=(null==i?void 0:i.anchor)&&null!=(null==i?void 0:i.focus)){vn({files:s,editor:t,selection:i,context:n}).then((()=>{})).catch((e=>{var t;return null===(t=window.Rollbar)||void 0===t?void 0:t.error(e)}));const e=s.slice(-1)[0].name.length+1;f.YR.move(t,{distance:e,unit:"offset"})}return null===(a=(o=e.editableProps).onPaste)||void 0===a?void 0:a.call(o,r)},onDrop:r=>{var a,o;r.preventDefault();const l=r.dataTransfer.files,i=u.F3.findEventRange(t,r),s=Array.from(l).filter((e=>!e.type.includes("image")&&!Cn(e.name)));if(null!=s&&s.length){vn({files:s,editor:t,selection:i,context:n}).then((()=>{})).catch((e=>{var t;return null===(t=window.Rollbar)||void 0===t?void 0:t.error(e)}));const e=s.slice(-1)[0].name.length+1;f.YR.move(t,{distance:e,unit:"offset"})}return null===(a=(o=e.editableProps).onDrop)||void 0===a?void 0:a.call(o,r)},onKeyDown:r=>{var a,o;if(!jn(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)},renderElement:t=>{var n,a;return"file"===t.element.type?r.createElement(Hn,zn({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},toolbarActions:[...e.toolbarActions,Yn],popoverActions:[...e.popoverActions,Yn],parseHtmlElement:t=>{const r=t,a=ve(r,"a"),o=a?r.getAttribute("href"):"",l=Ee(r,"LINK"),i=Ee(r,"GURU_CARD"),s=(0,En.y)(r.href),c=!l&&!i&&!s&&a&&null!==o&&/api.getguru.com\/files\/view\//gm.test(o);if(!((e=>"A"===e.nodeName)(r)&&function(e){return!!e&&"FILE"===e.dataset.ghqCardContentType}(r)&&!ge(t))&&!c)return e.parseHtmlElement(t);const{textContent:d}=r,u=r.getAttribute("href")||"",h=(0,pn.Z)(),p=d||"Unnamed";return n.upsertEntity(h,{url:u,name:p}),{type:"file",entityKey:h,children:[{text:d}],serializedUrl:u||"",serializedName:p,serializedFileName:r.dataset.ghqCardContentFilename||""}},serializeElement:(t,r)=>{if(Vn(t)){const e=n.getContextState().entities[t.entityKey||""],{serializedUrl:a,serializedName:o}=t,l=a&&o?{url:a,name:o}:null,i=e||l;return Un(t,r,null!=i?i:{url:"",name:""})}return e.serializeElement(t,r)}});var Gn=n(35034),Kn=n(19887),$n=n(16926),Qn=n(97374);let Jn,Xn;!function(e){e.Error="error",e.Loading="loading",e.Success="success"}(Jn||(Jn={})),function(e){e.EditorAssistWidget="editor-assist-widget",e.EditorToolbar="editor-toolbar"}(Xn||(Xn={}));var er=()=>{const{buildEventData:e,trackEvent:t}=(0,Qn.Z)();return{getTrackEventData:t=>{let{suggestionId:n=null,hasSelectedContent:r=!1,activitySubtype:a,cardId:o,collectionId:l,name:i,isError:s=!1,isLoading:c=!1,isSuccess:d=!1,isTruncated:u}=t;return e(i,{activitySubtype:a,activityMetaData:[{featureName:$n.Z.AI_ASSIST_GENERATE,data:{aiGenerateApiStatus:(()=>{switch(!0){case c:return Jn.Loading;case d:return Jn.Success;case s:return Jn.Error;default:return}})(),aiGenerateTruncated:u,hasSelectedContent:r,suggestionId:n,cardId:o,collectionId:l}}]})},trackEvent:t}};const tr=e=>e.filter((e=>!(0,v.gB)(e))),nr=e=>{if(!(e&&e.selection&&f.ML.hasPath(e,e.selection.anchor.path)&&f.ML.hasPath(e,e.selection.focus.path)))return[];const t=((e,t)=>t.filter((t=>!A(t)||!f.ML.isEmpty(e,t))))(e,f.NB.fragment(e,e.selection));return t},rr=e=>!(null==e||!e.selection)&&f.e6.isExpanded(e.selection),ar=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=t?tr(e):e;return n.map((e=>f.NB.string(e))).join("\n")};var or=n(13798);var lr=()=>{const e=(0,u._7)(),t=nr(e),n=tr(t),r=tr(e.children),a=rr(e)&&!!n.length,o=a?n:r,l=ar(o);return(0,or.sI)("Assist - Editor Content for Generative Actions",{hasSelectedContent:a,selectedNodes:t,selectedNodesWithoutTitle:n,entireCardNodesWithoutTitle:r,nodesForGenerativeActions:o,plaintextContent:l}),{hasSelectedContent:a,nodesForGenerativeActions:o,plaintextContent:l}},ir=n(23525);var sr=e=>{var t;let{suggestionId:n,isSuccess:a,isTruncated:o,onAddBelowSelection:l,onReplaceSelection:i}=e;const{t:s}=(0,Kn.$G)(),{card:c,collectionId:d}=(0,Pn.RC)(),u=null===(t=c.editFact.data)||void 0===t?void 0:t.id,{getTrackEventData:h}=er(),{hasSelectedContent:p}=lr(),m={activitySubtype:Xn.EditorAssistWidget,cardId:u,collectionId:d,hasSelectedContent:p,suggestionId:n,isSuccess:a,isTruncated:o};return r.createElement(r.Fragment,null,r.createElement(Bt.ZP,{icon:b.Z.Check,label:s("common.replace"),style:Bt.ZJ.Outline,theme:Bt.bn.Gray,trackEvent:h({name:ir.default.AI_ASSIST_GENERATE_REPLACE_BUTTON_CLICKED,...m}),onClick:i}),r.createElement(Bt.ZP,{icon:b.Z.Plus,label:s("common.addBelow"),style:Bt.ZJ.Outline,theme:Bt.bn.Gray,trackEvent:h({name:ir.default.AI_ASSIST_GENERATE_ADD_BELOW_BUTTON_CLICKED,...m}),onClick:l}))},cr=n(50811);var dr=e=>{var t;let{isError:n,isLoading:a,isSuccess:o,isTruncated:l,suggestionId:i,onAddToTop:s,onAddBelowSelection:c,onReplaceSelection:d,onCancel:u,onRetry:h}=e;const p=r.useRef(null),{t:m}=(0,Kn.$G)(),{hasSelectedContent:g}=lr(),{card:f,collectionId:v}=(0,Pn.RC)(),E=null===(t=f.editFact.data)||void 0===t?void 0:t.id,{getTrackEventData:y}=er(),C={activitySubtype:Xn.EditorAssistWidget,cardId:E,collectionId:v,hasSelectedContent:g,suggestionId:i};return r.useEffect((()=>{p.current&&p.current.focus()}),[p]),r.createElement("div",{className:"ghq-AssistWidgetActionBar",ref:p,tabIndex:-1},r.createElement(cr.Z,{alignment:cr.A.Right},a&&r.createElement(Bt.ZP,{icon:b.Z.Delete,label:m("common.cancel"),style:Bt.ZJ.Outline,theme:Bt.bn.Gray,trackEvent:y({name:ir.default.AI_ASSIST_GENERATE_CANCEL_BUTTON_CLICKED,isLoading:a,...C}),onClick:u}),n&&r.createElement(r.Fragment,null,r.createElement(Bt.ZP,{icon:b.Z.KnowledgeSync,label:m("common.retry"),style:Bt.ZJ.Outline,theme:Bt.bn.Gray,trackEvent:y({name:ir.default.AI_ASSIST_GENERATE_TRY_AGAIN_BUTTON_CLICKED,isError:n,...C}),onClick:h}),r.createElement(Bt.ZP,{icon:b.Z.Delete,label:m("common.cancel"),style:Bt.ZJ.Outline,theme:Bt.bn.Gray,trackEvent:y({name:ir.default.AI_ASSIST_GENERATE_CANCEL_BUTTON_CLICKED,isError:n,...C}),onClick:u})),o&&r.createElement(r.Fragment,null,g?r.createElement(sr,{suggestionId:i,isSuccess:o,isTruncated:l,onAddBelowSelection:c,onReplaceSelection:d}):r.createElement(Bt.ZP,{icon:b.Z.Plus,label:m("common.addToCard"),style:Bt.ZJ.Outline,theme:Bt.bn.Gray,trackEvent:y({name:ir.default.AI_ASSIST_GENERATE_ADD_TO_CARD_BUTTON_CLICKED,isSuccess:o,isTruncated:l,...C}),onClick:s}),r.createElement(Bt.ZP,{icon:b.Z.KnowledgeSync,label:m("common.retry"),style:Bt.ZJ.Outline,theme:Bt.bn.Gray,trackEvent:y({name:ir.default.AI_ASSIST_GENERATE_TRY_AGAIN_BUTTON_CLICKED,isSuccess:o,isTruncated:l,...C}),onClick:h}))))},ur=n(32838),hr=n(40510);var pr=e=>{let{isError:t,isLoading:n,isSuccess:a,isTruncated:o,suggestionId:l,onAddBelowSelection:i,onAddToTop:s,onClose:c,onReplaceSelection:d,onRetry:u}=e;return r.createElement("div",{className:"ghq-AssistWidgetContainerFooter"},r.createElement(hr.v3,null,o&&r.createElement("div",{className:"ghq-AssistWidgetContainerFooter__warning"},r.createElement(Qt.Z,{icon:b.Z.Alert,color:$t.ZP.Twilight}),r.createElement(Ht.Z,{style:Ht.W.Bold},"Assist could only process a portion of your selected text because it exceeded the word count limit.")),r.createElement("div",{className:"ghq-AssistWidgetContainerFooter__default"},r.createElement("div",{className:"ghq-AssistWidgetContainerFooter__actions"},r.createElement(dr,{isLoading:n,isError:t,isSuccess:a,isTruncated:o,suggestionId:l,onAddToTop:s,onAddBelowSelection:i,onReplaceSelection:d,onRetry:u,onCancel:c})),a&&r.createElement("div",{className:"ghq-AssistWidgetContainerFooter__disclaimer"},r.createElement(Ht.Z,{style:Ht.W.Dim},"Assist uses AI to generate content; users are encouraged to verify for accuracy."," ",r.createElement(ur.Z,{target:"_blank",to:Gn.r.AssistHelp,type:ur.q.HighPriority},"Learn more"))))))},mr=n(41609),gr=n.n(mr),fr=n(11788),vr=n(79267),Er=n(74841),br=n(44583),yr=n(18446),Cr=n.n(yr);const Nr=e=>f.xv.isText(e),Tr=e=>Object.keys(e).length>1,Sr=e=>{let{editor:t,path:n}=e;return f.NB.children(t,n,{reverse:!0})},kr=(e,t,n)=>{if(Nr(t)&&Tr(t)){const{...r}=t;return f.YR.unsetNodes(e,Object.keys(r),{at:n}),!0}if(!Nr(t))return f.YR.removeNodes(e,{at:n}),f.YR.insertNodes(e,{text:f.NB.string(t)},{at:n}),!0},xr=(e,t,n,r)=>{const a=[...f.NB.children(e,n,{reverse:!0})].filter((e=>!((e,t)=>f.W_.isElement(e)&&e.type===t)(e[0],r)));a.forEach((t=>((e,t,n)=>{const[r,a]=e;(0,v.CQ)(r)?h.$4.setConvertibleElement(t,(()=>({type:n})),a):f.YR.removeNodes(t,{at:a})})(t,e,r)))},Lr=(e,t)=>[...Sr({editor:e,path:t})].some((e=>{let[t]=e;return Nr(n=t)&&Tr(n)||!Nr(n);var n})),_r=(e,t,n)=>{const r=[...Sr({editor:e,path:n})];for(const[t,n]of r)kr(e,t,n);return!0},Ir=(e,t,n)=>{const r=f.ML.parent(e,t);if(null==r)return!1;const[a]=r;return!f.W_.isElement(a)||a.type!==n},wr=(e,t,n,r)=>{if(Ir(e,n,r)){const{type:r,children:a,...o}=t,l={type:"p",...Object.fromEntries(Object.keys(o).map((e=>[e,null])))};return f.YR.setNodes(e,l,{at:n}),!0}return!1},Mr={type:"code-line",children:[{text:""}]};function Pr(e,t,n){t.children.forEach(((t,r)=>{f.xv.isText(t)&&f.YR.wrapNodes(e,{type:"code-line",children:[]},{at:[...n,r]})})),xr(e,0,n,"code-line"),((e,t)=>[...f.NB.children(e,t)].length>0)(e,n)||((e,t,n)=>{f.YR.insertNodes(e,Mr,{at:[...n,0]})})(e,0,n)}var Dr=n(23602);var Ar=n(91422);var Or=n(69388);function Rr(e,t){f.ML.isEditor(e)&&function(e){const t=e.children[e.children.length-1],n=f.W_.isElement(t)&&f.ML.isEmpty(e,t);(0,v.CQ)(t)&&n&&"title"!==t.type||f.YR.insertNodes(e,(0,Dr.c)(),{at:[e.children.length]})}(t)}function Zr(e,t,n){return!!f.W_.isElement(t)&&((e=>Cr()(e,[0]))(n)?((e,t,n)=>!!f.W_.isElement(t)&&("title"===t.type?(_r(e,0,n),!1):((0,v.CQ)(t)||f.YR.insertNodes(e,(0,Ar.q)(),{at:[0]}),!0)))(e,t,n):(0,v.gB)(t)?(function(e,t,n){h.$4.setConvertibleElement(e,(()=>({type:"p"})),n)}(e,0,n),!0):(0,v.jI)(t)?(function(e,t,n){f.YR.liftNodes(e,{at:n,match:(e,t)=>f.y$.isChild(t,n)&&f.W_.isElement(e)&&"image"===e.type}),f.YR.unwrapNodes(e,{at:n,match:(e,t)=>!f.xv.isText(e)&&f.y$.isChild(t,n)}),1===t.children.length&&""===t.children[0].text&&f.YR.removeNodes(e,{at:n})}(e,t,n),!0):(0,v.ev)(t)?(function(e,t,n){xr(e,0,n,"markdown-line")}(e,0,n),!0):(0,v.dn)(t)&&Lr(e,n)?(function(e,t,n){_r(e,0,n)}(e,0,n),!0):(0,v.dn)(t)&&Ir(e,n,"markdown")?(function(e,t,n){wr(e,t,n,"markdown")}(e,t,n),!0):(0,v.bA)(t)?(Pr(e,t,n),!0):(0,v.Je)(t)&&Ir(e,n,"code-block")?(function(e,t,n){wr(e,t,n,"code-block")}(e,t,n),!0):!(!(0,v.Je)(t)||!Lr(e,n))&&(function(e,t,n){_r(e,0,n)}(e,0,n),!0))}var qr=n(13109);var Fr;!function(e){e.BackQuote="`",e.Dash="-",e.Enter="enter",e.Space="space"}(Fr||(Fr={}));const Br=(0,p.ZP)(Fr.BackQuote),Hr=(0,p.ZP)(Fr.Dash),Ur=((0,p.ZP)(Fr.Enter),(0,p.ZP)(Fr.Space)),zr=[{regexp:/^``([a-z]+)?$/i,createBlockFn:(e,t)=>({type:"code-block",language:Re.rI,children:[{type:"code-line",children:[{text:""}]}]}),pathTail:[0,0]},{regexp:/^\-\-+$/i,createBlockFn:(e,t)=>({type:"divider",children:[{text:""}]}),pathTail:[]}],Vr=(e,t)=>{f.YR.setSelection(e,{anchor:{path:t,offset:0},focus:{path:t,offset:0}})},Yr=(e,t)=>((e,t)=>"--"===e&&Hr(t.nativeEvent))(e,t)||((e,t)=>"``"===e&&Br(t.nativeEvent))(e,t);const jr=M({"shift+enter":e=>(h.$4.insertNewline(e),!0),"mod+alt+-":e=>(h.$4.insertHorizontalRule(e),!0),"mod+alt+0":e=>(h.$4.setParagraph(e),!0),"mod+alt+1":e=>(h.$4.toggleHeading(e,1),!0),"mod+alt+2":e=>(h.$4.toggleHeading(e,2),!0),"mod+alt+3":e=>(h.$4.toggleHeading(e,3),!0),"mod+alt+7":(e,t)=>(L.action(e,t),!0),"mod+alt+8":(e,t)=>(x.action(e,t),!0),ArrowRight:e=>(h.$4.breakOutOfInlineLink(e),!1)});const Wr=M({backspace(e){const{selection:t}=e;if(!t)return!1;const n=[(0,m.Tt)({editor:e,type:"block-quote"})].filter((e=>e.length>0)),{anchor:r,focus:a}=t;return!(0!==r.offset||0!==a.offset||!n.length)&&(h.$4.setParagraph(e),!0)}});const Gr=e=>t=>({type:"heading",level:e}),Kr=e=>t=>({type:"list",listType:e,children:[{type:"list-item",children:f.W_.isElement(t)?t.children:[{text:""}]}]}),$r={"*":Kr("ul"),"-":Kr("ul"),"+":Kr("ul"),"1.":Kr("ol"),"#":Gr(1),"##":Gr(2),"###":Gr(3),"####":Gr(4),"#####":Gr(5),"######":Gr(6),">":e=>({type:"block-quote"})},Qr=/^\s*(\d+)\.$/;function Jr(e,t,n){if(!(0,yt.tC)(t)&&!(0,Be.SY)(t)){if(function(e,t){if(!Ur(e.nativeEvent))return!1;if(null===t.selection)return!1;if(f.e6.isExpanded(t.selection))return!1;if((0,m.aZ)({editor:t}))return!1;const{anchor:n}=t.selection,r=f.ML.above(t,{match:e=>f.ML.isBlock(t,e)});if(!r)return!1;const[,a]=r,o=f.ML.start(t,a),l={anchor:n,focus:o},i=f.ML.string(t,l);let s=$r[i];const c=i.match(Qr);if(null!=c&&c.length>0&&(s=e=>({children:[{type:"list-item",children:f.W_.isElement(e)?e.children:[{text:""}]}],listType:"ol",type:"list",start:c[1]})),!s)return!1;const[d]=f.ML.above(t,{match:e=>f.ML.isBlock(t,e)})||[];if((0,v.OD)(d)||(0,v.nq)(d))return!1;e.preventDefault(),e.stopPropagation(),f.YR.delete(t,{at:l}),f.YR.select(t,o);const[u]=f.ML.above(t,{match:e=>f.ML.isBlock(t,e)})||[],h="function"==typeof s?s(u):s,p=f.W_.isElement(h)&&h.children.length>0?h.children:u.children;return f.ML.withoutNormalizing(t,(()=>{f.YR.removeNodes(t,{at:a}),f.YR.insertNodes(t,[{...h,children:p}],{at:a,select:!0}),null!=t.selection&&f.YR.setSelection(t,{anchor:f.ML.start(t,t.selection.anchor.path),focus:f.ML.start(t,t.selection.anchor.path)})})),!0}(e,t))return;if(function(e,t){const{selection:n}=t;if(null===n)return!1;if(f.e6.isExpanded(n))return!1;if((0,m.aZ)({editor:t}))return!1;const{anchor:r}=n,a=f.ML.above(t,{match:e=>f.ML.isBlock(t,e)}),o=a?a[1]:[],l={anchor:r,focus:f.ML.start(t,o)},i=f.ML.string(t,l);for(const{regexp:n,createBlockFn:r,pathTail:a}of zr){const l=i.match(n);if(!l)continue;if(!Yr(l[0],e))return!1;e.preventDefault(),e.stopPropagation();const s=r(l,t),c=t.isVoid(s);if(f.YR.removeNodes(t,{at:o}),f.YR.insertNodes(t,s,{at:o}),c){const e=[o[0]+1];f.YR.insertNodes(t,(0,Dr.c)(),{at:e});const n=[...e,0];setTimeout((()=>{Vr(t,n)}))}else{const e=[...o,...a];setTimeout((()=>{Vr(t,e)}),0)}return!0}return!1}(e,t))return}(function(e,t,n){const r=Wr(e,t,n);return r&&e.preventDefault(),r})(e,t,n)||function(e,t,n){const r=jr(e,t,n);r&&e.preventDefault()}(e,t,n)}var Xr=n(98883),ea=n(68079),ta=n.n(ea),na=n(25108);function ra(e){return!!f.xv.isText(e)||!!(f.W_.isElement(e)&&((0,v.OC)(e)||e.children.length>0)&&e.children.every((e=>ra(e))))}n(33792);const aa=e=>{if(f.W_.isElement(e)){const{children:t}=e;return{...e,children:t.map((t=>f.W_.isElement(t)&&t.type===e.type&&"list"!==e.type?t.children.map((e=>aa(e))):aa(t))).flat()}}return e};function oa(e,t){const n=[];return Array.from(e).filter((e=>"style"!==e.nodeName.toLowerCase())).forEach((e=>{const r=e;(0,m.Xi)(r);const a=t.parseHtmlElement(r);if(null==e.parentElement||!f.xv.isText(a)||!["table","tr","tbody","thead"].includes(e.parentElement.nodeName.toLowerCase()))if(null!=a&&f.W_.isElement(a)){const r=oa(e.childNodes,t);r.length>0&&"td"===a.type&&r.some((e=>f.xv.isText(e)))?a.children=[{type:"p",children:r}]:"td"===a.type&&0===r.length?a.children=[{type:"p",children:[{text:""}]}]:(0,v.Ze)(a)?a.children=r.filter(v.N1):r.length>0&&(a.children=r),n.push(a)}else if(null!=a&&f.xv.isText(a))n.push(a);else{oa(e.childNodes,t).forEach((e=>null!=e&&n.push(e)))}})),n.filter(ra)}const la=e=>null!=e&&"function"==typeof e;function ia(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return oa(e,t).reduce(((e,t)=>{const r=e[e.length-1];if(null!=r&&f.W_.isElement(r)&&"p"===r.type&&(f.xv.isText(t)||(0,v.kA)(t))){if(n.inTitle)r.children=[...r.children,t];else{if(!(r.children.filter((e=>f.W_.isElement(e)&&"image"===e.type)).length>0||f.xv.isText(t)))return[...e,{type:"p",children:[t]}];r.children=[...r.children,t]}return e}if(f.xv.isText(t)){const{text:r}=t;var a,o;return(0,En.y)(r)&&n.event&&n.editor&&la(n.insertGuruCardLink)?(g(n.event),null===(a=n.insertGuruCardLink)||void 0===a||a.call(n,n.editor,r),[]):ta()(r)&&n.event&&n.editor&&la(n.insertLink)?(g(n.event),null===(o=n.insertLink)||void 0===o||o.call(n,n.editor,r),[]):[...e,{type:"p",children:[t]}]}return(0,v.kA)(t)?[...e,{type:"p",children:[t]}]:f.W_.isElement(r)&&"list"===r.type&&"list"===t.type?t.listType!==r.listType?[...e,t]:(r.children=[...r.children,...t.children],e):[...e,t]}),[]).map((e=>aa(e)))}const sa={getCloneContainer(){const e=window.getSelection().getRangeAt(0);let t=e.cloneContents();const n=document.createElement("div");if("OL"===e.commonAncestorContainer.tagName){const r=e.commonAncestorContainer.getAttribute("start")||"1",a=document.createElement("ol");a.setAttribute("start",r),a.appendChild(t),n.appendChild(a)}else n.appendChild(t);return n},_handleWhiteSpaceAndAppend(e,t){const n=document.createElement("span");e.innerHTML=e.innerHTML.replace("&nbsp;"," ");const r=e.innerHTML.match(/^\s*/)[0],a=e.innerHTML.match(/\s*$/)[0],o=t.parentNode;0!==r.length||0!==a.length?(r.length&&n.appendChild(document.createTextNode(r)),e.innerHTML=e.innerHTML.trim(),n.appendChild(e),a.length&&n.appendChild(document.createTextNode(a)),o.replaceChild(n,t)):o.replaceChild(e,t)},_transformTagsRecursively(e){if(0===e.childElementCount){if("SPAN"===e.tagName){if(""===e.innerText)return e.parentNode.removeChild(e);const t="H1"===e.parentNode.tagName||"20pt"===e.style.fontSize,n="H2"===e.parentNode.tagName||"16pt"===e.style.fontSize,r="H3"===e.parentNode.tagName||"13.999999999999998pt"===e.style.fontSize,a="A"===e.parentNode.tagName,o="700"===e.style.fontWeight,l=e.style.textDecoration.includes("underline"),i="italic"===e.style.fontStyle,s=e.style.backgroundColor&&!["transparent","rgb(255, 255, 255)"].includes(e.style.backgroundColor.toLowerCase()),c=e.style.textDecoration.includes("line-through"),d=e.style.color&&"rgb(0, 0, 0)"!==e.style.color,u=new DOMParser;let h=[e.innerHTML];if(l&&(h=["<u>",...h,"</u>"]),o&&(h=["<b>",...h,"</b>"]),i&&(h=["<em>",...h,"</em>"]),s&&(h=["<mark>",...h,"</mark>"]),c&&(h=["<del>",...h,"</del>"]),d){const t=[...Ie.Colors,"#5f5f5f"].reduce(((e,t,n)=>({["_".concat(n)]:t,...e})),{});try{const n=Le().from(t)(e.style.color);h=s?['<span style="color: '.concat(n.value,";background-color:").concat(e.style.backgroundColor,'" data-ghq-card-content-type="').concat(we.$_.contentTypeValue,'">'),...h,"</span>"]:['<span style="color: '.concat(n.value,';" data-ghq-card-content-type="').concat(we.$_.contentTypeValue,'">'),...h,"</span>"]}catch(e){h=["<span>",...h,"</span>"]}}a&&(h=['<a href="',e.parentNode.href,'">',...h,"</a>"]),t&&(h=["<h1>",...h,"</h1>"]),n&&(h=["<h2>",...h,"</h2>"]),r&&(h=["<h3>",...h,"</h3>"]),1===h.length&&(h=["<span>",...h,"<span>"]),this._handleWhiteSpaceAndAppend(u.parseFromString(h.join(""),"text/html").body.firstElementChild,e)}}else{const t=e.childNodes,n=e.childNodes.length;for(let e=0;e<n;e++)this._transformTagsRecursively(t[e],e)}},GoogleDocPasteShim(e){const t=document.createElement("div");t.innerHTML=e;const n=t.querySelectorAll("div > meta + meta + b")[0];if(!n||-1===n.id.indexOf("docs-internal-guid"))return e;const r=t.getElementsByTagName("meta"),a=r.length;for(let e=0;e<a;e++)r[0].remove();let o=t.childNodes;for(let e=0;e<o.length;e++)"B"===o[e].tagName&&(t.innerHTML=o[0].innerHTML,o=[]);return this._transformTagsRecursively(t,0),t.innerHTML.replace(/<br>/g,"").replace(/<br \/>/g,"")},MicrosoftPasteShim(e){if(!e.includes("schemas-microsoft-com"))return e;e=(e=(e=(e=(e=(e=e.replace(/<!--[\s\S]+?-->/gi,"")).replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,"")).replace(/<(\/)?html(.*(\n*\r*)*.*){3}>/gi,"")).replace(/<(\/)?head>/gi,"")).replace(/<(\/)?body.*>/gi,"")).replace(/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,((e,t)=>t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join("\xa0"):""));const t=document.createElement("div");t.innerHTML=e;Array.from(t.querySelectorAll("img")).forEach(((e,t)=>{t.parentNode.removeChild(t)})),Array.from(t.querySelectorAll("*")).forEach((e=>{if(!e.getAttribute("style"))return;const t=e.getAttribute("style").split(";").reduce(((e,t)=>({...e,[t.split(":")[0]]:t.split(":")[1]})),{}),n=[];t["font-weight"]&&n.push(document.createElement("b")),t["font-style"]&&n.push(document.createElement("em")),(t["mso-background"]||t["mso-highlight"])&&n.push(document.createElement("mark")),"para-border-div"===t["mso-element"]&&n.push(document.createElement("hr"));const r=/\w+ \w+([0-9]+)/i.exec(t["mso-list"]);n.forEach((t=>{e.parentElement.replaceChild(t,e),t.appendChild(e),e=t})),r&&(e._listLevel=parseInt(r[1],10)),"Ignore"===t["mso-list"]&&e.firstChild&&(e._listIgnore=!0,e.firstChild._listIgnore=!0)})),this.handleMicrosoftFakeLists(t);let n=null;return Array.from(t.querySelectorAll("p")).forEach((e=>{const t=1===e.innerText.length&&160===e.innerText.charCodeAt(0),r=e.nextSibling&&"P"===e.nextSibling.tagName&&(1===e.nextSibling.innerText.length&&160===e.nextSibling.innerText.charCodeAt(0)||0===e.nextSibling.innerText.length);e!==n&&(!t&&e.innerText.length||(r&&(n=e.nextSibling),e.parentNode.removeChild(e)))})),t.innerHTML.replace(/\n+/gm," ")},handleMicrosoftFakeLists(e){let t,n,r=1;function a(e){return e=e.replace(/^[\u00a0 ]+/,""),[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/].some((t=>t.test(e)))}function o(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.nextSibling,r=e.parentNode;if(!t)return n;for(;!n&&r;)n=r.nextSibling,r=r.parentNode;return n}function l(e){if(3===e.nodeType)return e.textContent;let t="";if(e=e.firstChild)do{t+=l(e)}while(e=o(e));return t.replace(/(\r\n|\n|\r)/gm,"")}function i(e,t){if(3===e.nodeType&&t.test(e.textContent))return e.textContent=e.textContent.replace(t,""),!1;if(e=e.firstChild)do{if(!i(e,t))return!1}while(e=o(e));return!0}function s(e){if(e._listIgnore)e.parentElement.removeChild(e);else if(e=e.firstChild)do{s(e)}while(e=o(e))}function c(e,a,o){let l=e._listLevel||r;l!==r&&(l<r?t&&(t=t.parentElement.parentElement):(n=t,t=null)),t&&t.tagName===a||(n=n||t,t=document.createElement(a),o>1&&t.setAttribute("start","".concat(o)),e.parentElement.replaceChild(t,e)),t.appendChild(e);const c=document.createElement("li");e.parentElement.replaceChild(c,e),c.appendChild(e),l>r&&n&&n.lastChild.appendChild(t),r=l,s(e),i(e,/^\u00a0+/),i(e,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(e,/^\u00a0+/)}let d=[],u=e.firstChild;for(;null!=u;)if(d.push(u),u=o(u,!0),null!==u)for(;void 0!==u&&u.parentNode!==e;)u=o(u,!0);d=d.filter((e=>3!==e.nodeType));for(let r=0;r<d.length;r++)if((e=d[r]).firstChild){let n=l(e);if(/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(n))return c(e,"UL");if(a(n)){let t=/([0-9]+)\./.exec(n),r=1;return t&&(r=parseInt(t[1],10)),c(e,"OL",r)}if(e._listLevel)return c(e,"UL",1);t=null}else n=t,t=null}};var ca=sa;var da=n(71733);function ua(e){return h.$4.isInside(e,"td")}function ha(e,t){const n=e,r=n.innerHTML,a=document.createElement(t);a.innerHTML=r,[...n.attributes].forEach((e=>{a.setAttribute("id"===e.nodeName?"data-id":e.nodeName,e.nodeValue||"")})),n.replaceWith(a)}const pa=e=>Ee(e,"FILE");function ma(e){const t=function(e){const t=[];for(const r of e.childNodes){const e=r;if("CODE"===e.nodeName&&t.push(e),"CODE"===e.nodeName&&"CODE_BLOCK_LINE"===e.dataset.ghqCardContentType&&e.dataset.slateFragment){const r=decodeURIComponent(atob(e.dataset.slateFragment));let a;try{var n;a=JSON.parse(r);const e=null===(n=a)||void 0===n?void 0:n.nodes[0];if("MARKDOWN_EDIT"===e.type&&(null==e?void 0:e.nodes.length)===t.length){const e=document.createElement("div"),n=document.createElement("pre");return n.setAttribute("data-ghq-card-content-type","MARKDOWN"),t.forEach((e=>n.appendChild(e))),e.appendChild(n),e.childNodes}}catch(e){return null}}}return null}(e)||function(e){for(const o of e.childNodes){var t;const e=o,l=null==e||null===(t=e.querySelector)||void 0===t?void 0:t.call(e,"pre");if(l&&"CODE_BLOCK"===l.dataset.ghqCardContentType){var n;const e=null===(n=l.querySelector)||void 0===n?void 0:n.call(l,"[data-testid='Copy Code']");if(e){var r,a;const t=null===(r=e.parentElement)||void 0===r?void 0:r.textContent,n=Re.V1.find((e=>e.label===t))||Re.V2,{value:o,label:i}=n;l.setAttribute("data-ghq-code-block-syntax",i),l.setAttribute("data-ghq-code-block-prism",o),(null===(a=l.querySelectorAll)||void 0===a?void 0:a.call(l,"code")).forEach((e=>l.appendChild(e)))}}}const o=[];for(const t of e.childNodes){const e=t;if("CODE"===e.nodeName&&o.push(e),"CODE"===e.nodeName&&"CODE_BLOCK_LINE"===e.dataset.ghqCardContentType&&e.dataset.slateFragment){const t=decodeURIComponent(atob(e.dataset.slateFragment));let n;try{var l;n=JSON.parse(t);const e=null===(l=n)||void 0===l?void 0:l.nodes[0];if("CODE_BLOCK"===e.type&&(null==e?void 0:e.nodes.length)===o.length){var i,s;const t=document.createElement("div"),n=document.createElement("pre");return n.setAttribute("data-ghq-card-content-type","CODE_BLOCK"),n.setAttribute("data-ghq-code-block-syntax",null==e||null===(i=e.data)||void 0===i?void 0:i.syntaxDisplay),n.setAttribute("data-ghq-code-block-prism",null==e||null===(s=e.data)||void 0===s?void 0:s.syntaxValue),o.forEach((e=>n.appendChild(e))),t.appendChild(n),t.childNodes}}catch(e){return null}}}return null}(e)||e.childNodes;return function(e){for(const r of e.children){var t;const a=null===(t=r.querySelector)||void 0===t?void 0:t.call(r,"a");if("P"===r.nodeName&&pa(a))continue;const o=null==a?void 0:a.closest("p");if(pa(a)&&!o)e.replaceChild(a,r);else if(o){var n;const e=null===(n=o.querySelector)||void 0===n?void 0:n.call(o,"a");e&&pa(e)&&o.replaceChild(e,e.parentNode)}}e.childNodes}(e),function(e){for(let n of e.children){var t;const e=null===(t=n.querySelector)||void 0===t?void 0:t.call(n,'[data-ghq-card-content-type="IFRAME"]');e&&e.parentElement&&ha(e.parentElement,"div")}e.childNodes}(e),t}function ga(e,t,n){Xr.v.addAction("editorPaste");const r=Array.from(e.clipboardData.types);if(!r.includes("text/html")||!(e=>{if(!e.clipboardData)return!1;try{const t=e.clipboardData.getData("application/x-slate-fragment");if(!t)return!1;const n=JSON.parse(decodeURIComponent(atob(t)));return!Array.isArray(n)}catch(e){var t;null===(t=window.Rollbar)||void 0===t||t.error(e),na.error(e)}return!1})(e)&&r.includes("application/x-slate-fragment")){if(r.includes("text/plain")){const t=e.clipboardData.getData("text/plain");if(!ta()(t))return;if((0,En.y)(t))return g(e),void(0,En.h)(n,t);if(ta()(t))return g(e),void(0,da.T8)(n,t)}}else{const r=(0,m.aZ)({editor:n});e.preventDefault();const l=e.clipboardData.getData("text/html"),i=document.createElement("div");let s;i.innerHTML=l.replace(/(\r\n|\n|\r)/gm,"");const c=function(e,t){const n=e.querySelector("div > meta + meta + b");return n&&n.id.includes("docs-internal-guid")?$(ca.GoogleDocPasteShim(t)):null}(i,l)||function(e){return e.includes("schemas-microsoft-com")?$(ca.MicrosoftPasteShim(e)):null}(l);c?(i.innerHTML=c,s=i.childNodes):s=ma(i);const d=ia(s,t,{event:e,editor:n,insertGuruCardLink:En.h,insertLink:da.T8,inTitle:r});if(r)f.YR.insertNodes(n,d,{at:[0]});else{if(!n.selection)return;const e=f.y$.parent(n.selection.anchor.path);if(!f.ML.hasPath(n,e))return;const t=f.NB.get(n,e),r=f.ML.isEmpty(n,t),l=(0,m.OY)(n);let i="";var a,o;if(n.selection&&!f.e6.isExpanded(n.selection)&&f.ML.hasPath(n,n.selection.focus.path)&&f.ML.hasPath(n,n.selection.anchor.path))i=null===(a=f.ML.leaf(n,n.selection)[0])||void 0===a?void 0:a.text;if(r&&!ua(n)&&f.YR.move(n,{distance:1,unit:"line",reverse:!0}),ua(n)&&""===i)f.YR.insertNodes(n,d,{at:null==l||null===(o=l.curr)||void 0===o?void 0:o.path});else f.YR.insertNodes(n,d)}}}const fa={editableProps:{},toolbarActions:[],popoverActions:[],renderOutside:()=>r.createElement(r.Fragment,null,null),renderPopover:()=>r.createElement(r.Fragment,null,null),serializeElement:()=>"",parseHtmlElement:()=>null},va=(e,t,n)=>{let r={...fa,editableProps:{onKeyDown:e=>Jr(e,t,n),onPaste:e=>ga(e,r,t),onDrop:e=>{}}};for(const a of e)r=a(r,t,n);return r};function Ea(e){const{selection:t}=e;if(null==t)return!1;if(f.e6.isExpanded(t))return!1;const{anchor:n}=t,r=f.ML.above(e,{match:v.CQ});if(null==r)return!1;const[a,o]=r;if(!f.ML.isEnd(e,n,o))return!1;const l=(i=a,(0,v.OD)(i)?{...i,children:[{text:""}]}:(0,Dr.c)());var i;const s=[...o],c=s.pop();s.push((c||0)+1);const d=[...s,0];return f.ML.withoutNormalizing(e,(()=>{f.YR.insertNodes(e,l,{at:s}),f.YR.select(e,{path:d,offset:0})})),!0}const ba=[$t.ZP.Slime,$t.ZP.Jelly,$t.ZP.Yolk,$t.ZP.Fruitpunch,$t.ZP.Coulis,$t.ZP.Marmalade,$t.ZP.Violet,$t.ZP.Midnight];function ya(){return ba[Math.floor(Math.random()*ba.length)]}var Ca=n(31954);function Na(e,t,n){let r=t||(0,f.Jh)();e&&(r=(0,vr.KK)((0,vr.hX)(r,e.document.get("content",br.eI),{autoConnect:!1}),e.awareness,{data:n})),r=(0,u.BU)((e=>{const{normalizeNode:t}=e;return e.normalizeNode=n=>{let[r,a]=n;if(Or.D.getState().isBootstrapping)return t([r,a]);if(0===a.length){if(e.children.length<1){const t=(0,Ar.q)();f.YR.insertNodes(e,t,{at:a.concat(0)})}for(const[t,n]of f.NB.children(e,a)){const r=n[0],a=r=>{"title"===r&&f.W_.isElement(t)&&t.type!==r?f.YR.setNodes(e,{type:r},{at:n}):null==r&&f.W_.isElement(t)&&"title"===t.type&&f.YR.setNodes(e,{type:"p"},{at:n})};0===r?a(qr.H.Title):r>0&&a()}}return t([r,a])},e})(function(e){const{normalizeNode:t}=e;return e.normalizeNode=n=>{if(Or.D.getState().isBootstrapping)return t(n);const[r,a]=n;Rr(r,e),!Zr(e,r,a)&&f.ML.hasPath(e,a)&&t(n)},e}((0,Er.VC)(r)))),r.isVoid=v.OC,r.isInline=v.kA;const a=r.insertBreak;r.insertBreak=()=>{Ea(r)||a()};const o=r.deleteBackward;r.deleteBackward=e=>{(function(e,t){const n=f.ML.above(e,{match:e=>f.W_.isElement(e)&&"td"===e.type});return null!=n&&f.ML.isStart(e,e.selection.anchor,n[1])})(r)||o(e)};const l=r.deleteForward;return r.deleteForward=e=>{(function(e,t){const n=f.ML.above(e,{match:e=>f.W_.isElement(e)&&"td"===e.type});return null!=n&&f.ML.isEnd(e,e.selection.anchor,n[1])})(r)||l(e)},r}function Ta(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;const n=(0,Gt.y)(),[a]=(0,Ca.Z)(),o=(0,Or.D)((e=>t?e.provider:void 0)),l={displayName:a.data.name,email:a.data.email,firstName:a.data.firstName,lastName:a.data.lastName,profilePic:a.data.profilePicUrl,id:a.data.id,color:ya()},i=(0,r.useMemo)((()=>(0,f.Jh)()),[]),s=(0,r.useMemo)((()=>{const t=Na(o,i,l);return{editor:t,...va(e,t,n)}}),[e,o,i]),c=s.editor;return(0,r.useEffect)((()=>{const e=null==o?void 0:o.document.get("entities",br.D5);e&&Object.keys(n.contextState.entities).forEach((t=>{const r=e.get(t),a=n.contextState.entities[t];JSON.stringify(a)!==JSON.stringify(r)&&e.set(t,a)}))}),[n.contextState.entities,o]),(0,r.useEffect)((()=>{if(o&&o.isSynced&&null!=c.sharedRoot&&c.sharedRoot.length>0&&0===c.children.length){const e=o.document.get("content"),t=(0,vr.Rx)(e),r=null==o?void 0:o.document.get("entities"),a={};r.forEach(((e,t)=>{null!=e&&(a[t]=e)})),n.setContextState((e=>({...e,entities:{...e.entities,...a}}))),f.ML.withoutNormalizing(c,(()=>{Er.MO.withoutSaving(c,(()=>{f.YR.insertNodes(c,t.children,{at:[0]})}))}))}}),[o,c]),(0,r.useEffect)((()=>{if(!o)return;o.isSynced||null==o||o.connect();const e=null==o?void 0:o.document.get("entities"),t=()=>{const t={};e.forEach(((e,n)=>{null!=e&&(t[n]=e)})),n.setContextState((e=>({...e,entities:{...e.entities,...t}})))};return null==e||e.observe(t),()=>{null==e||e.unobserve(t),null==o||o.disconnect()}}),[o]),(0,r.useEffect)((()=>{if(o)return vr.og.connect(c),()=>vr.og.disconnect(c)}),[o]),s}var Sa=n(33200),ka=n(4952);var xa,La=n(93390),_a=n(27361),Ia=n.n(_a),wa=n(22386),Ma=n(53056),Pa=n(18440),Da=n(43814);const Aa="UP",Oa="DOWN",Ra="KEYDOWN",Za={className:jt().string,defaultHighlightedIndex:jt().any,selectable:jt().bool,focusable:jt().bool,embedded:jt().bool,stickyHover:jt().bool,noArrowKeys:jt().bool,selected:jt().bool,highlighted:jt().bool,highlightedBy:jt().string,style:jt().object,onLockParentMenu:jt().func,onUnlockParentMenu:jt().func,onExitMenuTop:jt().func,onExitMenuBottom:jt().func};var qa=(0,Ma.Z)(((xa=class extends r.Component{constructor(e){super(e),this.componentDidUpdate=()=>{const{highlighted:e,selectable:t,embedded:n,selectableIndex:r,defaultHighlightedIndex:a,parentIsLocked:o,onLockParentMenu:l}=this.props,{highlightedIndex:i,locked:s}=this.state,c=t?e:!s;if(n&&t&&!e&&-1!==i&&this.setState({highlightedIndex:-1}),c&&!this.highlightedTargetExists(i)){if(i===a)return;n?(a===Oa&&this.setState({highlightedIndex:0}),a===Aa&&this.setState({defaultHighlightedIndex:this.getLastSelectableIndex()})):this.setState({highlightedIndex:a})}t&&e&&!o&&l(r)},this.highlightedTargetExists=e=>{const{children:t}=this.props;let n=0,a=!1;return r.Children.forEach(t,(t=>{Ia()(t,"props.selectable")&&(e===n&&(a=!0),n+=1)})),a},this.getLastSelectableIndex=()=>{const{children:e}=this.props;let t=-1;return r.Children.forEach(e,(e=>{Ia()(e,"props.selectable")&&(t+=1)})),t},this.handleMouseDown=e=>{this.props.focusable&&e.preventDefault()},this.handleChildHighlighted=e=>{const{onLockParentMenu:t,selectableIndex:n,parentIsLocked:r}=this.props;t&&!r&&t(n),this.setState({highlightedIndex:e,highlightedBy:"HOVER",locked:!1})},this.handleClickOutside=()=>{this.props.onClickOutside()},this.handleLockMenu=e=>{this.setState({locked:!0,highlightedIndex:e})},this.handleUnlockMenu=()=>{this.setState({locked:!1})},this.handleSelectNext=(e,t)=>{const{selectable:n,highlighted:r,onUnlockParentMenu:a,onExitMenuBottom:o}=this.props,{highlightedIndex:l,locked:i}=this.state;if(!t&&(n&&!r||i))return;e&&e.preventDefault();const s=l+1;this.highlightedTargetExists(s)?this.setState({highlightedIndex:s,direction:Oa,highlightedBy:Ra}):a&&o&&(o(),a(),this.setState({highlightedIndex:-1,highlightedBy:Ra}))},this.handleArrowDown=e=>{const{noArrowKeys:t}=this.props;t||this.handleSelectNext(e)},this.handleTab=e=>{this.handleSelectNext(e)},this.handleSelectLast=(e,t)=>{const{selectable:n,highlighted:r,onUnlockParentMenu:a,onExitMenuTop:o}=this.props,{highlightedIndex:l,locked:i}=this.state;if(!t&&(n&&!r||i))return;e&&e.preventDefault();const s=l-1;this.highlightedTargetExists(s)?this.setState({highlightedIndex:s,highlightedBy:Ra,direction:Aa}):a&&o&&(o(),a(),this.setState({highlightedIndex:-1,highlightedBy:Ra}))},this.handleArrowUp=e=>{const{noArrowKeys:t}=this.props;t||this.handleSelectLast(e)},this.handleShiftTab=e=>{this.handleSelectLast(e)},this.getManipulatedChildren=()=>{const{children:e,stickyHover:t}=this.props,{highlightedIndex:n,highlightedBy:a,direction:o,locked:l}=this.state;let i=0;return r.Children.map(e,(e=>{if(!Ia()(e,"props.selectable"))return e;if(i!==n){const n=(0,r.cloneElement)(e,{selectableIndex:i,stickyHover:t,parentIsLocked:l,onLockParentMenu:this.handleLockMenu,onUnlockParentMenu:this.handleUnlockMenu,onHover:this.handleChildHighlighted});return i+=1,n}const s=(0,r.cloneElement)(e,{selectableIndex:i,highlightedBy:a,stickyHover:t,highlighted:!0,defaultHighlightedIndex:o,parentIsLocked:l,onLockParentMenu:this.handleLockMenu,onUnlockParentMenu:this.handleUnlockMenu,onExitMenuTop:this.handleSelectLast.bind(null,null,!0),onExitMenuBottom:this.handleSelectNext.bind(null,null,!0),onHover:this.handleChildHighlighted});return i+=1,s}))};const{defaultHighlightedIndex:t}=this.props;let n=t;n===Oa&&(n=0),n===Aa&&(n=this.getLastSelectableIndex()),this.state={highlightedIndex:n,highlightedBy:"",locked:!1,direction:null}}render(){const{className:e,embedded:t,style:n}=this.props,a=Ye()("ghq-fact-editor-menu",e,{"ghq-is-embedded":t,"ghq-is-mobile":(0,Da.tq)()});return r.createElement("div",{style:n,className:a,onMouseDown:this.handleMouseDown},this.getManipulatedChildren())}}).propTypes=Za,xa.defaultProps={defaultHighlightedIndex:-1,stickyHover:!0,style:{}},xa),!0);const Fa=(0,Ma.Z)((0,wa.Z)(class extends r.Component{constructor(){super(...arguments),this.componentDidMount=()=>{this.scrollOnKeydownHighlight()},this.componentDidUpdate=()=>{this.scrollOnKeydownHighlight()},this.scrollOnKeydownHighlight=()=>{const{highlightedBy:e,highlighted:t}=this.props;e===Ra&&t&&(0,Pa.n5)(this.item)},this.handleSelect=e=>{const{value:t,onSelect:n,selectable:r}=this.props;r&&n&&n(t,e)},this.handleMouseDown=e=>{e.preventDefault()},this.handleEnter=e=>{const{highlighted:t,value:n,selectable:r,onSelect:a}=this.props;t&&r&&(e.stopImmediatePropagation(),e.preventDefault(),a(n))},this.handleHover=()=>{const{selectableIndex:e,stickyHover:t,selectable:n,showTooltip:r,onHover:a}=this.props;r(this.item),t&&n&&a(e)}}render(){const{ariaLabel:e,className:t,children:n,selected:a,selectable:o,highlighted:l,disabled:i,hideTooltip:s,dataTestId:c,dataEventId:d}=this.props,u=Ye()("ghq-fact-editor-menu-item Button-sage Button-sage--icon",t,{"ghq-is-selected":a,"ghq-is-selectable":o,"ghq-is-highlighted":l,"ghq-is-disabled":i,"ghq-is-mobile":(0,Da.tq)()});return r.createElement("button",{disabled:i,"data-testid":c,ref:e=>{this.item=e},"aria-label":e,"data-eventid":d,type:"button",className:u,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleHover,onFocus:this.handleHover,onMouseLeave:s,onBlur:s,onClick:this.handleSelect},n)}}));var Ba=(0,wa.Z)((e=>{let{title:t,showTooltip:n,hideTooltip:a}=e;const o=r.useRef(null);return r.createElement("span",{className:"ghq-fact-editor-guru-card-results-menu__option-title",ref:o,onMouseEnter:e=>{o.current.offsetWidth<o.current.scrollWidth&&n(e)},onMouseLeave:a},t)})),Ha=n(98512);const Ua={target:jt().any,results:jt().array,searching:jt().bool};class za extends r.Component{constructor(){super(...arguments),this.handleSelect=e=>{const{onSelect:t}=this.props;t(e)}}render(){const{target:e,results:t,searching:n}=this.props;if(!t.length)return null;const a=t.map((e=>{const{collection:t,preferredPhrase:n,id:a}=e;return r.createElement(Fa,{selectable:!0,key:a,className:"ghq-fact-editor-guru-card-results-menu__option",value:e,onSelect:this.handleSelect},r.createElement(Nn.Z,{className:"ghq-fact-editor-guru-card-results-menu__option-icon",icon:"collection",tooltipped:{message:t.name},style:{fill:t.color}}),r.createElement(Ba,{title:n,tooltipped:{message:n,preferredXPosition:"right",preferredYPosition:"center"}}))}));return r.createElement(Ha.Z,{poll:!0,sameWidthAsTarget:!0,target:e,preferredXPosition:"center",preferredYPosition:"bottom"},r.createElement(qa,{className:"ghq-fact-editor-guru-card-results-menu",defaultHighlightedIndex:0},r.createElement(La.Z,{className:"ghq-fact-editor-guru-card-results-menu__reloader",isReloading:n}),a))}}za.propTypes=Ua;var Va=n(21576),Ya=n(77110),ja=n(31306),Wa=n(12713),Ga=n.n(Wa),Ka=n(47111),$a=n(28642);const Qa=e=>{const t=e.split("/").filter(Boolean).slice(-2);return"facts"!==t[0]&&"card"!==t[0]?t[0]:t[1]},Ja=e=>{var t;null!==(t=e)&&void 0!==t&&t.includes("http")&&(e=Qa(e));const[{items:{data:n},status:a},o]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ga().GLOBAL;const[t,n]=(0,Ka.Z)({filterId:e,store:$a.Z,actions:ja.Z});return[t,n]}(e);(0,r.useEffect)((()=>{e&&[Ya.S.NotLoaded].includes(a)&&o.get({pathVars:[e]})}),[e]);const l=n.find((t=>{const n=t.slug.split("/")[0];return t.id===e||n===e}));return{isLoading:a===Ya.S.Loading,isError:a===Ya.S.Loaded&&null==l,card:l}};var Xa=n(51710);function eo(){return eo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eo.apply(this,arguments)}const to=e=>{let{factId:t,onClose:n,changeLinkedCard:a}=e;const[o,l]=r.useState(""),[i,s]=(0,r.useState)(),[c]=(0,Va.Z)("fact-search-".concat(t)),d=(0,r.useRef)(null);(0,r.useEffect)((()=>{var e;const t=e=>{"Escape"===e.key&&n()},r=null===(e=d.current)||void 0===e?void 0:e.querySelector("input");return null==r||r.addEventListener("keydown",t),()=>{null==r||r.removeEventListener("keydown",t)}}),[d.current,n]);const u=o&&!["*","#","!"].includes(o.split("")[0]);return r.createElement(r.Fragment,null,r.createElement("label",{className:"ghq-PopoverContent__field-label"},"Select Card"),r.createElement("div",{"data-testid":"GuruCardSearch",ref:d,className:"ghq-SearchUI__content"},r.createElement(Xa.Z,{autoFocusOpensMenu:!0,focusOnMount:!0,ref:e=>{s(e)},className:"ghq-SearchUI__search-bar",menuAnchorProps:{preferredXPosition:"right",preferredYPosition:"center"},refKey:"fact-search-".concat(t),onInput:e=>{l(e)}}),r.createElement(za,{results:u?c.data:[],searching:c.status===An.SEARCHING,target:i,onSelect:e=>{const t=e.preferredPhrase,n={url:"".concat(Sa.ZP.APP_URL,"/card/").concat(e.slug),id:e.id,text:t,title:e.preferredPhrase,collectionName:e.collection.name,collectionColor:e.collection.color,collectionId:e.collection.id};a({guruCard:n,text:t})}})))},no=e=>{let{element:t,openSearchUI:n,unattachCard:a,deleteGuruCard:o}=e;const{card:l,isLoading:i,isError:s}=Ja(t.id),c=(0,u.GQ)(),d="".concat(Sa.ZP.APP_URL,"/card/").concat(null!=l?l.slug:t.id),h=null==l?void 0:l.collection.color,p=r.useContext(Pn.ZP);return r.createElement("div",{className:"ghq-DefaultUI__content",style:{fill:h}},r.createElement("div",{className:"ghq-CollectionIcon__button"},r.createElement(We.ZP,{icon:b.Z.Collection,aria:(null==l?void 0:l.collection.name)||"",tooltipLabel:null==l?void 0:l.collection.name,tooltipPosition:We.DU.Bottom,style:We.Dd.Standard,iconSize:16})),i?r.createElement(Mn,null):s?"Card unavailable":r.createElement("a",{href:d,target:"_blank"},null==l?void 0:l.preferredPhrase),c?r.createElement(We.ZP,{aria:"copy-link-to-guru-card",tooltipLabel:"Copy Link to Guru Card",tooltipPosition:We.DU.Top,icon:b.Z.Link,iconSize:16,style:We.Dd.Standard,onClick:()=>{(e=>{let{url:t,factId:n}=e;bn.Z.copy(t),mn.Z.createToast({content:"Guru Card link copied!",id:"next-fact-editor-".concat(n)})})({url:d,factId:null==p?void 0:p.id})}}):r.createElement(r.Fragment,null,r.createElement(We.ZP,{aria:"Edit Guru Card",tooltipLabel:"Edit Guru Card",tooltipPosition:We.DU.Top,icon:b.Z.Pencil,iconSize:16,style:We.Dd.Standard,onClick:n}),r.createElement(We.ZP,{aria:"Unattach Guru Card",tooltipLabel:"Unattach Guru Card",tooltipPosition:We.DU.Top,icon:b.Z.Unlink,iconSize:16,style:We.Dd.Standard,onClick:a}),r.createElement(We.ZP,{aria:"Delete Guru Card",tooltipLabel:"Delete Guru Card",tooltipPosition:We.DU.Top,icon:b.Z.Delete,iconSize:16,style:We.Dd.Standard,onClick:o})))},ro=r.forwardRef(((e,t)=>{var n;let{style:a,element:o,popoverMode:l,setPopoverMode:i,...s}=e;const c=(0,u._7)(),d=r.useContext(Pn.ZP),[h,p]=r.useState(!Boolean(null==o?void 0:o.id)),m=null!=o&&u.F3.findPath(c,o),g=()=>{i("hidden"),u.F3.focus(c)};return r.createElement("div",eo({},s,{ref:t,"data-testid":"PopoverGuruCard",style:{...a,position:"fixed"}}),r.createElement(Ft,{className:h?"ghq-SearchUI":"ghq-DefaultUI"},r.createElement("div",{className:"ghq-PopoverGuruCard__content"},h?r.createElement(to,{factId:null==d||null===(n=d.card)||void 0===n?void 0:n.id,changeLinkedCard:e=>{m?f.YR.setNodes(c,{id:e.guruCard.id},{at:m}):c.selection&&f.e6.isCollapsed(c.selection)?f.YR.insertNodes(c,[{type:"guru-card",id:e.guruCard.id,children:[{text:e.text}]}]):(f.YR.wrapNodes(c,{type:"guru-card",id:e.guruCard.id,children:[]},{split:!0}),f.YR.collapse(c,{edge:"end"})),g(),f.YR.move(c,{distance:1,unit:"offset"})},onClose:()=>{g(),f.YR.move(c,{distance:1,unit:"offset"}),f.YR.move(c,{distance:1,unit:"offset",reverse:!0})}}):null!=o&&r.createElement(no,{element:o,openSearchUI:()=>{i("editingGuruCard"),p(!0)},unattachCard:()=>{m&&f.YR.unwrapNodes(c,{at:m}),g()},deleteGuruCard:()=>{m&&f.YR.removeNodes(c,{at:m}),g()},onClose:()=>{g()}}))))}));function ao(){return ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ao.apply(this,arguments)}var oo=e=>{let{actions:t,attributes:n,element:a,children:o}=e;const l=(0,u._7)(),[i,s]=(0,r.useState)("guruCard"),c=(0,u.GQ)(),[d,h]=r.useState(!1),p=Ye()("ghq-GuruCardLink",{"ghq-is-readonly":c}),{card:m}=Ja(a.id),g=null==m?void 0:m.preferredPhrase,v=Sa.ZP.APP_URL,E="/card/".concat(null!=m?m.slug:a.id),b="".concat(v).concat(E);(0,r.useEffect)((()=>{const e=setTimeout((()=>{const e=u.F3.findPath(l,a);f.ML.hasPath(l,e)&&f.YR.setNodes(l,{url:b},{at:e})}),100);return()=>clearTimeout(e)}),[b,a]);const y=c&&Sa.ZP.READ_ONLY_CARDS_OPEN_IN_NEW_TAB?{href:b,target:"_blank",rel:"noreferrer noopener"}:{href:b},C=((0,u.vt)()||d)&&(null==l.selection||f.e6.isCollapsed(l.selection)),N=_n(C,100);(0,r.useEffect)((()=>{s(N?"guruCard":"hidden")}),[N]),(0,r.useEffect)((()=>{if(g&&l.selection){const e=f.y$.parent(l.selection.anchor.path),t=f.NB.get(l,e);if(!(0,ka.cc)(t))return;const n=a.children[0].text,r=n===g,o=n.includes(E),i=o?g:n;!r&&o&&f.YR.insertText(l,i,{at:e})}}),[g]),(0,r.useEffect)((()=>{"hidden"===i&&h(!1)}),[i,d]);const T=(0,r.useCallback)((()=>{"hidden"===i&&s("guruCard"),h(!0)}),[i]),S=(0,r.useCallback)((()=>{"editingGuruCard"!==i&&h(!1)}),[i]),k="hidden"!==i&&"editingGuruCard"===i||N;return r.createElement(r.Fragment,null,k&&r.createElement(Ln,{renderPopover:e=>r.createElement(ro,ao({target:n.ref.current},e,{element:e.element})),popoverMode:i,setPopoverMode:s,target:n.ref,element:a,onMouseOver:T,onMouseLeave:S}),r.createElement("a",ao({},y,P({attributes:n,element:a}),{className:p,onMouseOver:T,onMouseLeave:S}),r.createElement(Nn.Z,{contentEditable:!1,icon:"g",size:1,sizeModifier:"em",className:"ghq-editor-no-copy ghq-next-card-content__guru-card-icon"}),o))};function lo(){return lo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lo.apply(this,arguments)}const io={icon:b.Z.G,label:"Guru Card",type:"guru-card",action:(e,t)=>(t.setContextState((e=>bt(e,"editingGuruCard"))),!0)},so=M({"mod+alt+[":(e,t)=>(io.action(e,t),!0)}),co=(e,t,n)=>{const{normalizeNode:a}=t;return t.normalizeNode=e=>{const[n,r]=e;if((0,v.cc)(n)&&0===f.NB.string(n).length){f.YR.removeNodes(t,{at:r});0===f.NB.parent(t,r).children.length&&f.YR.insertNodes(t,{text:""},{at:r})}else a(e)},{...e,editableProps:{...e.editableProps,onKeyDown:r=>{var a,o;if(!so(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)},renderElement:t=>{var n,a;return"guru-card"===t.element.type?r.createElement(oo,lo({},t,{element:t.element,actions:e.toolbarActions})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},renderPopover:t=>"editingGuruCard"===t.popoverMode?r.createElement(ro,lo({},t,{element:t.element})):e.renderPopover(t),toolbarActions:[...e.toolbarActions,io],popoverActions:[...e.popoverActions,io],serializeElement:(t,n)=>(0,v.cc)(t)?((e,t)=>{var n;return(0,O.U)({node:e,classType:"guru-card",contentTypeValue:"GURU_CARD",element:"a",serialize:t,attributes:{target:"_blank",rel:"noopener noreferrer",href:e.url,"data-ghq-guru-card-id":null!==(n=e.id)&&void 0!==n?n:""}})})(t,n):e.serializeElement(t,n),parseHtmlElement:t=>e.parseHtmlElement(t)}};function uo(e){return f.W_.isElement(e)&&"heading"===e.type}function ho(){return ho=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ho.apply(this,arguments)}function po(e){let{attributes:t,element:n,children:a}=e;const{level:o}=n,l="h".concat(o),i=f.NB.string(n);return r.createElement(l,ho({},P({attributes:t,element:n}),{id:i}),a)}function mo(){return mo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mo.apply(this,arguments)}const go={h1:1,h2:2,h3:3,h4:3,h5:3,h6:3},fo={label:"Large Heading",icon:b.Z.FormatHeader1,type:"heading",action:e=>(h.$4.toggleHeading(e,1),!0)},vo={label:"Medium Heading",icon:b.Z.FormatHeader2,type:"heading",action:e=>(h.$4.toggleHeading(e,2),!0)},Eo={label:"Small Heading",icon:b.Z.FormatHeader3,type:"heading",action:e=>(h.$4.toggleHeading(e,3),!0)},bo=(e,t)=>({...e,editableProps:{...e.editableProps,renderElement:t=>{var n,a;const o=t.element;return uo(o)?r.createElement(po,mo({},t,{element:o})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},serializeElement:(t,n)=>uo(t)?((e,t)=>{const{level:n}=e;switch(n){case 1:return(0,O.U)({node:e,classType:"large-heading",contentTypeValue:"LARGE_HEADING",element:"h1",serialize:t});case 2:return(0,O.U)({node:e,classType:"medium-heading",contentTypeValue:"MEDIUM_HEADING",element:"h2",serialize:t});default:return(0,O.U)({node:e,classType:"small-heading",contentTypeValue:"SMALL_HEADING",element:"h3",serialize:t})}})(t,n):e.serializeElement(t,n),parseHtmlElement:t=>{if(!(e=>Ee(e,"LARGE_HEADING")||Ee(e,"MEDIUM_HEADING")||Ee(e,"SMALL_HEADING")||["h1","h2","h3","h4","h5","h6"].some((t=>ve(e,t))))(t))return e.parseHtmlElement(t);return{type:"heading",level:go[t.nodeName.toLowerCase()]||3,children:[{text:t.textContent||""}]}}});function yo(e){return f.W_.isElement(e)&&"image"===e.type}var Co=n(14600),No=n.n(Co),To=(n(82472),n(33105),n(3462),n(33824),n(44064));function So(e){if(e.startsWith("data:")){const t=e.indexOf(":")+1,n=e.indexOf(";");return e.substring(t,n)}return e.split("")[0].slice(5)}function ko(e){const t=e.split(",")[1],n=atob(t),r=new window.ArrayBuffer(n.length);let a=new window.Uint8Array(r);for(let e=0;e<n.length;e++)a[e]=n.charCodeAt(e);100!==new To.Z([new window.Uint8Array(100)]).size&&(a=r);return new To.Z([a],{type:So(e)})}function xo(e){let{url:t,callback:n}=e;if(No()(t)){const e=ko(t);setTimeout((()=>{n(null,e)}))}else!function(e){let{url:t,callback:n}=e;const r=window.document.createElement("canvas"),a=window.document.createElement("img");if(!r.getContext)return setTimeout(n,0,new Error("Canvas is not supported."));a.onload=()=>{const e=r.getContext("2d");r.width=a.width,r.height=a.height,e.drawImage(a,0,0);const t=r.toDataURL("image/png");n(null,t)},a.onerror=()=>{n(new Error("Failed to load image."))},a.setAttribute("crossOrigin","anonymous"),a.src=t}({url:t,callback:(e,t)=>{const r=ko(t);n(e,r)}})}const Lo=e=>{let{className:t}=e;const n=Ye()("ghq-fact-editor-menu-break",t);return r.createElement("div",{className:n})};function _o(){return _o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_o.apply(this,arguments)}const Io=r.forwardRef(((e,t)=>{let{style:n,element:a,expandImage:o,popoverMode:l,setPopoverMode:i,...s}=e;const c=(0,u._7)(),d=(0,u.GQ)(),h=Tn((null==a?void 0:a.entityKey)||""),{name:p,url:m,hasError:g}=h,v=(0,Gt.y)(),E=(0,r.useContext)(Pn.ZP),y=a?u.F3.findPath(c,a):null;return r.createElement("div",_o({},qt()(s,["popoverMode","setPopoverMode"]),{ref:t,"data-testid":"PopoverImage",style:{...n,position:"fixed"}}),r.createElement(Ft,{className:"ghq-PopoverImage"},r.createElement("div",{className:"ghq-PopoverImage__content-wrapper"},r.createElement("div",{className:"ghq-PopoverImage__icon-wrapper"},r.createElement(Qt.Z,{icon:b.Z.Photo})),g?r.createElement("p",{className:"ghq-PopoverImage__error-text"},"Image unavailable"):r.createElement("a",{href:m,target:"_blank",rel:"noopener noreferrer"},p),!d&&r.createElement(r.Fragment,null,r.createElement(Lo,{className:"ghq-ToolbarMenuButtons__break"}),r.createElement(We.ZP,{aria:"Edit-Image",icon:b.Z.Pencil,tooltipLabel:"Edit Image",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{null!=a&&Qo.action(c,v,a)}})),r.createElement(r.Fragment,null,!g&&r.createElement(r.Fragment,null,r.createElement(We.ZP,{aria:"Expand-Image",icon:b.Z.Zoom,tooltipLabel:"Expand Image",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:o}),r.createElement(We.ZP,{aria:"Download-Image",icon:b.Z.Download,tooltipLabel:"Download Image",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{window.open(wn(m),"_blank")}})),!d&&r.createElement(We.ZP,{aria:"Delete-Image",icon:b.Z.Delete,tooltipLabel:"Delete Image",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{f.YR.removeNodes(c,{at:y})}}),d&&!g&&r.createElement(We.ZP,{aria:"Copy-Link-to-Image",icon:b.Z.Link,tooltipLabel:"Copy Link to Image",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{yn({url:m,factId:null==E?void 0:E.id})}}),!d&&r.createElement(r.Fragment,null,r.createElement(Lo,{className:"ghq-ToolbarMenuButtons__break"}),r.createElement("div",{className:"ghq-AltText__button"},r.createElement(Bt.ZP,{ariaLabel:"Edit-Image-alt-text",label:"Alt text",onClick:()=>{null!=a&&i("editingAltText")}})))))))}));function wo(e){let{width:t,height:n}=e;return r.createElement("span",{style:{width:t,height:n},className:"ghq-next-fact-editor__loader","data-testid":"boxed-loader"},r.createElement(Jt.ZP,{size:Jt.wx.Small}))}var Mo=n(30129),Po=n(25686);const Do={message:"Download Image"},Ao={message:"Copy Link to Image"};function Oo(e){const t=r.useRef(null),[n,a]=r.useState(!1),[o,l]=r.useState(!1);r.useEffect((()=>{t.current&&l(function(e){return!!e&&(e.clientWidth<e.naturalWidth||e.clientHeight<e.naturalHeight)}(t.current))}),[]);const i=Ye()("ghq-ImageLightbox__image-container ghq-next-card-content__image-container",{"ghq-is-zoomed-in":n,"ghq-can-zoom-in":o});return r.createElement(Mo.Z,{className:"ghq-ImageLightbox",onClick:e.onClose},r.createElement("div",{className:"ghq-ImageLightbox__toolbar"},r.createElement(Nn.Z,{className:"ghq-ImageLightbox__toolbar-back",icon:"arrow-left",size:20,onClick:e.onClose}),r.createElement("a",{"data-testid":"Image Lightbox Name",className:"ghq-ImageLightbox__toolbar-link",href:e.src,target:"_blank",rel:"noopener noreferrer"},e.name),r.createElement("a",{className:"ghq-ImageLightbox__toolbar-download","data-testid":"Image Lightbox Download Link",href:e.src,target:"_blank"},r.createElement(Nn.Z,{"data-testid":"Image Lightbox Download Link Icon",tooltipped:Do,icon:"download",size:16})),r.createElement(Nn.Z,{"data-testid":"Image Lightbox Copy Icon",tooltipped:Ao,className:"ghq-ImageLightbox__toolbar-copy",icon:"link",size:16,onClick:()=>yn({factId:e.id,url:e.src})}),r.createElement("div",{className:"ghq-ImageLightbox__toolbar-break"}),r.createElement("span",{className:"ghq-ImageLightbox__toolbar-close","data-testid":"Image Lightbox Close",onClick:e.onClose},"close image")),r.createElement("div",{className:"ghq-ImageLightbox__image ghq-next-card-content"},r.createElement("div",{className:i},r.createElement("img",{ref:t,className:"ghq-next-card-content__image",alt:e.alt||e.name,src:e.src,onClick:()=>a((e=>!e))})),r.createElement(Po.FN,{className:"ghq-ImageLightbox__toast",filter:"next-fact-editor-".concat(e.id)})))}var Ro=n(24594),Zo=n(99386);function qo(){return qo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qo.apply(this,arguments)}const Fo=r.forwardRef(((e,t)=>{let{style:n,element:a,popoverMode:o,setPopoverMode:l,...i}=e;const[s,c]=(0,r.useState)((null==a?void 0:a.alt)||""),d=(0,u._7)(),h=(0,r.useRef)(null),p=(0,Gt.y)();(0,r.useEffect)((()=>{const e=setTimeout((()=>{null!=h.current&&(null==h||h.current.focus())}));return()=>clearTimeout(e)}),[null==h?void 0:h.current]);const m=()=>{let e=s;if(null!=a){const t=u.F3.findPath(d,a);f.YR.setNodes(d,{alt:e},{at:t}),p.upsertEntity(a.entityKey,{alt:e})}l("hidden"),u.F3.focus(d)},g=()=>{null!=a&&a.alt?l("hidden"):l("default"),u.F3.focus(d)},v=!s;return r.createElement("div",qo({},i,{ref:t,style:{...n,position:"fixed"}}),r.createElement(Ft,{className:"ghq-PopoverImageAltText"},r.createElement("div",{className:"ghq-PopoverImageAltText__field"},r.createElement(Zo.ZP,{level:Zo.Yx.H2,style:Zo.VH.Large},"Edit Alt Text"),r.createElement(Ro.Z,{autofocus:!0,label:"Alt Text",name:"imageAltTextInput",placeholder:"Image description...",helperText:"Provide access to those using screen readers.",value:s,onChange:e=>c(e),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),m()):"Escape"===e.key&&(e.preventDefault(),g())}}),r.createElement("div",{className:"ghq-PopoverImageAltText__buttons"},r.createElement(Bt.ZP,{label:"Close",theme:Bt.bn.Gray,size:Bt.qE.Medium,onClick:g}),r.createElement(Bt.ZP,{label:"Save",disabled:v,theme:Bt.bn.Primary,size:Bt.qE.Medium,onClick:m})))))}));function Bo(){return Bo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bo.apply(this,arguments)}const Ho={top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,topLeft:!1,bottomLeft:!1},Uo={...Ho,right:!0},zo=e=>e.width?.66*e.width:"160px",Vo=e=>{var t;return null!==(t=e.width)&&void 0!==t?t:"256px"},Yo=e=>{let{element:t,entity:n,id:a,closeGlass:o,isGlassOpen:l}=e;const i=(0,u._7)(),[s,c]=(0,r.useState)(!1),[d,h]=r.useState(!1),p=r.useRef(-1),m=(0,u.GQ)(),g=(0,u.vt)(),v=(0,r.useCallback)(((e,n)=>{const r=u.F3.findPath(i,t);f.YR.setNodes(i,{width:e,height:n},{at:r})}),[t]),E=r.useCallback((e=>{e&&(p.current=window.setTimeout((()=>{h(!0)}),3e4))}),[]);r.useEffect((()=>()=>{p.current>0&&window.clearTimeout(p.current)}),[]);const y=Ye()("ghq-next-fact-editor-image__resize-handle",{"ghq-is-selected":g}),C=n.hasError||d;return r.createElement(Vt.Z,{lockAspectRatio:!0,enable:m?Ho:Uo,className:"ghq-next-fact-editor-resizable",size:null!=t.width?{width:t.width||"auto",height:"auto"}:void 0,minWidth:20,onResize:(e,t,n,r)=>{n.style.width="".concat(n.clientWidth+r.width),n.style.height="auto"},onResizeStop:(e,t,n,r)=>{v(n.clientWidth,n.clientHeight)}},!m&&r.createElement(Wt,{className:y,position:"right"}),!s&&!C&&r.createElement(wo,{width:Vo(t),height:zo(t)}),C?r.createElement("div",{"data-testid":"Image Error Block",className:Ye()("ghq-next-fact-editor-image__inner","--error"),style:{width:Vo(t),height:zo(t)}},r.createElement(Qt.Z,{icon:b.Z.ImageError,color:$t.ZP.Fruitpunch,size:20})):r.createElement("img",{className:"ghq-next-fact-editor-image__img","data-testid":"editor-image",src:n.url,alt:n.alt||n.name,ref:E,style:{visibility:s&&!C?"visible":"hidden"},onError:()=>h(!0),onLoad:e=>{null==t.width&&v(e.currentTarget.naturalWidth,e.currentTarget.naturalHeight),window.clearTimeout(p.current),c(!0)}}),l?r.createElement(Sn.Z,null,r.createElement(Oo,{id:a,src:n.url,name:n.name,alt:n.alt,onClose:o})):null)};function jo(e){var t;let{attributes:n,children:a,element:o}=e;const l=Qe(),i=(0,u.GQ)(),s=Tn(o.entityKey||""),[c,d]=r.useState(!1),h=(0,u._7)(),p=(0,r.useContext)(Pn.ZP),[m,g]=(0,r.useState)("image"),v=((0,u.vt)()||c)&&(null==h.selection||f.e6.isCollapsed(h.selection)),E=_n(v,100);(0,r.useEffect)((()=>{g(E?"image":"hidden")}),[E]),(0,r.useEffect)((()=>{"hidden"===m&&d(!1)}),[m,c]);const[b,y]=(0,r.useState)(!1),C=(0,r.useCallback)((()=>{"hidden"===m&&g("image"),d(!0)}),[m]),N=(0,r.useCallback)((()=>{d(!1)}),[m]),T=!(null==s||null==s.url&&!s.hasError)&&E,S=Ye()("ghq-next-fact-editor-image".concat(i?"-readonly":""),{"ghq-next-fact-editor-image--highlighted":l});return r.createElement(r.Fragment,null,T&&!b&&r.createElement(Ln,{renderPopover:e=>{var t;return"editingAltText"===m?r.createElement(Fo,Bo({},e,{target:n.ref.current,element:e.element})):r.createElement(Io,Bo({},e,{target:null===(t=n.ref)||void 0===t?void 0:t.current,element:e.element,expandImage:()=>y(!0)}))},popoverMode:m,setPopoverMode:g,target:n.ref,element:o,onMouseOver:C,onMouseLeave:N}),r.createElement("span",Bo({},P({attributes:n,element:o}),{className:S,onMouseOver:C,onMouseLeave:N}),r.createElement("span",{contentEditable:!1},null==s||null==s.url&&!s.hasError?r.createElement(wo,{width:Vo(o),height:zo(o)}):r.createElement(Yo,{entity:s,element:o,id:null==p||null===(t=p.card)||void 0===t?void 0:t.id,isGlassOpen:b,closeGlass:()=>y(!1)})),a))}function Wo(e){let{images:t,editor:n,contextMethods:r,selection:a}=e;t.forEach((e=>{const t=(0,pn.Z)(),o=e.name;r.upsertEntity(t,{name:o}),f.YR.insertNodes(n,[{type:"image",entityKey:t,children:[{text:""}]}],{at:a});r.upload(e).then((e=>{let{url:n}=e;r.upsertEntity(t,{name:o,url:n})}),(()=>{r.upsertEntity(t,{hasError:!0})}))}))}var Go=n(25108);function Ko(){return Ko=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ko.apply(this,arguments)}const $o={icon:b.Z.Photo,label:"Image",type:"image",action:(e,t)=>(t.openImageDialog((n=>{const r=n.target.files;null!=r&&Wo({images:Array.from(r),editor:e,contextMethods:t})})),!0)},Qo={icon:b.Z.Photo,label:"Image",type:"image",action:(e,t,n)=>(t.openImageDialog((r=>{if(!n)return;const a=(r.target.files||[])[0],o=(0,pn.Z)(),l=a.name,i=u.F3.findPath(e,n);t.upsertEntity(o,{name:l}),f.YR.setNodes(e,{entityKey:o},{at:i}),t.upload(a).then((e=>{let{url:n}=e;t.upsertEntity(o,{url:n})}))})),!0)},Jo=M({"mod+alt+i":(e,t)=>($o.action(e,t),!0)}),Xo=(e,t,n)=>({...e,editableProps:{...e.editableProps,onPaste:r=>{var a,o;var l,i;if(Array.from(r.clipboardData.types).includes("text/html"))return null===(l=(i=e.editableProps).onPaste)||void 0===l?void 0:l.call(i,r);const s=r.clipboardData.files,{selection:c}=t,d=Array.from(s).filter((e=>e.type.includes("image")||Cn(e.name)));return null!=d&&null!=(null==c?void 0:c.anchor)&&null!=(null==c?void 0:c.focus)&&Wo({images:d,editor:t,selection:c,contextMethods:n}),null===(a=(o=e.editableProps).onPaste)||void 0===a?void 0:a.call(o,r)},onKeyDown:r=>{var a,o;if(!Jo(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)},onDrop:r=>{var a,o;r.preventDefault();const l=r.dataTransfer.files,i=u.F3.findEventRange(t,r),s=Array.from(l).filter((e=>e.type.includes("image")||Cn(e.name)));return null!=s&&Wo({images:s,editor:t,selection:i,contextMethods:n}),null===(a=(o=e.editableProps).onDrop)||void 0===a?void 0:a.call(o,r)},renderElement:t=>{var n,a;return yo(t.element)?r.createElement(jo,Ko({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},renderPopover:t=>"image"===t.popoverMode?r.createElement(Io,Ko({},t,{element:t.element})):e.renderPopover(t),toolbarActions:[...e.toolbarActions,$o],parseHtmlElement:t=>{if(Ee(t,"IMAGE")||ve(t,"img")){const e=t,r=(0,pn.Z)(),a=e.src,o=e.alt||"Unnamed";n.upsertEntity(r,{url:a,name:o}),In(a)||xo({url:a,callback:(e,t)=>{if(e)Go.error(e);else{const e=(l=o,(a=t).lastModifiedDate=new Date,a.name=l,a);n.upload(e).then((e=>{let{url:t}=e;n.upsertEntity(r,{url:t,name:o})})).catch((e=>{n.upsertEntity(r,{hasError:!0,name:o}),Go.error(e)}))}var a,l}});const l=e.getAttribute("width")||"",{width:i}=se(l),s=Number.parseInt(i),c=Number.isNaN(s)?i:s,d=e.getAttribute("style")||"",u=ce(d);return{type:"image",entityKey:r,width:c||void 0,children:[{text:""}],serializedUrl:a||"",serializedName:o,serializedStyle:u}}return e.parseHtmlElement(t)},serializeElement:(t,r)=>{if(yo(t)){const e=n.getContextState().entities[t.entityKey||""],{serializedUrl:a,serializedName:o}=t,l=a&&o?{url:a,name:o}:null,i=e||l;return null!=i?((e,t,n)=>{if(null==n)return"";const r={node:e,serialize:t,classType:"image",contentTypeValue:"IMAGE",element:"img",attributes:{}},a=n.alt?n.alt:"Unnamed"===n.name?null:n.name,{width:o,serializedStyle:l}=e,i=l||(o?"width:".concat(o,"px"):""),s=[{alt:a},{width:o},{src:nn(n.url)},{style:i},{"data-ghq-card-content-image-filename":n.name}];for(const e of s){const t=Object.keys(e)[0],n=e[t];n&&(r.attributes[t]=n)}return'<span class="ghq-card-content__image-container">'.concat((0,O.U)(r),"</span>")})(t,r,i):""}return e.serializeElement(t,r)}});var el=n(74001);function tl(){return tl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tl.apply(this,arguments)}const nl=r.forwardRef(((e,t)=>{var n;let{style:a,element:o,popoverMode:l,setPopoverMode:i,...s}=e;const c=(0,u._7)(),d=(0,u.GQ)(),h=r.useContext(Pn.ZP);if(null==(null==o?void 0:o.url))return null;const p=u.F3.findPath(c,o),m=o.url.startsWith("mailto:")?{href:o.url}:{href:o.url,target:"_blank",rel:"noreferrer noopener"},g={trackableLink:'<a href="'.concat(o.url,'">').concat(o.children[0].text,"</a>")},v=null==h||null===(n=h.id)||void 0===n?void 0:n.replace("-readonly","");return r.createElement("div",tl({},s,{ref:t,"data-testid":"PopoverLink",style:{...a,position:"fixed"}}),r.createElement(Ft,{className:"ghq-DefaultLinkPopover"},r.createElement("div",{className:"ghq-DefaultLinkPopover__content-wrapper"},r.createElement("div",{className:"ghq-DefaultLinkPopover__icon-wrapper"},r.createElement(Qt.Z,{icon:b.Z.Globe})),r.createElement("a",tl({},m,{href:o.url}),o.url),d&&r.createElement(We.ZP,{aria:"default-link-popover-copy-link-button",icon:b.Z.Link,tooltipLabel:"Copy Link",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{(0,el.Iv)({id:v,url:o.url})}}),d&&(null==h?void 0:h.hasContentROI)&&r.createElement(We.ZP,{aria:"default-link-popover-copy-trackable-link-button",icon:b.Z.TrackLink,tooltipLabel:"Copy Trackable Link",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{i("hidden"),(0,el.ni)({factId:v,linkData:g})}}),!d&&r.createElement(r.Fragment,null,r.createElement(We.ZP,{aria:"default-link-popover-edit-link-button",icon:b.Z.Pencil,tooltipLabel:"Edit Link",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:e=>{null==e||e.preventDefault(),i("editingLink")}}),r.createElement(We.ZP,{aria:"default-link-popover-unlink-button",icon:b.Z.Unlink,tooltipLabel:"Unlink",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>f.YR.unwrapNodes(c,{at:p})}),r.createElement(We.ZP,{aria:"default-link-popover-delete-link-button",icon:b.Z.Delete,tooltipLabel:"Delete Link",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>f.YR.removeNodes(c,{at:p})})))))}));function rl(){return rl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rl.apply(this,arguments)}const al=r.forwardRef(((e,t)=>{let{style:n,element:a,popoverMode:o,setPopoverMode:l,...i}=e;const[s,c]=(0,r.useState)((null==a?void 0:a.url)||""),d=(0,u._7)(),h=(0,r.useRef)(null);(0,r.useEffect)((()=>{const e=setTimeout((()=>{null!=h.current&&(null==h||h.current.focus())}));return()=>clearTimeout(e)}),[null==h?void 0:h.current]);const p=()=>{let e=s;const t=s.startsWith("mailto:");if((0,m.Jh)(s)&&!t?e="mailto:".concat(s):!(0,m.CB)(e)||e.startsWith("http")||t||(e="http://".concat(s)),null!=a&&a.url||null==d.selection){if(null!=a){const t=u.F3.findPath(d,a);f.YR.setNodes(d,{url:e},{at:t})}}else f.e6.isCollapsed(d.selection)?f.YR.insertNodes(d,{type:"link",url:e,children:[{text:e}]}):f.YR.wrapNodes(d,{type:"link",url:e,children:[]},{split:!0});f.YR.collapse(d,{edge:"end"}),f.YR.move(d,{distance:1,unit:"offset"}),f.YR.move(d,{distance:1,unit:"offset",reverse:!0}),l("hidden"),u.F3.focus(d)},g=()=>{null!=a&&a.url?(f.YR.move(d,{distance:1,unit:"offset"}),f.YR.move(d,{distance:1,unit:"offset",reverse:!0}),l("hidden")):l("default"),u.F3.focus(d)},v=!(0,m.Jh)(s)&&!(0,m.CB)(s)||!s;return r.createElement("div",rl({},i,{ref:t,"data-testid":"PopoverLinkEdit",style:{...n,position:"fixed"}}),r.createElement(Ft,{className:"ghq-EditLinkPopover"},r.createElement("div",{className:"ghq-EditLinkPopover__field"},r.createElement("label",{className:"ghq-PopoverContent__field-label",htmlFor:"linkUrl"},"Link URL"),r.createElement("input",{ref:h,"data-testid":"Link URL",id:"linkUrl",className:"ghq-input ghq-next-fact-editor-popover__field-input",value:s,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),p()):"Escape"===e.key&&(e.preventDefault(),g())}}),r.createElement("div",{className:"ghq-EditLinkPopover__buttons"},r.createElement(Bt.ZP,{label:"Save",disabled:v,size:Bt.qE.Small,theme:Bt.bn.Primary,onClick:p}),r.createElement(Bt.ZP,{label:"Cancel",size:Bt.qE.Small,theme:Bt.bn.Gray,style:Bt.ZJ.Outline,onClick:g})))))}));function ol(){return ol=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ol.apply(this,arguments)}const ll=e=>{let{attributes:t,element:n,children:a,actions:o}=e;const l=(0,u.GQ)(),[i,s]=(0,r.useState)(!1),[c,d]=(0,r.useState)("link"),h=(0,u.ui)(),p=((0,u.vt)()||i)&&(null==h.selection||f.e6.isCollapsed(h.selection)),m=_n(p,100),g=Ye()("ghq-Link",{"ghq-is-readonly":l}),v=(n.url||"").startsWith("mailto:")?{href:n.url}:{href:n.url,target:"_blank",rel:"noreferrer noopener"};(0,r.useEffect)((()=>{"hidden"===c&&s(!1)}),[c,i]),(0,r.useEffect)((()=>{d(m?"link":"hidden")}),[m]);const E=(0,r.useCallback)((()=>{"hidden"===c&&d("link"),s(!0)}),[c]),b=(0,r.useCallback)((()=>{"editingLink"!==c&&s(!1)}),[c]),y="hidden"!==c&&"editingLink"===c||m;return r.createElement("a",ol({},v,P({attributes:t,element:n}),{className:g,onClick:e=>{l||"A"===e.currentTarget.tagName||(e.preventDefault(),"hidden"===c&&d("link"),s(!0))},onMouseOver:E,onMouseLeave:b}),y&&r.createElement(Ln,{renderPopover:e=>"editingLink"===c?r.createElement(al,ol({target:t.ref.current},e,{element:e.element})):r.createElement(nl,ol({target:t.ref.current},e,{element:e.element})),popoverMode:c,setPopoverMode:d,target:t.ref,element:n,onMouseOver:E,onMouseLeave:b}),a)};function il(e){let{attributes:t,children:n,actions:a,element:o}=e;return r.createElement(ll,{attributes:t,element:o,actions:a},n)}function sl(){return sl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sl.apply(this,arguments)}const cl={icon:b.Z.Link,label:"Link",type:"link",action:(e,t)=>(t.setContextState((e=>bt(e,"editingLink"))),!0)},dl=e=>f.W_.isElement(e)&&"link"===e.type,ul=M({"mod+k":(e,t)=>(cl.action(e,t),!0)}),hl=(e,t,n)=>({...e,editableProps:{...e.editableProps,onKeyDown:r=>{var a,o;if(!ul(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)},renderElement:t=>{var n,a;return dl(t.element)?r.createElement(il,sl({},t,{element:t.element,actions:e.popoverActions})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},toolbarActions:[...e.toolbarActions,cl],popoverActions:[...e.popoverActions,cl],renderPopover:t=>"link"===t.popoverMode?r.createElement(nl,sl({},t,{element:t.element})):"editingLink"===t.popoverMode?r.createElement(al,sl({},t,{element:t.element})):e.renderPopover(t),serializeElement:(t,n)=>dl(t)?((e,t)=>{const n=e.url||"",r={href:nn(n)},a={...r,target:"_blank",rel:"noopener noreferrer"},o=(e=>e.startsWith("mailto:"))(n)?r:a;return(0,O.U)({node:e,classType:"link",serialize:t,contentTypeValue:"LINK",element:"a",attributes:o})})(t,n):e.serializeElement(t,n),parseHtmlElement:t=>{const n=t,r=ve(n,"a"),a=Ee(n,"GURU_CARD"),o=(0,En.y)(n.href),l=Ee(n,"LINK"),i=r?n.getAttribute("href"):"";if(a||o||l){if(Vn(n))return e.parseHtmlElement(t)}else if(null!==i&&/api.getguru.com\/files\/view\//gm.test(i))return e.parseHtmlElement(t);const s=Me(n);if(r){const r=/^#[^\s]+$/;if(i&&r.test(i)&&!ge(t)&&!fe(t))return e.parseHtmlElement(t);let d=i||"";(0,da.TG)(d)&&(d=(0,da.x5)(d));const u={type:"link",url:d,children:[{text:n.textContent,...s.length>1&&{orderedMarks:s}}]};if(l)return u;if(o||a){var c;const e=Qa((null==n?void 0:n.getAttribute("href"))||"");return{type:"guru-card",id:(null===(c=n.dataset)||void 0===c?void 0:c.ghqGuruCardId)||e,children:[{text:n.textContent}],url:i}}return u}return e.parseHtmlElement(t)}});function pl(){return pl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pl.apply(this,arguments)}function ml(e){let{attributes:t,element:n,children:a}=e;const o=P({attributes:t,element:n}),l=(0,u._7)(),i=u.F3.findPath(l,n),s=Array.from(f.ML.nodes(l,{at:i,match:(e,t)=>f.y$.isAncestor(t,i)&&(0,v.nq)(e)}))||[];if(s.length>0){const e=Ye()(o.className,"nested-list--".concat(s.length));return r.createElement("div",{className:"ghq-next-card-content__list-item--nested","data-testid":"editor-element-list-nested"},"ol"===n.listType?r.createElement("ol",pl({},o,{className:e}),a):r.createElement("ul",pl({},o,{className:e}),a))}return"ol"===n.listType?r.createElement("ol",pl({},o,{start:parseInt(n.start||"1")}),a):r.createElement("ul",o,a)}function gl(){return gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gl.apply(this,arguments)}function fl(e){let{attributes:t,element:n,children:a}=e;const o=P({attributes:t,element:n}),l=Ye()(o.className,{nested:n.children.every((e=>(0,v.nq)(e)))});return r.createElement("li",gl({},o,{className:l}),a)}function vl(){return vl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vl.apply(this,arguments)}const El=(e,t,n)=>{const{normalizeNode:a}=t;return t.normalizeNode=e=>{const[n,r]=e;if((0,v.OD)(n)&&n.children.some((e=>!f.ML.isInline(t,e)&&!f.xv.isText(e))))Array.from(n.children).reverse().forEach(((e,a)=>{const o=[...r,n.children.length-a-1];f.ML.isInline(t,e)||f.xv.isText(e)||(0,v.nq)(e)?(0,v.OD)(e)?f.YR.unwrapNodes(t,{at:o}):(0,v.nq)(e)&&f.YR.liftNodes(t,{at:o}):f.W_.isElement(e)&&e.children.some((e=>f.xv.isText(e)))&&f.YR.unwrapNodes(t,{at:o})}));else{if(!(0,v.OD)(n)||!Ir(t,r,"list")){if((0,v.nq)(n)){if(f.ML.isEmpty(t,n))return void f.YR.removeNodes(t,{at:r});if(f.ML.hasBlocks(t,n))return void n.children.forEach(((e,n)=>{if(!(e=>(0,v.OD)(e)||(0,v.nq)(e))(e)){const a=[...r,n];f.ML.hasPath(t,a)&&((0,v.OC)(e)||function(e){return f.W_.isElement(e)&&"markdown"===e.type}(e)||(0,v.bA)(e))?f.YR.liftNodes(t,{mode:"highest",at:a}):f.ML.hasPath(t,a)&&(yo(e)||f.xv.isText(e))?(f.YR.wrapNodes(t,{type:"list-item",children:[]},{at:a}),f.YR.liftNodes(t,{mode:"highest",at:a})):(0,v.CQ)(e)&&!f.xv.isText(e)&&f.ML.hasPath(t,a)&&(""!==f.NB.string(e).trim()||f.ML.hasInlines(t,e)?f.YR.setNodes(t,{type:"list-item",children:[{text:f.NB.string(e)}]},{at:a}):f.YR.removeNodes(t,{at:a}))}}))}return a(e)}f.YR.wrapNodes(t,{type:"list",listType:"ul",children:[]},{at:r})}},{...e,editableProps:{...e.editableProps,onKeyDown:r=>{var a,o;I(r,t,n)?r.preventDefault():null===(a=(o=e.editableProps).onKeyDown)||void 0===a||a.call(o,r)},renderElement:t=>{var n,a;return(0,v.OD)(t.element)?r.createElement(fl,vl({},t,{element:t.element})):(0,v.nq)(t.element)?r.createElement(ml,vl({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},toolbarActions:[...e.toolbarActions,{type:"break"},S,k],serializeElement:(t,n,r)=>(0,v.OD)(t)?((e,t,n)=>(0,O.U)({node:e,classType:"ul"===n?"bulleted-list-item":"numbered-list-item",contentTypeValue:"ul"===n?"BULLETED_LIST_ITEM":"NUMBERED_LIST_ITEM",element:"li",serialize:t}))(t,n,r||"ul"):(0,v.nq)(t)?((e,t)=>{const n={};return"ol"===e.listType&&(n.start=e.start||"1"),(0,O.U)({node:e,classType:"ul"===e.listType?"bulleted-list":"numbered-list",contentTypeValue:"ul"===e.listType?"BULLETED_LIST":"NUMBERED_LIST",element:e.listType,serialize:t,attributes:n})})(t,n):e.serializeElement(t,n),parseHtmlElement:t=>{if(ge(t))return e.parseHtmlElement(t);if(["ul","ol"].includes(t.nodeName.toLowerCase())){const e=t,n="OL"===t.nodeName?e.getAttribute("start"):null;return{type:"list",listType:t.nodeName.toLowerCase(),children:[],start:n||void 0}}return"li"===t.nodeName.toLowerCase()?{type:"list-item",children:Array.from(t.childNodes).map((t=>e.parseHtmlElement(t)||{text:""}))}:e.parseHtmlElement(t)}}},bl={icon:b.Z.InsertCustomHtml,label:"Markdown",type:"markdown",action:e=>((0,yt.o8)(e),!0)},yl=(e,t,n)=>{const[r]=yt.AV(e)||[],a=yt.OY(e,r);if(!a)return!1;const{curr:o}=a;return!(!o||!yt.j9(o.node,t))&&yt.$u(n,e,t)},Cl=M({"mod+alt+m":(e,t)=>(bl.action(e,t),!0),up:(e,t)=>yt.WL("up",e,t),"ctrl+p":(e,t)=>!!yt.V5&&yt.WL("up",e,t),down:(e,t)=>yt.WL("down",e,t),"ctrl+n":(e,t)=>!!yt.V5&&yt.WL("down",e,t),backspace(e,t){const n=yt.OY(e);if(!n)return!1;const{prev:r,curr:a}=n,o=r&&yt.j9(r.node,t),l=a&&f.ML.isEmpty(e,a.node);return!(!o||!l)&&(f.YR.removeNodes(e,{at:a.path}),yt.QH(e,r.path),!0)}}),Nl=M({"mod+alt+m":(e,t)=>(bl.action(e,t),!0),backspace(e,t){const[n]=yt.AV(e)||[],r=yt.OY(e,n),{selection:a}=e;if(!r||!a)return!1;const{curr:o,prev:l}=r,i=f.y$.parent(a.anchor.path),s=f.e6.end(a);if(o&&yt.j9(o.node,t))return f.YR.removeNodes(e,{at:o.path}),!0;if(l&&o&&i&&f.ML.isEmpty(e,l.node)){const t=(0,m.QI)(e,o,i);if(t.isFirst&&!t.isLast&&0===s.offset)return f.YR.moveNodes(e,{at:i,to:l.path}),!0;if(t.isLast&&0===s.offset)return f.YR.liftNodes(e),f.YR.moveNodes(e,{at:i,to:l.path}),!0}return!1},"mod+enter"(e){const[t]=yt.AV(e)||[],n=yt.OY(e,t);return yt.Zt(e,n)},"mod+a"(e,t){const{selection:n}=e;if(!n)return!1;const[r]=f.ML.above(e)||[];if(!(0,v.dn)(r))return!1;const{anchor:a}=n,o=f.y$.parent(a.path),l=f.y$.parent(o);if(!f.ML.hasPath(e,l))return!1;const i=f.NB.get(e,l),[s]=f.NB.levels(i,l),c=s[0].children,{path:d}=f.ML.start(e,l),u=[d[0],c.length-1,d[2]],{path:h}=f.ML.end(e,u),p={offset:0,path:d},m={offset:f.ML.string(e,h).length,path:h};return f.YR.setSelection(e,{anchor:p,focus:m}),!0},ArrowRight:(e,t)=>yl(e,t,"down"),ArrowLeft:(e,t)=>yl(e,t,"left"),tab(e,t){const[n]=yt.AV(e)||[],r=yt.OY(e,n);if(!r)return!1;const{curr:a}=r;return a&&yt.j9(a.node,t)?yt.$u("down",e,t):yt.WY(e)},"shift+tab":e=>yt.Sb(e),enter(e,t){const[n]=yt.AV(e)||[],r=yt.OY(e,n);if(!r)return!1;const{curr:a}=r;return!!a&&(!!yt.j9(a.node,t)&&(yt.Zt(e,r),!0))},up:(e,t)=>yt.$u("up",e,t),"ctrl+p":(e,t)=>!!yt.V5&&yt.$u("up",e,t),down:(e,t)=>yt.$u("down",e,t),"ctrl+n":(e,t)=>!!yt.V5&&yt.$u("down",e,t)});function Tl(){return Tl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tl.apply(this,arguments)}function Sl(e){let{attributes:t,element:n,children:a}=e;const o=P({attributes:t,element:n}),l=(0,u._7)(),i=(0,u.GQ)(),s=Qe(),[c,d]=r.useState(!1),h=()=>d((e=>!e));!function(e,t,n){const a=(0,Gt.y)(),o=Qe();r.useEffect((()=>{const r=t.entityKey||(0,pn.Z)(),l=u.F3.findPath(e,t);if(f.ML.hasPath(e,l))return a.upsertEntity(r,{isPreview:n,isHighlighted:o}),f.YR.setNodes(e,{entityKey:r},{at:l}),()=>{a.upsertEntity(r,{isPreview:!1,isHighlighted:!1})}}),[n,o])}(l,n,c),function(e){const t=(0,Gt.y)(),n=Qe();r.useEffect((()=>(Object.values(t.contextState.entities).some((e=>e.isPreview&&e.isHighlighted))?(0,yt.az)("hide"):(0,yt.az)("show"),()=>{(0,yt.az)("show")})),[n,e,t])}(c);const p=e=>{const t=e.target;if(!(t instanceof HTMLAnchorElement&&Boolean(t.hash)))return;const n=t.getRootNode();if(!(n instanceof DocumentFragment))return;const r=n.querySelector("a[name='".concat(t.hash.substring(1),"'], a[id='").concat(t.hash.substring(1),"']"));r&&(r.scrollIntoView(),e.stopPropagation(),e.preventDefault())};if(i)return r.createElement("div",{className:"".concat(o.className,"__read-only"),"data-testid":"Markdown Preview",contentEditable:!1,dangerouslySetInnerHTML:{__html:(0,yt.Nw)(n)},onClick:p});const m=Ye()(o.className,{"ghq-is-highlighted":s,"ghq-is-previewing":c,"ghq-is-readonly":i});return r.createElement("div",Tl({},o,{className:m}),r.createElement($e,{className:Ye()("ghq-RenderMarkdown__block-menu",{"ghq-is-visible":c&&s})},c?r.createElement(We.ZP,{aria:"edit-markdown-block-button",icon:b.Z.Pencil,tooltipLabel:"Edit",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:h}):r.createElement(We.ZP,{aria:"preview-markdown-block-button",icon:b.Z.View,tooltipLabel:"Preview",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:()=>{h(),f.YR.select(l,u.F3.findPath(l,n))}}),r.createElement(Ge,{element:n})),c?r.createElement("div",{contentEditable:!1,onClick:()=>{f.YR.select(l,u.F3.findPath(l,n))}},r.createElement("div",{className:"".concat(o.className,"__preview"),contentEditable:!1,dangerouslySetInnerHTML:{__html:(0,yt.Nw)(n)}})):r.createElement("pre",{className:"ghq-RenderMarkdown__pre"},a))}function kl(){return kl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},kl.apply(this,arguments)}function xl(e){let{attributes:t,element:n,children:a}=e;const o=P({attributes:t,element:n});return r.createElement("code",kl({},o,{spellCheck:!1}),a)}function Ll(){return Ll=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ll.apply(this,arguments)}const _l=(e,t,n)=>{const{insertFragment:a}=t;return t.insertFragment=e=>{if((0,yt.tC)(t)&&1===e.length&&(0,v.bA)(e[0])){const n=e[0].children.map((e=>e.children[0].text)).join("\n");return t.insertText(n)}if((0,v.Ze)(e[0])){const n=e[0].children[0].children[0].children[0];if((0,v.ev)(n)){const e=n.children.map((e=>e.children[0].text)).join("\n");return t.insertText(e)}}return a(e)},{...e,editableProps:{...e.editableProps,onPaste(n){var r,a;const{selection:o}=t;if((0,yt.tC)(t)){if(!o)return void n.preventDefault();const e=(0,yt.qf)(n);return e.length?(t.insertFragment(e),void n.preventDefault()):void 0}return null===(r=(a=e.editableProps).onPaste)||void 0===r?void 0:r.call(a,n)},onKeyDown:r=>{var a,o;(function(e,t,n){if(yt.tC(t)&&Nl(e,t,n))return!0;if(!yt.tC(t)&&Cl(e,t,n))return!0;if(yt.tC(t)){const[e]=yt.AV(t)||[],r=yt.OY(t,e);if(!r)return!1;const{curr:a}=r;return!(!a||!yt.j9(null==a?void 0:a.node,n))}return!1})(r,t,n)?r.preventDefault():null===(a=(o=e.editableProps).onKeyDown)||void 0===a||a.call(o,r)},renderElement:t=>{var n,a;return"markdown"===t.element.type?r.createElement(Sl,Ll({},t,{element:t.element})):"markdown-line"===t.element.type?r.createElement(xl,Ll({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},toolbarActions:[...e.toolbarActions,bl],serializeElement:(t,n)=>(0,v.ev)(t)?((e,t)=>{const n=e.children,r=n.reduce(((e,t,r)=>r+1===n.length?e+f.NB.string(t):"".concat(e).concat(f.NB.string(t),"\n")),""),a={"data-ghq-card-content-markdown-content":ae(r)};return(0,O.U)({node:e,classType:"markdown",contentTypeValue:"MARKDOWN",element:"div",attributes:a,serialize:t})})(t,n):e.serializeElement(t,n),parseHtmlElement:t=>{var n;const r=t;if(!Ee(t,"MARKDOWN"))return e.parseHtmlElement(t);const a=e=>{const t=e.querySelectorAll('[data-ghq-card-content-type="CODE_BLOCK_LINE"]'),n=e.querySelectorAll("code"),r=t.length?t:n.length?n:[];return Array.from(r).map((e=>({type:"markdown-line",children:[{text:e.textContent||""}]})))},o=null===(n=r.dataset)||void 0===n?void 0:n.ghqCardContentMarkdownContent;let l;if(o)try{const e=unescape(o);l=e.replace(/>\/iframe>/g,">").split("\n").map((e=>({type:"markdown-line",children:[{text:e}]})))}catch(e){l=a(r)}else l=a(r);return{type:"markdown",children:l}}}};const Il=(e,t)=>({...e,editableProps:{...e.editableProps,onKeyDown:n=>{var r,a;return[{trigger:"*",mark:we.Se.type},{trigger:"`",mark:we.TU.type},{trigger:"_",mark:we.pU.type},{trigger:"~",mark:we.Jq.type}].forEach((e=>{let{trigger:r,mark:a}=e;const{selection:o}=t;if(null===o)return!1;if(f.e6.isExpanded(o))return!1;if((0,m.aZ)({editor:t}))return!1;const l=f.ML.path(t,o),i=f.ML.start(t,l),s=o.focus,c={focus:i,anchor:s},d=f.ML.string(t,c),u=s.offset-1,p=d.charAt(u);if([" ","Enter"].includes(n.key)&&p===r){const e=function(e,t,n,r){let a=t-1,o=null;for(;a>=0&&r.charAt(a);){const t=r.charAt(a),l=(0,m.Tt)({editor:e,type:"code-line"}),i=(0,m.Tt)({editor:e,type:"markdown-line"}),s=(0,m.wf)({editor:e}),c=l.length||i.length||(null==s?void 0:s.code);t===n&&!c&&null===o&&(o=a),a-=1}return o}(t,u,r,d);if(null!==e)return"Enter"!==n.key&&(n.preventDefault(),f.ML.insertText(t," "),f.YR.move(t,{distance:1,unit:"character",reverse:!0})),f.ML.deleteBackward(t,{unit:"character"}),f.YR.move(t,{distance:u-e,reverse:!0}),f.ML.deleteForward(t,{unit:"character"}),f.YR.setSelection(t,{anchor:{path:i.path,offset:e},focus:{path:i.path,offset:u-1}}),h.$4.toggleMark(t,a,!0),f.YR.setSelection(t,{anchor:{path:l,offset:u-1},focus:{path:l,offset:u-1}}),f.YR.move(t,{distance:1,unit:"character"}),!0}})),null===(r=(a=e.editableProps).onKeyDown)||void 0===r?void 0:r.call(a,n)}}});function wl(e){let{attributes:t,element:n,children:a}=e;const o={...t,"data-testid":"next-editor-paragraph"};return r.createElement("p",P({attributes:o,element:n}),a)}function Ml(){return Ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ml.apply(this,arguments)}const Pl={label:"Paragraph",icon:b.Z.FormatParagraph,type:"p",action:e=>(h.$4.setParagraph(e),!0)},Dl=(e,t)=>({...e,editableProps:{...e.editableProps,renderElement:t=>{var n,a;return"p"===t.element.type?r.createElement(wl,Ml({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},serializeElement:(n,r)=>A(n)?((e,t,n)=>(0,O.U)({node:e,classType:"paragraph".concat((0===e.children.length?f.ML.isEmpty(n,e):0===Object.keys(e.children[0]).filter((e=>"text"!==e)).length&&0===e.children.filter((e=>f.xv.isText(e)&&""!==(null==e?void 0:e.text))).length)?" ghq-is-empty":""),contentTypeValue:"paragraph",element:"p",serialize:t}))(n,r,t):e.serializeElement(n,r),parseHtmlElement:t=>Ee(t,"paragraph")||ve(t,"p")?{type:"p",children:[{text:""}]}:e.parseHtmlElement(t)});var Al,Ol=n(23279),Rl=n.n(Ol),Zl=n(81510),ql=n(3486);const Fl="UP",Bl="DOWN",Hl="KEYDOWN",Ul={className:jt().string,defaultHighlightedIndex:jt().any,selectable:jt().bool,focusable:jt().bool,embedded:jt().bool,stickyHover:jt().bool,noArrowKeys:jt().bool,selected:jt().bool,highlighted:jt().bool,highlightedBy:jt().string,style:jt().object,onLockParentMenu:jt().func,onUnlockParentMenu:jt().func,onExitMenuTop:jt().func,onExitMenuBottom:jt().func};var zl=(0,Ma.Z)(((Al=class extends r.Component{constructor(e){super(e),this.componentDidUpdate=()=>{const{highlighted:e,selectable:t,embedded:n,selectableIndex:r,defaultHighlightedIndex:a,parentIsLocked:o,onLockParentMenu:l}=this.props,{highlightedIndex:i,locked:s}=this.state,c=t?e:!s;if(n&&t&&!e&&-1!==i&&this.setState({highlightedIndex:-1}),c&&!this.highlightedTargetExists(i)){if(i===a)return;n?(a===Bl&&this.setState({highlightedIndex:0}),a===Fl&&this.setState({defaultHighlightedIndex:this.getLastSelectableIndex()})):this.setState({highlightedIndex:a})}t&&e&&!o&&l(r)},this.highlightedTargetExists=e=>{const{children:t}=this.props;let n=0,a=!1;return r.Children.forEach(t,(t=>{Ia()(t,"props.selectable")&&(e===n&&(a=!0),n+=1)})),a},this.getLastSelectableIndex=()=>{const{children:e}=this.props;let t=-1;return r.Children.forEach(e,(e=>{Ia()(e,"props.selectable")&&(t+=1)})),t},this.handleMouseDown=e=>{this.props.focusable&&e.preventDefault()},this.handleChildHighlighted=e=>{const{onLockParentMenu:t,selectableIndex:n,parentIsLocked:r}=this.props;t&&!r&&t(n),this.setState({highlightedIndex:e,highlightedBy:"HOVER",locked:!1})},this.handleClickOutside=()=>{this.props.onClickOutside()},this.handleLockMenu=e=>{this.setState({locked:!0,highlightedIndex:e})},this.handleUnlockMenu=()=>{this.setState({locked:!1})},this.handleSelectNext=(e,t)=>{const{selectable:n,highlighted:r,onUnlockParentMenu:a,onExitMenuBottom:o}=this.props,{highlightedIndex:l,locked:i}=this.state;if(!t&&(n&&!r||i))return;e&&e.preventDefault();const s=l+1;this.highlightedTargetExists(s)?this.setState({highlightedIndex:s,direction:Bl,highlightedBy:Hl}):a&&o&&(o(),a(),this.setState({highlightedIndex:-1,highlightedBy:Hl}))},this.handleArrowDown=e=>{const{noArrowKeys:t}=this.props;t||this.handleSelectNext(e)},this.handleTab=e=>{this.handleSelectNext(e)},this.handleSelectLast=(e,t)=>{const{selectable:n,highlighted:r,onUnlockParentMenu:a,onExitMenuTop:o}=this.props,{highlightedIndex:l,locked:i}=this.state;if(!t&&(n&&!r||i))return;e&&e.preventDefault();const s=l-1;this.highlightedTargetExists(s)?this.setState({highlightedIndex:s,highlightedBy:Hl,direction:Fl}):a&&o&&(o(),a(),this.setState({highlightedIndex:-1,highlightedBy:Hl}))},this.handleArrowUp=e=>{const{noArrowKeys:t}=this.props;t||this.handleSelectLast(e)},this.handleShiftTab=e=>{this.handleSelectLast(e)},this.getManipulatedChildren=()=>{const{children:e,stickyHover:t}=this.props,{highlightedIndex:n,highlightedBy:a,direction:o,locked:l}=this.state;let i=0;return r.Children.map(e,(e=>{if(!Ia()(e,"props.selectable"))return e;if(i!==n){const n=(0,r.cloneElement)(e,{selectableIndex:i,stickyHover:t,parentIsLocked:l,onLockParentMenu:this.handleLockMenu,onUnlockParentMenu:this.handleUnlockMenu,onHover:this.handleChildHighlighted});return i+=1,n}const s=(0,r.cloneElement)(e,{selectableIndex:i,highlightedBy:a,stickyHover:t,highlighted:!0,defaultHighlightedIndex:o,parentIsLocked:l,onLockParentMenu:this.handleLockMenu,onUnlockParentMenu:this.handleUnlockMenu,onExitMenuTop:this.handleSelectLast.bind(null,null,!0),onExitMenuBottom:this.handleSelectNext.bind(null,null,!0),onHover:this.handleChildHighlighted});return i+=1,s}))};const{defaultHighlightedIndex:t}=this.props;let n=t;n===Bl&&(n=0),n===Fl&&(n=this.getLastSelectableIndex()),this.state={highlightedIndex:n,highlightedBy:"",locked:!1,direction:null}}render(){const{className:e,embedded:t,style:n}=this.props,a=Ye()("ghq-next-fact-editor-menu",e,{"ghq-is-embedded":t,"ghq-is-mobile":(0,Da.tq)()});return r.createElement("div",{style:n,className:a,onMouseDown:this.handleMouseDown},this.getManipulatedChildren())}}).propTypes=Ul,Al.defaultProps={defaultHighlightedIndex:-1,stickyHover:!0,style:{}},Al),{phase:!0});const Vl=(0,Ma.Z)((0,wa.Z)(class extends r.Component{constructor(){super(...arguments),this.componentDidMount=()=>{this.scrollOnKeydownHighlight()},this.componentDidUpdate=()=>{this.scrollOnKeydownHighlight()},this.scrollOnKeydownHighlight=()=>{const{highlightedBy:e,highlighted:t}=this.props;e===Hl&&t&&(0,Pa.n5)(this.item)},this.handleSelect=e=>{const{value:t,onSelect:n,selectable:r}=this.props;r&&n&&n(t,e)},this.handleMouseDown=e=>{e.preventDefault()},this.handleEnter=e=>{const{highlighted:t,value:n,selectable:r,onSelect:a}=this.props;t&&r&&(e.stopImmediatePropagation(),e.preventDefault(),a(n))},this.handleHover=()=>{const{selectableIndex:e,stickyHover:t,selectable:n,showTooltip:r,onHover:a}=this.props;r(this.item),t&&n&&a(e)}}render(){const{ariaLabel:e,className:t,children:n,selected:a,selectable:o,highlighted:l,disabled:i,hideTooltip:s,dataTestId:c}=this.props,d=Ye()("ghq-next-fact-editor-menu-item Button-sage Button-sage--icon",t,{"ghq-is-selected":a,"ghq-is-selectable":o,"ghq-is-highlighted":l,"ghq-is-disabled":i,"ghq-is-mobile":(0,Da.tq)()});return r.createElement("button",{disabled:i,"data-testid":c,ref:e=>{this.item=e},"aria-label":e,type:"button",className:d,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleHover,onFocus:this.handleHover,onMouseLeave:s,onBlur:s,onClick:this.handleSelect},n)}}),{phase:!0});function Yl(e){let{className:t}=e;const n=Ye()("ghq-next-fact-editor-menu-break",t);return r.createElement("div",{className:n})}var jl=n(60644),Wl=n(92381),Gl=n.n(Wl);var Kl={BLOCK:"block",COMMENT:"comment",DIRECTIVE:"directive",MARK:"mark",DOCUMENT:"document",INLINE:"inline",TEXT:"text",STYLE:"STYLE",FORMAT:"FORMAT",INSERT:"INSERT",...{BLOCK_QUOTE:"BLOCK_QUOTE",BULLETED_LIST:"BULLETED_LIST",BULLETED_LIST_ITEM:"BULLETED_LIST_ITEM",CODE_BLOCK:"CODE_BLOCK",CODE_BLOCK_LINE:"CODE_BLOCK_LINE",GLDO_BLOCK:"GLDO_BLOCK",DIVIDER:"DIVIDER",IFRAME:"IFRAME",LARGE_HEADING:"LARGE_HEADING",LIST_ITEM:"LIST_ITEM",MARKDOWN:"MARKDOWN",MARKDOWN_EDIT:"MARKDOWN_EDIT",MARKDOWN_EDIT_LINE:"MARKDOWN_EDIT_LINE",MEDIUM_HEADING:"MEDIUM_HEADING",NUMBERED_LIST:"NUMBERED_LIST",NUMBERED_LIST_ITEM:"NUMBERED_LIST_ITEM",PARAGRAPH:"paragraph",SMALL_HEADING:"SMALL_HEADING",TABLE:"TABLE",TABLE_ROW:"TABLE_ROW",TABLE_CELL:"TABLE_CELL",TITLE:"TITLE",VIDEO:"VIDEO"},...{CODE_SNIPPET:"CODE_SNIPPET",GURU_CARD:"GURU_CARD",FILE:"FILE",INLINE_TEXT:"INLINE_TEXT",IMAGE:"IMAGE",LINK:"LINK"},...{BOLD:"BOLD",HIGHLIGHT:"HIGHLIGHT",ITALIC:"ITALIC",STRIKETHROUGH:"STRIKETHROUGH",TEXT_COLOR:"TEXT_COLOR",UNDERLINE:"UNDERLINE"},REMOVE_FORMATTING:"REMOVE_FORMATTING",KEYBOARD_GUIDE:"KEYBOARD_GUIDE",UNDO:"UNDO",REDO:"REDO",INDENT:"INDENT",UNDENT:"UNDENT",ESCAPE_CODE_BLOCK:"ESCAPE_CODE_BLOCK",CONTEXT:"CONTEXT",TOOLBAR_FORMAT:"TOOLBAR_FORMAT",TOOLBAR_INSERT:"TOOLBAR_INSERT",TURN_INTO:"TURN_INTO",INSERT_INLINE:"INSERT_INLINE",INSERT_BELOW:"INSERT_BELOW",REPLACE:"REPLACE",TOOLBAR:"TOOLBAR",MARKDOWN_SHORTCUT:"MARKDOWN_SHORTCUT",KEYBOARD_SHORTCUT:"KEYBOARD_SHORTCUT",SIDEBAR:"SIDEBAR",SLASH_COMMAND:"SLASH_COMMAND",STYLING_POPOVER:"STYLING_POPOVER",WIDGET_POPOVER:"WIDGET_POPOVER",COLORS:["#F93679","#F7412D","#FF8A60","#FFC200","#66A030","#9013FE","#00BCD6","#2F3BA2","#BAB0BF"]};let $l,Ql,Jl;!function(e){e.Link="link",e.GuruCard="guru-card",e.File="file"}($l||($l={})),function(e){e.Iframe="iframe",e.Video="video"}(Ql||(Ql={})),function(e){e.Bold="bold",e.Color="color",e.Italic="italic",e.Underline="underline",e.Strikethrough="strikethrough",e.Highlight="highlight",e.Code="code",e.RemoveStyling="REMOVE_FORMATTING"}(Jl||(Jl={}));const Xl={[Jl.Bold]:{icon:b.Z.FormatBold,label:"Bold",type:"bold",action:e=>(h.$4.toggleMark(e,"bold",!0),!0)},[Jl.Italic]:{icon:b.Z.FormatItalic,label:"Italic",type:"italic",action:e=>(h.$4.toggleMark(e,"italic",!0),!0)},[Jl.Underline]:{icon:b.Z.FormatUnderline,label:"Underline",type:"underline",action:e=>(h.$4.toggleMark(e,"underline",!0),!0)},[Jl.Strikethrough]:{icon:b.Z.FormatStrikethrough,label:"Strikethrough",type:"strikethrough",action:e=>(h.$4.toggleMark(e,"strikethrough",!0),!0)},[Jl.Color]:{icon:b.Z.TextColor,type:"color",label:"Color",action:e=>!0},[Jl.Highlight]:{icon:b.Z.Highlight,label:"Highlight",type:"highlight",action:e=>(h.$4.toggleMark(e,"highlight",!0),!0)},[Jl.Code]:{icon:b.Z.Code,label:"Code Snippet",type:"code",action:e=>(h.$4.toggleMark(e,"code",!0),!0)},[Jl.RemoveStyling]:{icon:b.Z.RemoveFormatting,label:"Remove Styling",type:"REMOVE_FORMATTING",action:e=>(h.$4.removeAllMarks(e),!0)}},ei=e=>{const t={...Xl};if(e)for(const[n,r]of Object.entries(e))t[n]={...t[n],...r};return Object.values(t)},ti=(0,Zl.eE)(),ni={type:Kl.FORMAT,label:r.createElement("p",{className:"ghq-next-card-content__p ghq-no-vertical-rhythm"},"Paragraph"),keyboardCommand:ti?["\u2318","opt","0"]:["ctrl","alt","0"],keyboardShortCommand:ti?["\u2318","\u2325","0"]:["ctrl ","alt ","0"]},ri={type:Kl.FORMAT,label:r.createElement("h1",{className:"ghq-next-card-content__large-heading ghq-no-vertical-rhythm"},"Large Heading"),keyboardCommand:ti?["\u2318","opt","1"]:["ctrl","alt","1"],keyboardShortCommand:ti?["\u2318","\u2325","1"]:["ctrl ","alt ","1"],markdownCommand:["#","space"]},ai={type:Kl.FORMAT,label:r.createElement("h2",{className:"ghq-next-card-content__medium-heading ghq-no-vertical-rhythm"},"Medium Heading"),keyboardCommand:ti?["\u2318","opt","2"]:["ctrl","alt","2"],keyboardShortCommand:ti?["\u2318","\u2325","2"]:["ctrl ","alt ","2"],markdownCommand:["##","space"]},oi={type:Kl.FORMAT,label:r.createElement("h3",{className:"ghq-next-card-content__small-heading ghq-no-vertical-rhythm"},"Small Heading"),keyboardCommand:ti?["\u2318","opt","3"]:["ctrl","alt","3"],keyboardShortCommand:ti?["\u2318","\u2325","3"]:["ctrl ","alt ","3"],markdownCommand:["###","space"]},li={type:Kl.FORMAT,label:r.createElement("ol",{className:"ghq-next-card-content__numbered-list ghq-no-vertical-rhythm"},r.createElement("li",{className:"ghq-next-card-content__list-item"},"Numbered List")),keyboardCommand:ti?["\u2318","opt","n"]:["ctrl","alt","n"],keyboardShortCommand:ti?["\u2318","\u2325","N"]:["ctrl ","alt ","N"],markdownCommand:["1.","space"]},ii={type:Kl.FORMAT,label:r.createElement("ul",{className:"ghq-next-card-content__bulleted-list ghq-no-vertical-rhythm"},r.createElement("li",{className:"ghq-next-card-content__list-item"},"Bulleted List")),keyboardCommand:ti?["\u2318","opt","b"]:["ctrl","alt","b"],keyboardShortCommand:ti?["\u2318","\u2325","B"]:["ctrl ","alt ","B"],markdownCommand:["-","space"]},si={type:Kl.FORMAT,label:r.createElement("blockquote",{className:"ghq-next-card-content__block-quote ghq-no-vertical-rhythm"},"Block quote"),keyboardCommand:ti?["\u2318","opt","'"]:["ctrl","alt","'"],keyboardShortCommand:ti?["\u2318","\u2325","'"]:["ctrl ","alt ","'"],markdownCommand:[">","space"]},ci={type:Kl.FORMAT,label:r.createElement("code",{className:"ghq-next-card-content__code-snippet ghq-no-vertical-rhythm"},"Code Block"),keyboardCommand:ti?["\u2318","opt","c"]:["ctrl","alt","c"],keyboardShortCommand:ti?["\u2318","\u2325","C"]:["ctrl ","alt ","C"],markdownCommand:["```"]},di=[ni,ri,ai,oi,li,ii,si,ci],ui={type:Kl.STYLE,label:r.createElement("em",{className:"ghq-next-card-content__italic"},"Italic"),keyboardCommand:ti?["\u2318","i"]:["ctrl","i"],keyboardShortCommand:ti?["\u2318","I"]:["ctrl ","I"],markdownCommand:["_italic_","Space"]},hi={type:Kl.STYLE,label:r.createElement("b",{className:"ghq-next-card-content__bold"},"Bold"),keyboardCommand:ti?["\u2318","b"]:["ctrl","b"],keyboardShortCommand:ti?["\u2318","B"]:["ctrl ","B"],markdownCommand:["*bold*","Space"]},pi={type:Kl.STYLE,label:r.createElement("del",{className:"ghq-next-card-content__strikethrough"},"Strikethrough"),keyboardCommand:ti?["\u2318","shift","x"]:["ctrl","shift","x"],keyboardShortCommand:ti?["\u2318","\u2191","X"]:["ctrl ","shift ","X"],markdownCommand:["~strikethrough~","Space"]},mi={type:Kl.STYLE,label:r.createElement("u",{className:"ghq-next-card-content__underline"},"Underline"),keyboardCommand:ti?["\u2318","u"]:["ctrl","u"],keyboardShortCommand:ti?["\u2318","U"]:["ctrl ","U"]},gi={type:Kl.STYLE,label:r.createElement("code",{className:"ghq-next-card-content__code-snippet"},"Code Snippet"),keyboardCommand:ti?["\u2318","shift","k"]:["ctrl","shift","k"],keyboardShortCommand:ti?["\u2318","\u2191","K"]:["ctrl ","shift ","K"],markdownCommand:["`code`","Space"]},fi={type:Kl.STYLE,label:r.createElement("mark",{className:"ghq-next-card-content__highlight"},"Highlight"),keyboardCommand:ti?["\u2318","e"]:["ctrl","e"],keyboardShortCommand:ti?["\u2318","E"]:["ctrl ","E"]},vi={type:Kl.STYLE,label:r.createElement("span",null,"Remove Styling"),keyboardCommand:ti?["\u2318","\\"]:["ctrl","\\"],keyboardShortCommand:ti?["\u2318","\\"]:["ctrl","\\"]},Ei=[hi,ui,mi,pi,fi,gi,vi],bi={type:Kl.INSERT,label:r.createElement("span",null,"Image"),keyboardCommand:ti?["\u2318","opt","i"]:["ctrl","alt","i"],keyboardShortCommand:ti?["\u2318","\u2325","I"]:["ctrl ","alt ","I"]},yi={type:Kl.INSERT,label:r.createElement("span",null,"Video"),keyboardCommand:ti?["\u2318","opt","v"]:["ctrl","alt","v"],keyboardShortCommand:ti?["\u2318","\u2325","V"]:["ctrl ","alt ","V"]},Ci={type:Kl.INSERT,label:r.createElement("span",null,"File"),keyboardCommand:ti?["\u2318","opt","f"]:["ctrl","alt","f"],keyboardShortCommand:ti?["\u2318","\u2325","F"]:["ctrl ","alt ","F"]},Ni={type:Kl.INSERT,label:r.createElement("span",null,"Table"),keyboardCommand:ti?["\u2318","opt","t"]:["ctrl","alt","t"],keyboardShortCommand:ti?["\u2318","\u2325","T"]:["ctrl ","alt ","T"]},Ti={type:Kl.INSERT,label:r.createElement("span",null,"Guru Card"),keyboardCommand:ti?["\u2318","opt","["]:["ctrl","alt","["],keyboardShortCommand:ti?["\u2318","\u2325","["]:["ctrl ","alt ","["]},Si={type:Kl.INSERT,label:r.createElement("span",null,"Link"),keyboardCommand:ti?["\u2318","k"]:["ctrl","k"],keyboardShortCommand:ti?["\u2318","K"]:["ctrl ","K"]},ki={type:Kl.INSERT,label:r.createElement("span",null,"Divider"),keyboardCommand:ti?["\u2318","opt","-"]:["ctrl","alt","-"],keyboardShortCommand:ti?["\u2318","\u2325","-"]:["ctrl ","alt ","-"],markdownCommand:["---"]},xi=[bi,yi,Ni,Si,Ci,Ti,ki],Li={label:r.createElement("span",null,"Toggle Guide"),keyboardCommand:ti?["\u2318","?"]:["ctrl","?"],keyboardShortCommand:ti?["\u2318","?"]:["ctrl","?"]},_i={label:r.createElement("span",null,"Undo"),keyboardCommand:ti?["\u2318","z"]:["ctrl","z"],keyboardShortCommand:ti?["\u2318","Z"]:["ctrl ","Z"]},Ii={label:r.createElement("span",null,"Redo"),keyboardCommand:ti?["\u2318","shift","z"]:["ctrl","y"],keyboardShortCommand:ti?["\u2318 ","shift ","Z"]:["ctrl ","Y"]},wi=[Li,_i,Ii,{label:r.createElement("span",null,"Line break"),keyboardCommand:["shift","Enter"]}],Mi=[{label:r.createElement("span",null,"Move to other cells"),keyboardCommand:["\u2190, \u2192, \u2191, \u2193"]},{label:r.createElement("span",null,"Line break within a cell"),keyboardCommand:["shift","Enter"]},{label:r.createElement("span",null,"Exit table"),keyboardCommand:ti?["\u2318","Enter"]:["ctrl","Enter"]}];var Pi={p:ni,1:ri,2:ai,3:oi,ol:li,ul:ii,[qr.H.BlockQuote]:si,[qr.H.CodeBlock]:ci,[qr.H.Image]:bi,[qr.H.Video]:yi,[qr.H.Table]:Ni,[qr.H.File]:Ci,[qr.H.Divider]:ki,[qr.H.GuruCard]:Ti,[qr.H.Link]:Si,[Jl.RemoveStyling]:vi,[Jl.Bold]:hi,[Jl.Italic]:ui,[Jl.Code]:gi,[Jl.Highlight]:fi,[Jl.Strikethrough]:pi,[Jl.Underline]:mi,[Kl.KEYBOARD_GUIDE]:Li,[Kl.UNDO]:_i,[Kl.REDO]:Ii,[Kl.ESCAPE_CODE_BLOCK]:{keyboardCommand:ti?["\u2318","Enter"]:["ctrl","Enter"],keyboardShortCommand:ti?["\u2318-Enter"]:["ctrl-Enter"]},[Kl.INDENT]:{keyboardShortCommand:["Tab"]},[Kl.UNDENT]:{keyboardShortCommand:["shift + Tab"]}},Di=n(64469),Ai=n(1604),Oi=n(27998),Ri=n(75341);const Zi=new Oi.Z;let qi;!function(e){e.ImproveSpellingAndGrammar="IMPROVE_SPELLING_GRAMMAR",e.ImproveSimplifyVocab="IMPROVE_SIMPLIFY_VOCAB",e.ImproveRefineVocab="IMPROVE_REFINE_VOCAB",e.ImproveDecreaseLength="IMPROVE_DECREASE_LENGTH"}(qi||(qi={}));let Fi;!function(e){e.SummarizeTLDR="SUMMARIZE_TLDR",e.SummarizeParagraph="SUMMARIZE_PARAGRAPH",e.SummarizeBulletedList="SUMMARIZE_BULLETED_LIST",e.SummarizeNumberedList="SUMMARIZE_NUMBERED_LIST"}(Fi||(Fi={}));let Bi;!function(e){e.ToneConversational="TONE_CONVERSATIONAL",e.ToneDirect="TONE_DIRECT",e.ToneEmpathetic="TONE_EMPHATIC",e.ToneProfessional="TONE_PROFESSIONAL",e.ToneWitty="TONE_WITTY"}(Bi||(Bi={}));let Hi;!function(e){e.TranslateChinese="TRANSLATE_CHINESE",e.TranslateEnglish="TRANSLATE_ENGLISH",e.TranslateFrench="TRANSLATE_FRENCH",e.TranslateGerman="TRANSLATE_GERMAN",e.TranslateJapanese="TRANSLATE_JAPANESE",e.TranslateSpanish="TRANSLATE_SPANISH"}(Hi||(Hi={}));const Ui={...Bi,...Hi,...qi,...Fi,CustomPrompt:"CUSTOM_PROMPT"},zi=(Ai.z.object({content:Ai.z.string(),suggestionId:Ai.z.string().uuid(),truncated:Ai.z.boolean().optional(),usage:Ai.z.object({promptTokens:Ai.z.number(),completionTokens:Ai.z.number(),totalTokens:Ai.z.number()})}),Ai.z.object({collectionId:Ai.z.string().uuid().optional(),cardId:Ai.z.string(),actions:Ai.z.nativeEnum(Ui).array(),content:Ai.z.string(),promptIncluded:Ai.z.boolean().optional()}));async function Vi(e){const t=(0,Ri.A)(zi,e);return Zi.post({path:"/ai/generate",body:t})}var Yi,ji=()=>(0,Di.D)({mutationFn:Vi}),Wi=n(37540);!function(e){e.ToneConversational="features.editor.assist.menuActions.adjustTone.conversational",e.ToneDirect="features.editor.assist.menuActions.adjustTone.direct",e.ToneEmpathetic="features.editor.assist.menuActions.adjustTone.empathetic",e.ToneProfessional="features.editor.assist.menuActions.adjustTone.professional",e.ToneWitty="features.editor.assist.menuActions.adjustTone.witty"}(Yi||(Yi={}));var Gi,Ki=e=>{let{isDisabled:t,handleOnClick:n}=e;const{t:a}=(0,Kn.$G)();return r.createElement(Wi.ZP,{ariaLabel:a("features.editor.assist.menuActions.aria"),heading:a("features.editor.assist.menuActions.adjustToneLabel")},Object.keys(Yi).map((e=>r.createElement(Wi.sN,{key:e,disabled:t,onClick:()=>n(Ui[e])},a(Yi[e])))))};!function(e){e.ImproveSpellingAndGrammar="features.editor.assist.menuActions.improve.fixSpellingAndGrammar",e.ImproveSimplifyVocab="features.editor.assist.menuActions.improve.simplifyVocabulary",e.ImproveRefineVocab="features.editor.assist.menuActions.improve.refineVocabulary",e.ImproveDecreaseLength="features.editor.assist.menuActions.improve.decreaseWords"}(Gi||(Gi={}));var $i,Qi=e=>{let{isDisabled:t,handleOnClick:n}=e;const{t:a}=(0,Kn.$G)();return r.createElement(Wi.ZP,{ariaLabel:a("features.editor.assist.menuActions.aria"),heading:a("features.editor.assist.menuActions.improveLabel")},Object.keys(Gi).map((e=>r.createElement(Wi.sN,{key:e,disabled:t,onClick:()=>n(Ui[e])},a(Gi[e])))))};!function(e){e.SummarizeTLDR="features.editor.assist.menuActions.summarize.TLDR",e.SummarizeParagraph="features.editor.assist.menuActions.summarize.Paragraph",e.SummarizeBulletedList="features.editor.assist.menuActions.summarize.BulletedList",e.SummarizeNumberedList="features.editor.assist.menuActions.summarize.NumberedList"}($i||($i={}));var Ji,Xi=e=>{let{isDisabled:t,handleOnClick:n}=e;const{t:a}=(0,Kn.$G)();return r.createElement(Wi.ZP,{ariaLabel:a("features.editor.assist.menuActions.aria"),heading:a("features.editor.assist.menuActions.summarizeLabel")},Object.keys($i).map((e=>r.createElement(Wi.sN,{key:e,disabled:t,onClick:()=>n(Ui[e])},a($i[e])))))};!function(e){e.TranslateChinese="features.editor.assist.menuActions.translate.chinese",e.TranslateEnglish="features.editor.assist.menuActions.translate.english",e.TranslateFrench="features.editor.assist.menuActions.translate.french",e.TranslateGerman="features.editor.assist.menuActions.translate.german",e.TranslateJapanese="features.editor.assist.menuActions.translate.japanese",e.TranslateSpanish="features.editor.assist.menuActions.translate.spanish"}(Ji||(Ji={}));var es=e=>{let{isDisabled:t,handleOnClick:n}=e;const{t:a}=(0,Kn.$G)();return r.createElement(Wi.ZP,{ariaLabel:a("features.editor.assist.menuActions.aria"),heading:a("features.editor.assist.menuActions.translateLabel")},Object.keys(Ji).map((e=>r.createElement(Wi.sN,{key:e,disabled:t,onClick:()=>n(Ui[e])},a(Ji[e])))))};var ts=e=>{let{isDisabled:t,onClose:n}=e;const a=(0,Gt.y)(),o=(e,t)=>{n(),a.setContextState((n=>({...n,popoverMode:"guruAIAssist",popoverData:{actions:[e],customPrompt:t}})))};return r.createElement("div",{className:"ghq-AIAssistActionsMenu"},r.createElement(Qi,{isDisabled:t,handleOnClick:o}),r.createElement(Xi,{isDisabled:t,handleOnClick:o}),r.createElement(Ki,{isDisabled:t,handleOnClick:o}),r.createElement(es,{isDisabled:t,handleOnClick:o}),"DEV"===Sa.ZP.ENV_NAME||"QA"===Sa.ZP.ENV_NAME?r.createElement(Wi.ZP,{ariaLabel:"AI Assist Actions Menu",heading:"Custom Prompt"},r.createElement(Wi.sN,{disabled:t,icon:b.Z.Pencil,onClick:()=>{const e=window.prompt("Add your custom prompt");o(Ui.CustomPrompt,e)}},"Custom Prompt")):null)},ns=n(15286),rs=n(1164);var as=e=>{let{hasSelectedContent:t=!1,wordCount:n}=e;const a="".concat(n," ").concat((0,ns.B$)("word",n)),o=t?"Selected text:":"Entire Card:";return r.createElement("div",{className:"ghq-AIAssistCallout"},r.createElement(rs.ZP,{spacing:rs.sJ.Short},r.createElement("p",{className:"ghq-AIAssistCallout__label"},o),a))};var os=()=>{var e;const{trackEvent:t}=er(),{card:n,collectionId:a}=(0,Pn.RC)(),o=null===(e=n.editFact.data)||void 0===e?void 0:e.id;return r.useEffect((()=>{t({name:ir.default.AI_ASSIST_GENERATE_DISABLED_CALLOUT_VIEWED,type:"track",eventData:{activitySubtype:Xn.EditorToolbar,activityMetaData:[{featureName:$n.Z.AI_ASSIST_GENERATE,data:{cardId:o,collectionId:a}}]}})}),[]),r.createElement("div",{className:"ghq-AIAssistDisabledCallout"},r.createElement(rs.ZP,null,"In order to use the Assist actions below, you must first add text to your Card."))};var ls=e=>{let{className:t,onClose:n=(()=>{})}=e;const a=(0,u._7)(),o=Ye()("ghq-AIAssistToolbarMenu",t),l=(e=>{const t=tr(e.children);return!t||!t.some((t=>f.W_.isElement(t)&&!f.ML.isEmpty(e,t)||f.W_.isElement(t)&&"p"!==t.type))})(a),{hasSelectedContent:i,plaintextContent:s}=lr(),c=r.useRef(null);r.useEffect((()=>{c.current&&c.current.focus()}),[c]);const d=(s.match(/\S+/g)||[]).length;return r.createElement("div",{className:o,ref:c,tabIndex:-1},l?r.createElement(os,null):r.createElement(as,{hasSelectedContent:i,wordCount:d}),r.createElement(ts,{isDisabled:l,onClose:n}))};const is=e=>{let{className:t}=e;const n=Ye()("ghq-fact-editor-menu-break",t);return r.createElement("div",{className:n})},ss=(e,t)=>[{name:"Paragraph",icon:b.Z.FormatParagraph,type:"p",action:()=>h.$4.setParagraph(e)},{type:"break"},{name:"Large Heading",level:1,icon:b.Z.FormatHeader1,type:"heading",action:()=>h.$4.toggleHeading(e,1)},{name:"Medium Heading",level:2,icon:b.Z.FormatHeader2,type:"heading",action:()=>h.$4.toggleHeading(e,2)},{name:"Small Heading",level:3,icon:b.Z.FormatHeader3,type:"heading",action:()=>h.$4.toggleHeading(e,3)},{type:"break"},{name:"Bulleted List",icon:b.Z.FormatListBulleted,listType:"ul",type:"list",action:()=>x.action(e,t)},{name:"Numbered List",icon:b.Z.FormatListNumbered,listType:"ol",type:"list",action:()=>{L.action(e,t)}},{type:"break"},{name:"Block Quote",icon:b.Z.FormatQuote,type:"block-quote",action:()=>h.$4.setBlockQuote(e)},{name:"Code Block",icon:b.Z.Code,type:"code-block",action:()=>(0,h.oS)(e,(e=>({type:"code-block",language:"plain",children:[{type:"code-line",children:[{text:f.NB.string(e)}]}]})))}];var cs=e=>{let{className:t}=e;const n=(0,u._7)(),a=(0,Gt.y)(),o=ss(n,a).map(((e,t)=>{const{icon:a,name:o,type:l,action:i}=e;if("break"===l)return r.createElement(is,{key:"".concat(l,"-").concat(t)});const s=(0,m.fe)({editor:n});return r.createElement(Vl,{selectable:!s,disabled:s,key:o,className:"ghq-next-fact-editor-toolbar-menu__option",dataTestId:"next-editor-dropdown-format-menu-option",value:l,onSelect:i},r.createElement(Qt.Z,{icon:a}),r.createElement("span",{className:"ghq-next-fact-editor-toolbar-menu__option-name"},o),r.createElement(xs,{type:l,command:e}))})),l=Ye()("ghq-next-fact-editor-format-toolbar-menu",t);return r.createElement(zl,{className:l},o)},ds=n(96026),us=n.n(ds);function hs(e,t){return{type:"table",header:!1,columns:e,children:us()(t).map((()=>({type:"tr",children:e.map(((e,t)=>({type:"td",children:[(0,Dr.c)()]})))})))}}const ps={icon:b.Z.IconTable,type:"table",label:"Table",action:e=>(function(e,t){let{columns:n,rowCount:r}=t;const a=hs(n,r);if(!e.selection)return;f.YR.splitNodes(e,{mode:"highest"}),f.YR.insertNodes(e,a,{select:!0,mode:"highest"});const{selection:o}=e;if(o){const t=f.ML.start(e,o.anchor.path.slice(0,1));f.YR.setSelection(e,{anchor:t,focus:t})}}(e,{columns:[{width:160},{width:160},{width:160}],rowCount:2}),!0)};function ms(e){let{editor:t,videoUrl:n,originalSrc:r,asInlineLink:a=!1}=e;const{selection:o}=t;if(!o)return;if(a){const e=f.ML.string(t,o);return f.YR.insertNodes(t,{type:"link",url:n,children:[{text:e}]})}const l=f.y$.parent(o.anchor.path);if(!f.ML.hasPath(t,l))return!1;const i=f.NB.get(t,l),s=f.ML.isEmpty(t,i),c=[l[0]+1];s&&f.YR.removeNodes(t);let d=o;try{const e=f.NB.get(t,c);d="video"===e.type||f.ML.isVoid(t,e)?s?l:[l[0]+1]:s?l:o}catch(e){d=void 0}return f.YR.insertNodes(t,{type:"video",url:n,children:[{text:""}],originalSrc:r},{at:d})}function gs(e){return f.W_.isElement(e)&&"video"===e.type}function fs(){return fs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fs.apply(this,arguments)}const vs=r.forwardRef(((e,t)=>{let{style:n,element:a,setPopoverMode:o,...l}=e;const[i,s]=(0,r.useState)((null==a?void 0:a.url)||""),c=(0,u._7)(),d=(0,r.useRef)(null);(0,r.useEffect)((()=>{const e=setTimeout((()=>{null!=d.current&&(null==d||d.current.focus())}));return()=>clearTimeout(e)}),[null==d?void 0:d.current]);const h=()=>{if(!i)return;const e=Dt(i);if(null!=a&&a.url){const t=u.F3.findPath(c,a),n=a.originalSrc||"";f.YR.setNodes(c,{url:e,originalSrc:n},{at:t})}else ms({videoUrl:e,editor:c,originalSrc:i});o("hidden"),u.F3.focus(c)},p=()=>{o("default"),u.F3.focus(c)};return r.createElement("div",fs({},qt()(l,["popoverMode"]),{ref:t,"data-testid":"PopoverVideoEdit",style:{...n,position:"fixed"}}),r.createElement(Ft,{className:"ghq-EditVideoPopover"},r.createElement("div",{className:"ghq-EditVideoPopover__field"},r.createElement("label",{className:"ghq-PopoverContent__field-label",htmlFor:"videoUrl"},"Video URL"),r.createElement("input",{ref:d,"data-testid":"Video URL",id:"videoUrl",className:"ghq-input ghq-next-fact-editor-popover__field-input",value:i,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),h()):"Escape"===e.key&&(e.preventDefault(),p())}}),r.createElement("div",null,r.createElement(Ht.Z,{style:Ht.W.Dim},"Works best with YouTube, Vimeo, Wistia, and other popular video sites.")),r.createElement("div",{className:"ghq-EditVideoPopover__buttons"},r.createElement(Bt.ZP,{label:"Save",disabled:!i,size:Bt.qE.Small,theme:Bt.bn.Primary,onClick:h}),r.createElement(Bt.ZP,{label:"Cancel",size:Bt.qE.Small,theme:Bt.bn.Gray,style:Bt.ZJ.Outline,onClick:p})))))}));function Es(){return Es=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Es.apply(this,arguments)}function bs(e){let{attributes:t,children:n,element:a,editor:o}=e;const l=Qe(),i=(0,u.GQ)(),[s,c]=r.useState(!1),[d,h]=r.useState(!1),p=r.useRef(-1),{setContextState:m}=(0,Gt.y)(),{url:g}=a,[f,v]=r.useState(i);r.useEffect((()=>{if(!i)return l?v(!0):l&&!u.F3.isFocused(o)||!l&&u.F3.isFocused(o)?v(!1):void 0}),[l]);const E=r.useCallback((e=>{e&&(p.current=window.setTimeout((()=>{h(!0)}),3e4))}),[]),y=r.useMemo((()=>Kt.Z.hasSandboxIframes()?{sandbox:ne.Z.SANDBOX_PERMISSIONS}:{}),[]);r.useEffect((()=>()=>{p.current>0&&window.clearTimeout(p.current)}),[]);const C=d||!(/^(http(s)?:\/\/)?(www\.)?[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,}\b(\/[-a-zA-Z0-9@:%_;!+.~#?&//=]*)?\W*$/gi.test(N=g)||/^(?:(?:ht|f)tp(?:s?):\/\/|~\/|\/)?(?:\w+:\w+@)?((?:(?:[-\w\d{1-3}]+\.)+(?:com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|edu|co\.uk|ac\.uk|it|fr|tv|museum|asia|local|travel|[a-z]{2}))|((\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)(\.(\b25[0-5]\b|\b[2][0-4][0-9]\b|\b[0-1]?[0-9]?[0-9]\b)){3}))(?::[\d]{1,5})?(?:(?:(?:\/(?:[-\w~!$+|.,=]|%[a-f\d]{2})+)+|\/)+|\?|#)?(?:(?:\?(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)(?:&(?:[-\w~!$+|.,*:]|%[a-f\d{2}])+=?(?:[-\w~!$+|.,*:=]|%[a-f\d]{2})*)*)*(?:#(?:[-\w~!$ |/.,*:;=]|%[a-f\d]{2})*)?$/i.test(N)||/^(http(s)?:\/\/)?(www\.)?(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?\W*$/gi.test(N));var N;return r.createElement("div",Es({className:"ghq-RenderVideo","data-testid":"Video Wrapper"},t),!i&&r.createElement($e,null,r.createElement(We.ZP,{aria:"edit-video-block-button",icon:b.Z.Pencil,tooltipLabel:"Edit",tooltipPosition:je.DU.Top,style:We.Dd.Standard,iconSize:16,onClick:e=>{null==e||e.preventDefault(),m((e=>({...e,popoverMode:"editingVideo"})))}}),r.createElement(Ge,{element:a})),r.createElement("div",{className:"ghq-RenderVideo__responsive",contentEditable:!1},C?r.createElement("div",{"data-testid":"Video Error Block",className:Ye()("ghq-RenderVideo__inner","--error",{"--highlighted":l,"--read-only":i})},r.createElement(Qt.Z,{icon:b.Z.VideoError,color:$t.ZP.Fruitpunch})):r.createElement(r.Fragment,null,!s&&r.createElement("div",{"data-testid":"Video Loading Block",className:Ye()("ghq-RenderVideo__inner","--loader",{"--highlighted":l})},r.createElement(Jt.ZP,{size:Jt.wx.Small,color:Jt.Cl.Slime})),r.createElement("iframe",Es({allowFullScreen:!0},y,{"data-testid":"Video Block",className:Ye()("ghq-RenderVideo__iframe",{"--highlighted":l,"--hide":!s}),src:It(g),frameBorder:0,contentEditable:!1,tabIndex:-1,ref:E,onError:()=>h(!0),onLoad:()=>{window.clearTimeout(p.current),c(!0)}})),r.createElement("div",{contentEditable:!1,className:Ye()("ghq-RenderVideo__iframe-overlay",{"--can-interact-with":f}),onClick:()=>v(!0)}))),n)}function ys(){return ys=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ys.apply(this,arguments)}const Cs={icon:b.Z.Video,label:"Video",type:"video",action:(e,t)=>(t.setContextState((e=>bt(e,"insertingVideo"))),!0)},Ns=M({"mod+alt+v":(e,t)=>(Cs.action(e,t),!0)}),Ts=(e,t,n)=>{const a=t.deleteBackward,o=t.deleteForward,{insertBreak:l}=t;return t.deleteForward=e=>o(e),t.deleteBackward=e=>{const{selection:n}=t;if(!n)return a(e);if(n.anchor.path[0]<1)return a(e);const[r]=Array.from(f.ML.above(t)||[]),o=f.ML.isEmpty(t,r),{anchor:{path:l}}=n;if(o){const[e,n]=f.ML.above(t,{at:l,match:e=>(0,v._x)(e)})||[],[r,a]=f.ML.previous(t,{at:n})||[];if(null!=r&&null!=e&&gs(r)&&A(e)){if(f.YR.removeNodes(t,{at:n}),null!=a){const e=f.ML.end(t,a);f.YR.setSelection(t,{anchor:e,focus:e})}return}}return a(e)},t.insertBreak=()=>{const[e]=Array.from(f.ML.above(t)||[]);if("video"===e.type){const[e]=Array.from(f.ML.next(t)||[]);return""===(null==e?void 0:e.text)?(f.YR.move(t,{unit:"line"}),!0):(f.ML.insertNode(t,{type:"p",children:[{text:""}]}),!0)}return l()},{...e,editableProps:{...e.editableProps,onPaste(n){var r,a;const{types:o}=n.clipboardData,l=n.clipboardData.getData("text/plain"),{selection:i}=t;return i&&o.includes("text/plain")&&kt(l)?(n.preventDefault(),void ms({editor:t,videoUrl:l,asInlineLink:f.e6.isExpanded(i),originalSrc:l})):null===(r=(a=e.editableProps).onPaste)||void 0===r?void 0:r.call(a,n)},onKeyDown:r=>{var a,o;if(!Ns(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)},renderElement:n=>{var a,o;return"video"===n.element.type?r.createElement(bs,ys({},n,{element:n.element,actions:e.popoverActions,editor:t})):(null===(a=(o=e.editableProps).renderElement)||void 0===a?void 0:a.call(o,n))||r.createElement(u.Qr,n)}},toolbarActions:[...e.toolbarActions,Cs],popoverActions:[...e.popoverActions,Cs],renderPopover:n=>{const{popoverMode:a,element:o}=n;if("insertingVideo"===a)return r.createElement(vs,ys({},n,{element:o}));if("editingVideo"===a){const[e]=Array.from(f.ML.above(t)||[]);if("video"===e.type)return r.createElement(vs,ys({},n,{element:e}))}return e.renderPopover(n)},serializeElement:(t,n)=>gs(t)?((e,t)=>{const n=(0,O.U)({node:e,classType:"video",contentTypeValue:"VIDEO",element:"iframe",serialize:t,attributes:{allowfullscreen:"",frameborder:0,src:_t(e.url),title:"ghq-video","data-ghq-card-content-video-original-src":e.originalSrc}});return'<div class="ghq-card-content__video-responsive-wrapper">'.concat(n,"</div>")})(t,n):e.serializeElement(t,n),parseHtmlElement:t=>{const n=t;if(!(1===n.nodeType))return e.parseHtmlElement(t);const r=wt(n),a=wt(n,"original",r),{isParentVideo:o,isWrapperVideo:l}=(e=>{const t="ghq-card-content__video-responsive-wrapper",n=e.getAttribute("class")===t,r=e.closest(".".concat(t));return{parent:r,isWrapperVideo:n,isParentVideo:Boolean(r)}})(n),i={type:"video",url:"",originalSrc:"",children:[{text:""}]};if(Mt(n)&&!o)return i.url=r,i.originalSrc=a,i;if(l){for(const e of n.children){const t=e;if(Mt(t)){i.url=wt(t),i.originalSrc=wt(t,"original",i.url);break}}return i}return e.parseHtmlElement(t)}}};var Ss=e=>{let{className:t,onClose:n}=e;const a=(0,u._7)(),o=(0,Gt.y)();r.useEffect((()=>{o.setContextState((e=>bt(e,"hidden")))}),[]);const l=[$o,Cs,ps,{type:"break"},cl,Yn,io,{type:"break"},ht,an,bl],i=[qr.H.Title,qr.H.File,qr.H.Link,qr.H.GuruCard,qr.H.CodeBlock],s=l.map(((e,t)=>{if("break"===e.type)return r.createElement(is,{key:"".concat(e.type,"-").concat(t)});const{icon:l,label:s,type:c,action:d}=e,u=(0,m.dx)({editor:a})&&m.eg.includes(c),h=ua(a)&&"table"===c,p=i.includes(c)&&(0,m.iL)({editor:a})||(0,yt.tC)(a)||u||(0,m.fe)({editor:a,bannedTypes:i})||h;return r.createElement(Vl,{selectable:!p,disabled:p,key:s,className:"ghq-next-fact-editor-toolbar-menu__option",value:c,onSelect:()=>{d(a,o),n()}},r.createElement(Qt.Z,{icon:l}),r.createElement("span",{className:"ghq-next-fact-editor-toolbar-menu__option-name","data-testid":"Toolbar insert dropdown - ".concat(s)},s),r.createElement(xs,{type:c,command:e}))})),c=Ye()("ghq-next-fact-editor-insert-toolbar-menu",t);return r.createElement(zl,{className:c},s)};function ks(){return ks=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ks.apply(this,arguments)}function xs(e){let{type:t,command:n}=e;const a=Pi[t]||Pi[n.level]||Pi[n.listType];if(!a)return null;const o=a.keyboardShortCommand?a.keyboardShortCommand:a.keyboardCommand;return r.createElement("span",{className:"ghq-next-fact-editor-toolbar-menu__keyboard-shortcut"},o)}const Ls={openedMenu:jt().string,onClose:jt().func};class _s extends r.Component{constructor(){super(...arguments),this.getMenu=e=>{switch(e){case Kl.TOOLBAR_FORMAT:return cs;case Kl.TOOLBAR_INSERT:return Ss;case _e.ToolbarAssist:return ls}},this.applyClassNameByStatus=(e,t)=>n=>r.createElement(e,ks({},t,{className:"ghq-next-fact-editor-toolbar-menu ghq-is-".concat(n)})),this.timeout={enter:0,exit:500}}render(){const{open:e,openedMenu:t,target:n,...a}=this.props,o=e?r.createElement(jl.default,{unmountOnExit:!0,timeout:this.timeout},this.applyClassNameByStatus(this.getMenu(t),{...a,openedMenu:t})):null;return r.createElement(Ha.Z,{poll:!0,target:n,preferredXPosition:"center"},r.createElement(Gl(),null,o))}}_s.propTypes=Ls,_s.defaultProps={onClose:()=>{}};var Is=e=>{var t;let{openedMenu:n}=e;const[a,o]=r.useState(!1),l=(0,u._7)(),i=(0,Gt.y)(),{trackEvent:s}=er(),c=(0,xn.Z)((()=>o(!1))),d=r.useRef(null),{card:h,collectionId:p}=(0,Pn.RC)(),m=null===(t=h.editFact.data)||void 0===t?void 0:t.id,g=n!==_e.ToolbarAssist?"Popover toolbar Assist":"Toolbar Assist",f=e=>{n===_e.ToolbarAssist&&("default"===e?(i.setContextState((e=>bt(e,"default"))),u.F3.focus(l)):i.setContextState((e=>bt(e,"hidden"))))};return r.createElement("div",{className:"ghq-NextFactEditorToolbarAIAssistButton",ref:c},r.createElement("div",{ref:d,"aria-expanded":a,"data-testid":g,className:"ghq-NextFactEditorToolbarAIAssistButton__dropdown",role:"button",tabIndex:0,onClick:()=>{o((e=>!e)),a?rr(l)&&f("default"):(f("hidden"),s({name:ir.default.AI_ASSIST_GENERATE_ASSIST_BUTTON_CLICKED,type:"click",eventData:{activitySubtype:Xn.EditorToolbar,activityMetaData:[{featureName:$n.Z.AI_ASSIST_GENERATE,data:{cardId:m,collectionId:p}}]}}))},onMouseDown:e=>{e.preventDefault()}},r.createElement("span",{className:"ghq-NextFactEditorToolbarAIAssistButton__label"},r.createElement(Qt.Z,{icon:b.Z.Suggestion,color:$t.ZP.Marmalade}),r.createElement("span",null,"Assist")),r.createElement(Qt.Z,{icon:a?b.Z.ChevronUp:b.Z.ChevronDown,size:16})),r.createElement(_s,{openedMenu:_e.ToolbarAssist,open:a,target:d.current,onClose:()=>{o(!1)}}))};var ws=()=>{const[e,t]=r.useState(!1),n=(0,u._7)(),a=(0,xn.Z)((()=>t(!1))),o=r.useRef(null),l=ss(n),i=Ye()("ghq-NextFactEditorToolbarFormatDropdown__icon",{open:"ghq-is-open"}),s=e?"chevron-up":"chevron-down",c=(0,m.XG)({editor:n,commands:l});return r.createElement("div",{className:"ghq-NextFactEditorToolbarFormatDropdown",ref:a},r.createElement("div",{ref:o,className:"ghq-NextFactEditorToolbarFormatDropdown__dropdown","data-testid":"next-editor-dropdown-format-menu",onClick:()=>{t((e=>!e))},onMouseDown:e=>{e.preventDefault()}},r.createElement("span",{className:"ghq-NextFactEditorToolbarFormatDropdown__dropdown-label"},c),r.createElement(Nn.Z,{size:16,icon:s,className:i}),r.createElement(_s,{openedMenu:Kl.TOOLBAR_FORMAT,open:e,target:o.current})))};var Ms=e=>{let{activeMarks:t,disabled:n,hasMultiBlocksSelected:a,isCursorOnLink:o,isPopover:l,items:i=[],onSelect:s,iconSize:c}=e;const d=(0,u._7)(),h=E(d),p=i.filter((e=>!(["indent","undent"].includes(e.type||"")&&!h))).filter(((e,t,n)=>!("break"===e.type&&t===n.length-1))).map(((e,i)=>{if("break"===e.type)return r.createElement(Yl,{className:"ghq-ToolbarMenuButtons__break",key:"".concat(e.type,"-").concat(i)});const{icon:u,type:h,label:p,action:g}=e;if(l&&"video"===h)return null;const f=Pi[h]||Pi[h.toUpperCase()],v=f?"".concat(p," - ").concat(f.keyboardShortCommand.join("")):p,E=[qr.H.Link,qr.H.GuruCard,qr.H.File].includes(h)&&a,b=!!t&&(Object.keys(t).includes(h)&&!n),y=o&&m.eg.includes(h),C=ua(d)&&"table"===h,N=l?"Popover toolbar ".concat(h):"Toolbar ".concat(h);return r.createElement(We.ZP,{key:i,aria:p,buttonSelected:b,dataTestId:N,disabled:n||(0,yt.tC)(d)||E||y||C,icon:u,iconSize:c||16,style:We.Dd.Standard,tooltipLabel:v,tooltipPosition:We.DU.Top,onClick:e=>{s(g)}})}));return r.createElement("div",{className:"ghq-NextFactEditorToolbarMenuButtons"},p)};var Ps=e=>{let{editor:t,actions:n,isPopover:a}=e;const o=(0,Gt.y)();return r.createElement("div",{className:"ghq-ExpandedToolbarMenu"},r.createElement(Ms,{isCursorOnLink:(0,m.dx)({editor:t}),isPopover:a,activeMarks:(0,m.wf)({editor:t}),disabled:(0,m.fe)({editor:t}),hasMultiBlocksSelected:(0,m.iL)({editor:t}),items:n,onSelect:e=>e(t,o)}))},Ds=n(16790);var As=e=>{let{aria:t,color:n,onClick:a}=e;return r.createElement("button",{"aria-label":t,className:"ghq-NextFactEditorToolbarColorButton",key:n,style:{backgroundColor:n},title:n,type:"button",onClick:a},r.createElement(Ds.Z,null,n))},Os=n(27434);const{vacuum:Rs}=Os.Z;var Zs=e=>{let{choosableColors:t,onChange:n,onClear:a}=e;const o=t.map((e=>({key:e,aria:"Toggle ".concat(e),color:e,onClick:()=>n(e)}))),l={key:Rs,aria:"Reset text color",color:Rs,onClick:()=>a()};return o.push(l),r.createElement("div",{className:"ghq-NextFactEditorColorMenu"},o.map((e=>r.createElement(As,e))))};var qs=e=>{let{editor:t,linkActions:n,isPopover:a,className:o}=e;const[l,i]=r.useState(!1),s={[Jl.Color]:{action:()=>(i(!0),!0)}};let c=[...ei(s)];n&&(c=[...c,{type:"break"},...Object.values(n)]);const d=Ye()("ghq-ToolbarMarksWithColors",o);return r.createElement("div",{className:d},l?r.createElement(r.Fragment,null,r.createElement(Zs,{choosableColors:Ie.Colors,onClear:()=>{const e=(0,m._F)({editor:t});e&&h.$4.toggleMark(t,"color",e),i(!1),u.F3.focus(t)},onChange:e=>{h.$4.toggleMark(t,"color",e),i(!1),u.F3.focus(t)}}),r.createElement(We.ZP,{tooltipPosition:We.DU.Top,style:We.Dd.Standard,aria:"Close",icon:b.Z.Close,tooltipLabel:"Close",onClick:()=>{i(!1),u.F3.focus(t)}})):r.createElement(Ps,{editor:t,isPopover:a,actions:c}))},Fs=n(13011);function Bs(){return Bs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bs.apply(this,arguments)}const Hs=r.forwardRef(((e,t)=>{let{style:n,actions:a,popoverMode:o,setPopoverMode:l,...i}=e;const s=n?"visible":"hidden",c=(0,u._7)(),[d,h]=(0,r.useState)(""),[p]=(0,Fs.Z)(ql.Z.GEN_AI_FULLCARD_SUMMARY_ALLOWED);return(0,r.useEffect)((()=>{h("entered")}),[]),(0,yt.tC)(c)||(0,Be.SY)(c)||(0,m.aZ)({editor:c})?null:r.createElement("div",Bs({},i,{ref:t,"data-testid":"PopoverToolbar",className:"ghq-next-fact-editor-selection-popover ghq-is-".concat(d),style:{...n,visibility:s,position:"fixed"}}),r.createElement("div",{className:"ghq-next-fact-editor-menu ghq-next-fact-editor-selection-menu ghq-is-embedded"},r.createElement(ws,null),r.createElement(Yl,{className:"ghq-ToolbarMenuButtons__break"}),r.createElement(qs,{isPopover:!0,editor:c,linkActions:(0,m.iL)({editor:c})?null:a}),p&&!Zl.ZP.isExtension()&&r.createElement(Is,null)))}));function Us(){return Us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Us.apply(this,arguments)}const zs=Rl()((e=>{e.setContextState((e=>(e.popoverMode="hidden"===e.popoverMode?"default":e.popoverMode,e)))}),100),Vs=(e,t,n)=>{const{apply:a}=t;return t.apply=e=>{"set_selection"===e.type&&zs(n),a(e)},{...e,renderPopover:t=>"default"===t.popoverMode?r.createElement(Hs,Us({actions:e.popoverActions},t)):e.renderPopover(t)}};function Ys(e,t,n){if(null!=n&&!f.ML.hasPath(e,f.ML.path(e,n)))return{};const r=null!=n?f.ML.node(e,n):null;let a=f.ML.above(e,{match:e=>f.W_.isElement(e)&&e.type===t,at:n});if(null==a&&null!=r&&f.W_.isElement(r[0])&&r[0].type===t&&(a=r),null==a)return{};const[o,l]=a;return{element:o,path:l}}function js(e,t){var n,r,a,o,l;const i=Ys(e,"td",t),s=Ys(e,"tr",t),c=Ys(e,"table",t),d=null===(n=c.element)||void 0===n?void 0:n.children,u=null==d?void 0:d.length,h=null===(r=s.element)||void 0===r?void 0:r.children.length;return{td:i.element,tdPath:i.path,tdIndex:null===(a=i.path)||void 0===a?void 0:a[i.path.length-1],tdCount:h,tr:s.element,trPath:s.path,trIndex:null===(o=s.path)||void 0===o?void 0:o[s.path.length-1],trCount:u,trs:d,table:c.element,tablePath:c.path,tableIndex:null===(l=c.path)||void 0===l?void 0:l[c.path.length-1]}}function Ws(e){let{editor:t,target:n,isRightInsert:r=!1,amount:a=1}=e;const o=Array.isArray(n)?n:u.F3.findPath(t,n),l=js(t,o),{table:i,tdIndex:s=0,trs:c=[],tablePath:d=[]}=l;f.ML.withoutNormalizing(t,(()=>{c.forEach(((e,n)=>{const o=s+(r?1:0),l=d.concat([n,o]),c=null==i?void 0:i.columns.slice();null==c||c.splice(o,0,...new Array(a).fill("").map((()=>({width:100})))),f.YR.setNodes(t,{columns:c},{at:d}),f.YR.insertNodes(t,new Array(a).fill("").map((e=>({type:"td",children:[{type:"p",children:[{text:""}]}]}))),{at:l})}))})),u.F3.focus(t)}function Gs(e){let{editor:t,target:n,isBelowInsert:r=!1,amount:a=1}=e;const o=js(t,Array.isArray(n)?n:u.F3.findPath(t,n)),{trIndex:l=0,tdCount:i=0,tablePath:s=[]}=o,c=l+(r?1:0),d=s.concat([c]),h=new Array(i).fill(""),p=new Array(a).fill("").map((()=>({type:"tr",children:h.map((()=>({type:"td",children:[{type:"p",children:[{text:""}]}]})))})));f.YR.insertNodes(t,p,{at:d}),u.F3.focus(t)}function Ks(e,t,n){const r=n||e.selection.anchor.path;t.forEach(((t,n)=>{let a=r.slice(0,-1);a=a.map(((e,t)=>t===a.length-1?e+n:e)),((e,t,n)=>{if((0,v.Ze)(t)){const r=js(e,n),{table:a,td:o,tdPath:l=[],tdIndex:i=0,trIndex:s=0,trCount:c=0,tdCount:d=0,tablePath:u=[]}=r,h=[...u,c-1,0],p=[...u,0,d-1],m=[...u,0,0];if(null!=a&&null!=e.selection){const n=t;if(null!=o&&null!=a){const t=n.children.length;let r=0;n.children.length>1&&(r=n.columns.length-n.children[0].children.length);const o=Math.abs(Math.min(i-r,0)),d=n.children[0].children.length+i-a.columns.length-o,u=t+s-c;f.ML.withoutNormalizing(e,(()=>{u>0&&Gs({editor:e,isBelowInsert:!0,target:h,amount:u}),d>0&&Ws({editor:e,isRightInsert:!0,amount:d,target:p}),o>0&&Ws({editor:e,amount:o,target:m});const t=l.slice(-2,-1)[0],a=l.slice(-1)[0];n.children.forEach(((n,i)=>{n.children.forEach(((n,s)=>{let c=a+s;0===i&&o&&(c+=o),i>0&&r>0&&(c=c+o-r);const d=[...l.slice(0,-2),t+i,Math.max(c,0)],u=f.ML.above(e,{at:[...d,0],match:v.Dx});let h=0;null!=u&&f.W_.isElement(u[0])&&(h=u[0].children.length-1),f.YR.insertFragment(e,n.children,{at:f.ML.range(e,[...d,0],[...d,h])})}))})),f.YR.select(e,[...l.slice(0,-2),t,a+o,0]),f.YR.collapse(e,{edge:"start"})}))}}else if(null==a&&null!=e.selection){const r=t;if(r.children.length>1){const e=r.columns.length;r.children.map(((t,n)=>{const r=e-t.children.length,a=new Array(r).fill("").map((e=>({type:"td",children:[{type:"p",children:[{text:""}]}]})));r>0&&0===n?t.children=[...a,...t.children]:r>0&&n>0&&(t.children=[...t.children,...a])}))}else r.columns=r.columns.slice(0,r.children[0].children.length);f.YR.insertNodes(e,r,{at:n})}}else{if(null==n)return;f.YR.insertNodes(e,t,{at:n})}})(e,t,a)}))}function $s(e,t){const{path:n}=Ys(e,"table",t);f.YR.removeNodes(e,{at:n})}function Qs(e,t){const n=u.F3.findPath(e,t),r=js(e,n);if(1===r.tdCount)return void $s(e,r.tablePath);const{table:a,tdIndex:o=0,trs:l=[],tablePath:i=[]}=r;f.ML.withoutNormalizing(e,(()=>{l.forEach(((t,n)=>{const r=i.concat([n,o]),l=null==a?void 0:a.columns.slice();null==l||l.splice(o,1),f.ML.hasPath(e,r)&&(f.YR.setNodes(e,{columns:l},{at:i}),f.YR.delete(e,{at:r}))}))})),u.F3.focus(e)}function Js(e,t){const n=js(e,u.F3.findPath(e,t)),{trIndex:r=0,tablePath:a=[]}=n;if(1===n.trCount)return void $s(e,n.tablePath);const o=a.concat([r]);f.ML.hasPath(e,o)&&f.YR.delete(e,{at:o}),u.F3.focus(e)}function Xs(e,t){const{tdIndex:n=0,tdCount:r=0,trIndex:a=0,trCount:o=0,tablePath:l=[]}=js(e);let i=n+t,s=a;if(!(t<0&&0===n&&0===a)){if(i>=r?(i=0,s++):i<0&&(i=r-1,s--),s>=o){Gs({editor:e,isBelowInsert:!0,target:[...l,o-1,0]})}f.YR.select(e,f.ML.start(e,[...l,s,i,0,0]))}}const ec=M({"mod+alt+t":(e,t)=>(ps.action(e,t),!0)}),tc=e=>e.selection?e.selection.focus.path:[0,0],nc=M({"mod+enter"(e){if(!e.selection)return!1;const t=Array.from(f.ML.nodes(e,{match:e=>(0,v.Ze)(e),at:e.selection})||[])[0][1],n=(0,m.OY)(e,t);return(0,m.Zt)(e,n)},"mod+shift+enter":e=>(Gs({editor:e,target:tc(e),isBelowInsert:!0}),!0),"mod+alt+enter":e=>(Ws({editor:e,target:tc(e)}),!0),"mod+alt+shift+enter":e=>(Ws({editor:e,isRightInsert:!0,target:tc(e)}),!0),"mod+backspace":e=>(Js(e,f.ML.node(e,tc(e))[0]),!0),"mod+alt+backspace":e=>(Qs(e,f.ML.node(e,tc(e))[0]),!0),"mod+shift+backspace":e=>($s(e),!0),tab:e=>(Xs(e,1),!0),"shift+tab":e=>(Xs(e,-1),!0),up(e){if(e.selection){var t;const a=window.getSelection(),o=null==a?void 0:a.getRangeAt(0),l=null==o?void 0:o.getBoundingClientRect(),i=null==o||null===(t=o.commonAncestorContainer.parentElement)||void 0===t?void 0:t.closest("[data-slate-node=element]"),s=null==i?void 0:i.getBoundingClientRect(),{trPath:c=[],tdPath:d=[],tablePath:u=[]}=js(e),h=f.ML.first(e,d),p=f.e6.includes(e.selection,h[1]),m=(null==s?void 0:s.top)||0,g=(null==l?void 0:l.top)||0;if(p&&(m+1>=g||null!=i&&i.outerHTML.includes("list-item"))){var n;const t=d;let a=f.ML.previous(e,{at:c}),o=[...(null===(n=a)||void 0===n?void 0:n[1])||[],t[t.length-1]];var r;if(0===c[1])a=f.ML.previous(e,{at:u}),o=[...(null===(r=a)||void 0===r?void 0:r[1])||[],0];const l=0===c[1]?f.ML.start(e,o):f.ML.end(e,o);return f.YR.setSelection(e,{anchor:l,focus:l}),!0}}return!1},down(e){if(e.selection){var t;const n=window.getSelection(),r=null==n?void 0:n.getRangeAt(0),a=null==r?void 0:r.getBoundingClientRect(),o=null==r||null===(t=r.commonAncestorContainer.parentElement)||void 0===t?void 0:t.closest("[data-slate-node=element]"),l=null==o?void 0:o.getBoundingClientRect(),{tdPath:i=[],trPath:s=[],trCount:c=0}=js(e),d=f.ML.last(e,i),u=f.e6.includes(e.selection,d[1]),h=(null==l?void 0:l.bottom)||0,p=(null==a?void 0:a.bottom)||0;if(u&&(h-1<=p||null!=o&&o.outerHTML.includes("list-item"))){const t=i;let n=[];if(s[1]>=c-1)n=f.ML.start(e,[s[0]+1]).path;else{const r=f.ML.next(e,{at:s});n=[...(null==r?void 0:r[1])||[],t[t.length-1],0,0];const a=Array.from(f.ML.nodes(e,{at:n})),o=!!a.filter((e=>f.W_.isElement(e[0])&&"list"===e[0].type)).length,l=!!a.filter((e=>f.W_.isElement(e[0])&&("markdown"===e[0].type||"code-block"===e[0].type))).length;(o||l)&&(n=[...a[a.length-1][1]])}return f.YR.setSelection(e,{anchor:{path:n,offset:0},focus:{path:n,offset:0}}),!0}}return!1}});function rc(e){const[t,n]=(0,r.useState)(!1),a=(0,r.useRef)(null),[o,l]=(0,r.useState)(0),{colGroupRef:i,colIndex:s,onResize:c}=e;return(0,r.useEffect)((()=>{if(t&&null!=i.current){const t=i.current.children[s],r=parseInt(t.style.width),l=e=>{n(!1),c(Math.max(Math.round(r+e.clientX-o),100))},d=n=>{0===n.buttons&&l(n);const i=Math.max(Math.round(r+n.clientX-o),100);t.style.width="".concat(i,"px"),null!=a.current&&(a.current.style.left="".concat(Math.round(e.left+i-r),"px"))};return document.addEventListener("mouseup",l),document.addEventListener("mousemove",d),()=>{document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",d)}}}),[t]),r.createElement("span",{className:"ghq-TableResizeHandle",style:{left:"".concat(e.left,"px")},"data-testid":"table-resizer-".concat(s),ref:a,contentEditable:!1,onMouseDown:e=>{e.preventDefault(),l(e.clientX),n(!0)}})}const ac=(0,r.createContext)(!1);function oc(){return oc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oc.apply(this,arguments)}function lc(e){let{attributes:t,children:n,element:a}=e;const o=P({attributes:t,element:a}),l=(0,u.GQ)(),i=(0,u.ui)(),s=u.F3.findPath(i,a),{table:c}=js(i,s),d=(0,r.useRef)(null),h=null!=i.selection&&f.y$.isDescendant(i.selection.anchor.path,s)&&f.y$.isDescendant(i.selection.focus.path,s),p=(null==c?void 0:c.columns)||[],m=Ye()(o.className,{"ghq-has-header":null==c?void 0:c.header,"ghq-read-only":l}),g=p.reduce(((e,t)=>{const n=(null==e?void 0:e[e.length-1])||0;return[...e,n+t.width]}),[]);return r.createElement("div",oc({},o,{className:"ghq-next-card-content__table-container"}),r.createElement("div",{className:"ghq-next-card-content__table-container-scroll"},r.createElement("table",{className:m},r.createElement("colgroup",{ref:d},a.columns.map(((e,t)=>r.createElement("col",{"data-testid":"table-col-".concat(t),key:"col-".concat(t),style:{width:e.width}})))),r.createElement(ac.Provider,{value:h},r.createElement("tbody",null,n))),!l&&g.map(((e,t)=>r.createElement(rc,{key:"resize-handle-".concat(t),left:e+48,colIndex:t,colGroupRef:d,onResize:e=>{!function(e,t,n,r){const[[a]]=Array.from(f.ML.nodes(e,{at:t,match:v.Ze})),o=a.columns.map(((e,t)=>t===n?{width:r}:e));f.YR.setNodes(e,{columns:o},{at:t}),u.F3.focus(e)}(i,s,t,e)}})))))}function ic(e){let{editor:t,element:n,contextPosition:a,onClose:o}=e;const l=(0,r.useRef)(null);return(0,r.useEffect)((()=>{const e=e=>{var t;null==e.target||e.target===l.current||null!==(t=l.current)&&void 0!==t&&t.contains(e.target)||o()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[l.current]),r.createElement(Sn.Z,null,r.createElement("div",{ref:l,style:{position:"fixed",...a},className:"ghq-CellContextMenu"},r.createElement(Wi.ZP,{ariaLabel:"Cell context menu"},r.createElement(Wi.sN,{icon:b.Z.ArrowUp,onClick:()=>{Gs({editor:t,target:n}),o()}},"Add row above"),r.createElement(Wi.sN,{icon:b.Z.ArrowDown,onClick:()=>{Gs({editor:t,isBelowInsert:!0,target:n}),o()}},"Add row below"),r.createElement(Wi.sN,{icon:b.Z.Delete,onClick:()=>{Js(t,n)}},"Delete row"),r.createElement(Wi.sN,{borderTop:!0,icon:b.Z.ArrowLeft,onClick:()=>{Ws({editor:t,target:n}),o()}},"Add column left"),r.createElement(Wi.sN,{icon:b.Z.ArrowRight,onClick:()=>{Ws({editor:t,isRightInsert:!0,target:n}),o()}},"Add column right"),r.createElement(Wi.sN,{icon:b.Z.Delete,onClick:()=>Qs(t,n)},"Delete column"))))}var sc=n(7230);function cc(e){let{element:t,editor:n}=e;return r.createElement(sc.Z,{trigger:r.createElement("button",{className:"ghq-ColumnDropdown","aria-label":"Open column context menu"},r.createElement(Qt.Z,{icon:b.Z.DotsHorizontal,size:"12"}))},r.createElement(Wi.ZP,{ariaLabel:"Column context menu"},r.createElement(Wi.sN,{icon:b.Z.ArrowLeft,onClick:()=>Ws({editor:n,target:t})},"Add column left"),r.createElement(Wi.sN,{icon:b.Z.ArrowRight,onClick:()=>Ws({editor:n,isRightInsert:!0,target:t})},"Add column right"),r.createElement(Wi.sN,{icon:b.Z.Delete,onClick:()=>Qs(n,t)},"Delete column")))}n(60285),n(41637);function dc(e,t){var n;const r=js(e,t),a=document.createElement("a"),o=null===(n=r.trs)||void 0===n?void 0:n.map((e=>e.children.map((e=>'"'.concat(e.children.map((e=>f.NB.string(e))).join("\r\n").replace(/"/g,'""'),'"'))).join(","))).join("\n");if(null!=o){const e=new Blob([o],{type:"text/csv;charset=utf-8;"});a.href=URL.createObjectURL(e),a.setAttribute("download","guru-table.csv"),a.click()}u.F3.focus(e)}function uc(e){var t;let{element:n,editor:a}=e;const o=u.F3.findPath(a,n),l=js(a,o);return r.createElement(sc.Z,{trigger:r.createElement("button",{className:"ghq-CornerDropdown","aria-label":"Open table context menu"},r.createElement(Qt.Z,{icon:b.Z.DotsHorizontal,size:"12"}))},r.createElement(Wi.ZP,{ariaLabel:"Table context menu"},r.createElement(Wi.sN,{icon:b.Z.TextColor,onClick:()=>{!function(e,t){var n;f.YR.setNodes(e,{header:!(null!==(n=t.table)&&void 0!==n&&n.header)},{at:t.tablePath}),u.F3.focus(e)}(a,l)}},!0===(null===(t=l.table)||void 0===t?void 0:t.header)?"Disable":"Enable"," header fill"),r.createElement(Wi.sN,{icon:b.Z.DownloadCsv,onClick:()=>{dc(a,l.tablePath)}},"Download as CSV"),r.createElement(Wi.sN,{icon:b.Z.Delete,onClick:()=>{f.YR.delete(a,{at:l.tablePath}),u.F3.focus(a)}},"Delete table")))}function hc(e){let{editor:t,element:n}=e;return r.createElement(sc.Z,{trigger:r.createElement("button",{className:"ghq-RowDropdown","aria-label":"Open row context menu"},r.createElement(Qt.Z,{icon:b.Z.DotsHorizontal,size:"12"}))},r.createElement(Wi.ZP,{ariaLabel:"Row context menu"},r.createElement(Wi.sN,{icon:b.Z.ArrowUp,onClick:()=>{Gs({editor:t,target:n})}},"Add row above"),r.createElement(Wi.sN,{icon:b.Z.ArrowDown,onClick:()=>{Gs({editor:t,isBelowInsert:!0,target:n})}},"Add row below"),r.createElement(Wi.sN,{icon:b.Z.Delete,onClick:()=>{Js(t,n)}},"Delete row")))}function pc(){return pc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},pc.apply(this,arguments)}function mc(e){let{attributes:t,children:n,element:a}=e;const o=(0,u._7)(),l=(0,u.GQ)(),i=(0,r.useContext)(ac),s=u.F3.findPath(o,a),c=js(o,s),{table:d}=c,h=(0,u.vt)(),{isFirstColumn:p,isFirstRow:m,isLastColumn:g,isLastRow:f}=a,v=P({attributes:t,element:a}),E=Ye()(v.className,{"ghq-is-first-row":m&&!l&&i,"ghq-is-last-column":g&&!l&&i,"ghq-is-last-row":f&&!l&&i,"ghq-is-first-column":p&&!l&&i,"ghq-is-header-filled":!0===(null==d?void 0:d.header)});(0,r.useEffect)((()=>{var e;const t=null===(e=v.ref)||void 0===e?void 0:e.current;if(h&&null!=t){const e=t.closest(".ghq-next-card-content__table-container-scroll"),n=t.getBoundingClientRect(),r=null==e?void 0:e.getBoundingClientRect(),a=n.left-((null==r?void 0:r.left)||0)-28,o=((null==r?void 0:r.right)||0)-n.right-28;o<0?null==e||e.scrollBy({left:Math.abs(o),behavior:"smooth"}):a<0&&(null==e||e.scrollBy({left:a,behavior:"smooth"}))}}),[h]);const[y,C]=(0,r.useState)();return r.createElement("td",pc({},v,{className:E,onContextMenu:e=>{const t=null!=e.target.closest("[contenteditable=false]");if(!l&&!t){e.preventDefault();let t=e.clientX,n=e.clientY;C({left:t,top:n})}}}),l&&m&&g&&i&&r.createElement($e,null,r.createElement(We.ZP,{icon:b.Z.DownloadCsv,aria:"Download as CSV",style:We.Dd.Standard,onClick:()=>{dc(o,c.tablePath)}})),!l&&i&&r.createElement("div",{contentEditable:!1,className:"ghq-table-ui-container"},!l&&null!=y&&r.createElement(ic,{editor:o,element:a,contextPosition:y,onClose:()=>C(void 0)}),m&&r.createElement(cc,{editor:o,element:a}),g&&r.createElement(hc,{editor:o,element:a}),m&&g&&r.createElement(uc,{editor:o,element:a})),n)}function gc(e){let{attributes:t,children:n,element:a}=e;return r.createElement("tr",P({attributes:t,element:a}),n)}function fc(e,t,n){f.ML.withoutNormalizing(e,(()=>{const r=!0===t.header;t.children.forEach(((a,o)=>{a.children.forEach(((l,i)=>{const s=0===i,c=0===o,d=a.children.length-1===i,u=t.children.length-1===o,h=[...n,o,i];f.ML.hasPath(e,h)&&(s!==l.isFirstColumn||l.isFirstRow!==c||l.isLastColumn!==d||(c||d)&&l.isHeaderEnabled!==r||u!==l.isLastRow)&&f.YR.setNodes(e,{isFirstColumn:s,isFirstRow:c,isLastColumn:d,isLastRow:u,isHeaderEnabled:r},{at:h})}))}))}))}function vc(){return vc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vc.apply(this,arguments)}const Ec=(e,t,n)=>{const{normalizeNode:a,insertFragment:o,deleteFragment:l}=t;return t.normalizeNode=e=>{const[n,r]=e;if((0,v.Ze)(n)){const e=f.ML.previous(t,{at:r}),a=f.ML.above(t,{match:v.Dx,at:r}),o=n.children.map((e=>e.children.length)).filter(((e,t,n)=>n.indexOf(e)===t)),l=Math.max(...o);if(1===n.children.length&&1===l)return void f.YR.unwrapNodes(t,{at:r,mode:"all",match:e=>(0,v.Dx)(e)||(0,v.N1)(e)||(0,v.Ze)(e)});if(null!=a&&(0,v.Ze)(n)){const e=f.ML.pathRef(t,r);return Ks(t,[n],r),void(e.current&&f.YR.removeNodes(t,{at:e.current}))}if(o.length>1)return void n.children.forEach(((e,n)=>{if(l>e.children.length){const a=l-e.children.length;f.YR.insertNodes(t,new Array(a).fill("").map((()=>({type:"td",children:[{type:"p",children:[{text:""}]}]}))),{at:0===n?[...r,n,0]:[...r,n,e.children.length]})}}));if((0,v.Ze)(n)&&r.length>1)return void f.YR.liftNodes(t,{at:r});null!=e&&(0,v.Ze)(e[0])&&f.YR.insertNodes(t,{type:"p",children:[{text:""}]},{at:r}),fc(t,n,r)}else if((0,v.Dx)(n)&&!n.children.every(v._x))return f.YR.removeNodes(t,{at:r}),void f.YR.insertNodes(t,{type:"td",children:[{type:"p",children:n.children.filter((e=>f.xv.isText(e)||f.W_.isElement(e)&&t.isInline(e)))}]},{at:r});return a(e)},t.insertFragment=e=>{const n=e.some(v.Ze);if(1===e.length&&(0,v.Ze)(e[0])&&1===e[0].children[0].children.filter((e=>""!==f.NB.string(e))).length){const t=e[0].children[0].children[0].children;return o(t)}return n?Ks(t,e):o(e)},t.deleteFragment=e=>{const{selection:n}=t;if(null!=n){const r=Array.from(f.ML.nodes(t,{match:e=>(0,v.Ze)(e),at:n})||[]),a=(0,m.OY)(t,n.anchor.path),o=(0,m.OY)(t,n.focus.path);if(null==a||!a.curr||null==o||!o.curr)return!1;if(r.length>0){const n=r[0][1];if(!((null==a?void 0:a.curr.path[0])>n[0]&&(null==o?void 0:o.curr.path[0])<n[0]||(null==a?void 0:a.curr.path[0])<n[0]&&(null==o?void 0:o.curr.path[0])>n[0]))return function(e,t){const{selection:n}=e;if(null==n)return;const r="forward"===t?f.ML.end(e,n):f.ML.start(e,n),a=f.ML.rangeRef(e,{anchor:r,focus:r});f.ML.withoutNormalizing(e,(()=>{Array.from(f.ML.nodes(e,{at:n,match:(e,t)=>(0,v.Dx)(e)||1===t.length&&!(0,v.Ze)(e)})).forEach((t=>{let[r,a]=t;if(f.ML.hasPath(e,a)){const t={anchor:f.ML.start(e,a),focus:f.ML.end(e,a)},r=f.e6.intersection(t,n);null!=r&&f.e6.isExpanded(r)&&Array.from(f.ML.nodes(e,{at:r})).length>0&&f.YR.delete(e,{at:r,hanging:!0})}}))})),null!=a.current&&f.YR.setSelection(e,a.current)}(t,e)}}return l(e)},{...e,editableProps:{...e.editableProps,onKeyDown:r=>{var a,o;(function(e,t,n){if(ua(t)){if((0,m.uH)(t))return!1;if(nc(e,t,n))return!0}else if(ec(e,t,n))return!0})(r,t,n)?r.preventDefault():null===(a=(o=e.editableProps).onKeyDown)||void 0===a||a.call(o,r)},renderElement:t=>{var n,a;const{element:o}=t;return"table"===o.type?r.createElement(lc,vc({},t,{element:o})):"tr"===o.type?r.createElement(gc,vc({},t,{element:o})):"td"===o.type?r.createElement(mc,vc({},t,{element:o})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},toolbarActions:[...e.toolbarActions,ps],serializeElement:(t,n)=>(0,v.Ze)(t)?((e,t)=>{const{header:n,columns:r,fullWidth:a}=e,o=r.map((e=>e.width)),l=(null==o?void 0:o.join(","))||"";return'<div class="ghq-card-content__table-responsive-wrapper"><div class="ghq-card-content__table-scroller"><table class="ghq-card-content__table" data-ghq-card-content-type="TABLE"'.concat(null!=a&&a.toString()?' data-ghq-card-content-is-full-width="'.concat(a,'"'):"").concat(null!=n&&n.toString()?' data-ghq-table-header="'.concat(n,'"'):"",' data-ghq-table-column-widths="').concat(l,'"><colgroup>').concat((()=>{const e=[];return null!=o&&o.length&&o.forEach((t=>{let n='<col style="width:'.concat(t,'px">');e.push(n)})),e})().join(""),'</colgroup><tbody class="ghq-card-content__table-body">').concat((0,O.F)(e.children,t),"</tbody></table></div></div>")})(t,n):(0,v.Dx)(t)?((e,t)=>(0,O.U)({node:e,classType:"table-cell",contentTypeValue:"TABLE_CELL",element:"td",serialize:t}))(t,n):(0,v.N1)(t)?((e,t)=>(0,O.U)({node:e,classType:"table-row",contentTypeValue:"TABLE_ROW",element:"tr",serialize:t}))(t,n):e.serializeElement(t,n),parseHtmlElement:t=>{if(Ee(t,"TABLE")||ve(t,"table")){const e=t,n=te(e),r=new RegExp(/data-ghq-table-header="((?:\\.|[^"\\])*)"/),a=e.outerHTML.match(r),o=!!a&&a[1].toLowerCase(),l=new RegExp(/data-ghq-card-content-is-full-width="(\w*)"/),i=e.outerHTML.match(l),s=i?i[1].toLowerCase():null;return{type:"table",columns:n,...o&&{header:JSON.parse(o)},...s&&{fullWidth:JSON.parse(s)},children:[{type:"tr",children:[{type:"td",children:[{type:"p",children:[{text:""}]}]}]}]}}return Ee(t,"TABLE_ROW")||ve(t,"tr")?{type:"tr",children:[]}:Ee(t,"TABLE_CELL")||ve(t,"td")||ve(t,"th")?{type:"td",children:[]}:e.parseHtmlElement(t)}}};function bc(){return bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},bc.apply(this,arguments)}var yc=n(50554);const Cc=M({"mod+b":e=>(h.$4.toggleMark(e,"bold",!0),!0),"mod+i":e=>(h.$4.toggleMark(e,"italic",!0),!0),"mod+shift+x":e=>(h.$4.toggleMark(e,"strikethrough",!0),!0),"mod+u":e=>(h.$4.toggleMark(e,"underline",!0),!0),"mod+shift+k":e=>(h.$4.toggleMark(e,"code",!0),!0),"mod+\\":e=>(h.$4.removeAllMarks(e),!0),"mod+e":e=>(h.$4.toggleMark(e,"highlight",!0),!0)}),Nc=(e,t,n)=>({...e,editableProps:{...e.editableProps,renderLeaf:e=>function(e){const{attributes:t,leaf:n}=e;let{children:a}=e;const o=!n.code&&void 0;return n.bold&&(a=r.createElement("strong",{className:"ghq-next-card-content__bold",spellCheck:o},a)),n.italic&&(a=r.createElement("em",{className:"ghq-next-card-content__italic",spellCheck:o},a)),n.underline&&(a=r.createElement("u",{className:"ghq-next-card-content__underline",spellCheck:o},a)),n.strikethrough&&(a=r.createElement("del",{className:"ghq-next-card-content__strikethrough",spellCheck:o},a)),n.color&&(a=r.createElement("span",{className:"ghq-next-card-content__text-color",spellCheck:o,style:{color:n.color}},a)),n.code&&(a=r.createElement("code",{className:"ghq-next-card-content__code-snippet",spellCheck:o},a)),n.highlight&&(a=r.createElement("mark",{className:"ghq-next-card-content__highlight",spellCheck:o,style:{backgroundColor:"#fde892"}},a)),n.codeSyntax&&(a=r.createElement("span",bc({},t,{spellCheck:!1}),r.createElement("span",{className:"prism-token token ".concat(n.tokenType)},a))),r.createElement("span",bc({},t,{spellCheck:o}),a)}(e),onKeyDown:r=>{var a,o;if(!Cc(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)}},serializeElement:(t,n)=>f.xv.isText(t)&&t.text?(0,yc.X)(t):e.serializeElement(t,n),parseHtmlElement:t=>{var n,r;const a=t,o=Ee(t,"paragraph")||ve(t,"p"),l=null==a||null===(n=a.innerHTML)||void 0===n?void 0:n.includes("<img"),i=null==a||null===(r=a.innerHTML)||void 0===r?void 0:r.includes("<iframe");if(ge(t)||me(t)||fe(t)||o||l||i)return e.parseHtmlElement(t);const s=Ae(a),c=(0,m.es)(a),d=Me(a);return"#text"!==a.nodeName&&("SPAN"!==a.nodeName||l||a.innerHTML.includes("<br")||a.innerHTML.includes("<a"))?"SPAN"===a.nodeName&&!l&&a.innerHTML.includes("<br")?{...s,...d.length>1&&{orderedMarks:d},text:(0,m.C0)(a)}:c&&!Oe(a)?{...s,...d.length>1&&{orderedMarks:d},...c[1],text:(0,m.C0)(a)}:"BR"===t.nodeName?{text:"\n"}:e.parseHtmlElement(t):{...s,...d.length>1&&{orderedMarks:d},text:a.textContent}}});function Tc(){return Tc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tc.apply(this,arguments)}const Sc=e=>{let{attributes:t,element:n,children:a}=e;const o={...t,"data-testid":"next-editor-title"};return r.createElement("h1",P({attributes:o,element:n}),a)},kc=M({tab(e){const t=(0,m.OY)(e);if(!t||!(0,m.aZ)({editor:e}))return!1;const{next:n}=t;return!!n&&(f.YR.select(e,n.path),f.YR.collapse(e,{edge:"end"}),!0)}}),xc=(e,t,n)=>({...e,editableProps:{...e.editableProps,onKeyDown:r=>{var a,o;if(!kc(r,t,n))return null===(a=(o=e.editableProps).onKeyDown)||void 0===a?void 0:a.call(o,r)},renderElement:t=>{var n,a;return"title"===t.element.type?r.createElement(Sc,Tc({},t,{element:t.element})):(null===(n=(a=e.editableProps).renderElement)||void 0===n?void 0:n.call(a,t))||r.createElement(u.Qr,t)}},serializeElement:(t,n)=>(0,v.gB)(t)?((e,t)=>(0,O.U)({node:e,classType:"title",contentTypeValue:"title",element:"h1",serialize:t}))(t,n):e.serializeElement(t,n)}),Lc=[Xo,Ts,Ec,hn,Te,st,hl,Dl,Nc,xc,bo,Wn,co,Et,ln,_l,Vs,Il,El];var _c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;e=de(e,!1),e=he(e);const n=document.createElement("div");return n.innerHTML=e,ia(n.childNodes,t)};var Ic=n(25108);const wc=[],Mc=e=>{let{content:t,pluginProps:n}=e,r=wc,a=!1;try{const e=(e=>{if("string"==typeof e)return e.replace(/\\n/gm,"\n").replace(/\\"/gm,'"')})(t);if(r=[..._c(e,n)],!Array.isArray(r)||!r.length)throw new Error}catch(e){Ic.error(e.stack),a=!0}return{editorValue:r,isError:a}};function Pc(){return Pc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pc.apply(this,arguments)}var Dc=e=>{let{content:t}=e;const n=Ta(Lc),{editor:a,editableProps:o}=n,{editorValue:l,isError:i}=Mc({content:le(t),pluginProps:n});return r.useEffect((()=>{a.children=l}),[l]),r.createElement("div",{className:"ghq-AssistWidgetReadOnlyEditor","aria-live":"polite"},i?r.createElement(fr.Z,{type:fr.N.Error},"Something went wrong while parsing the content. Please try again."):r.createElement(u.mH,{editor:a,value:l},r.createElement(u.CX,Pc({readOnly:!0,className:"ghq-slate-editor"},o))))};var Ac=e=>{let{isLoading:t,isError:n,content:a,error:o}=e;const{t:l}=(0,Kn.$G)(),s=Ye()("ghq-AssistWidgetContentContainer",{"ghq-is-loading":t,"ghq-is-error":n});return t?r.createElement("div",{className:s},r.createElement("div",{className:"ghq-AssistWidgetContentContainer__loader"},r.createElement(i.ZP,null,l("modals.assist.loading.bodyCopy")),r.createElement(Jt.ZP,{color:Jt.Cl.Marmalade,size:Jt.wx.Medium}))):n?r.createElement("div",{className:s},r.createElement(fr.Z,{type:fr.N.Error},null!==(c=null==o?void 0:o.message)&&void 0!==c?c:l("errors.somethingWentWrong"))):!a||gr()(a)?null:r.createElement("div",{className:s},r.createElement(Dc,{content:a}));var c},Oc=n(81371);var Rc=()=>{const{t:e}=(0,Kn.$G)();return r.createElement(Oc.ZP,{bold:!0,size:Oc.n8.Small,type:Oc.Rt.Jelly},e("singular.beta"))},Zc=n(80007);const qc="features.editor.assist.widget.loadingPromptText",Fc="features.editor.assist.widget.loadedPromptText",Bc=(e,t)=>t?(e=>{var t;return null!==(t=new Map([[Ui.ImproveSpellingAndGrammar,(0,Zc.Z)("".concat(qc,".improve.improveSpellingAndGrammar"))],[Ui.ImproveSimplifyVocab,(0,Zc.Z)("".concat(qc,".improve.improveSimplifyVocab"))],[Ui.ImproveRefineVocab,(0,Zc.Z)("".concat(qc,".improve.improveRefineVocab"))],[Ui.ImproveDecreaseLength,(0,Zc.Z)("".concat(qc,".improve.improveDecreaseLength"))],[Ui.SummarizeTLDR,(0,Zc.Z)("".concat(qc,".summarize.summarizeTLDR"))],[Ui.SummarizeParagraph,(0,Zc.Z)("".concat(qc,".summarize.summarizeParagraph"))],[Ui.SummarizeBulletedList,(0,Zc.Z)("".concat(qc,".summarize.summarizeBulletedList"))],[Ui.SummarizeNumberedList,(0,Zc.Z)("".concat(qc,".summarize.summarizeNumberedList"))],[Ui.ToneConversational,(0,Zc.Z)("".concat(qc,".adjustTone.toneConversational"))],[Ui.ToneDirect,(0,Zc.Z)("".concat(qc,".adjustTone.toneDirect"))],[Ui.ToneEmpathetic,(0,Zc.Z)("".concat(qc,".adjustTone.toneEmpathetic"))],[Ui.ToneProfessional,(0,Zc.Z)("".concat(qc,".adjustTone.toneProfessional"))],[Ui.ToneWitty,(0,Zc.Z)("".concat(qc,".adjustTone.toneWitty"))],[Ui.TranslateChinese,(0,Zc.Z)("".concat(qc,".translate.translateChinese"))],[Ui.TranslateEnglish,(0,Zc.Z)("".concat(qc,".translate.translateEnglish"))],[Ui.TranslateFrench,(0,Zc.Z)("".concat(qc,".translate.translateFrench"))],[Ui.TranslateGerman,(0,Zc.Z)("".concat(qc,".translate.translateGerman"))],[Ui.TranslateJapanese,(0,Zc.Z)("".concat(qc,".translate.translateJapanese"))],[Ui.TranslateSpanish,(0,Zc.Z)("".concat(qc,".translate.translateSpanish"))],[Ui.CustomPrompt,"Generating from your custom prompt..."]]).get(e))&&void 0!==t?t:(0,Zc.Z)("".concat(qc,".default"))})(e):(e=>{var t;return null!==(t=new Map([[Ui.ImproveSpellingAndGrammar,(0,Zc.Z)("".concat(Fc,".improve.improveSpellingAndGrammar"))],[Ui.ImproveSimplifyVocab,(0,Zc.Z)("".concat(Fc,".improve.improveSimplifyVocab"))],[Ui.ImproveRefineVocab,(0,Zc.Z)("".concat(Fc,".improve.improveRefineVocab"))],[Ui.ImproveDecreaseLength,(0,Zc.Z)("".concat(Fc,".improve.improveDecreaseLength"))],[Ui.SummarizeTLDR,(0,Zc.Z)("".concat(Fc,".summarize.summarizeTLDR"))],[Ui.SummarizeParagraph,(0,Zc.Z)("".concat(Fc,".summarize.summarizeParagraph"))],[Ui.SummarizeBulletedList,(0,Zc.Z)("".concat(Fc,".summarize.summarizeBulletedList"))],[Ui.SummarizeNumberedList,(0,Zc.Z)("".concat(Fc,".summarize.summarizeNumberedList"))],[Ui.ToneConversational,(0,Zc.Z)("".concat(Fc,".adjustTone.toneConversational"))],[Ui.ToneDirect,(0,Zc.Z)("".concat(Fc,".adjustTone.toneDirect"))],[Ui.ToneEmpathetic,(0,Zc.Z)("".concat(Fc,".adjustTone.toneEmpathetic"))],[Ui.ToneProfessional,(0,Zc.Z)("".concat(Fc,".adjustTone.toneProfessional"))],[Ui.ToneWitty,(0,Zc.Z)("".concat(Fc,".adjustTone.toneWitty"))],[Ui.TranslateChinese,(0,Zc.Z)("".concat(Fc,".translate.translateChinese"))],[Ui.TranslateEnglish,(0,Zc.Z)("".concat(Fc,".translate.translateEnglish"))],[Ui.TranslateFrench,(0,Zc.Z)("".concat(Fc,".translate.translateFrench"))],[Ui.TranslateGerman,(0,Zc.Z)("".concat(Fc,".translate.translateGerman"))],[Ui.TranslateJapanese,(0,Zc.Z)("".concat(Fc,".translate.translateJapanese"))],[Ui.TranslateSpanish,(0,Zc.Z)("".concat(Fc,".translate.translateSpanish"))],[Ui.CustomPrompt,"Custom prompt"]]).get(e))&&void 0!==t?t:(0,Zc.Z)("".concat(Fc,".default"))})(e);var Hc=e=>{var t;let{action:n,isError:a,isLoading:o,isSuccess:l,isTruncated:i,suggestionId:s,onClose:c}=e;const{t:d}=(0,Kn.$G)(),{hasSelectedContent:u}=lr(),{card:h,collectionId:p}=(0,Pn.RC)(),m=null===(t=h.editFact.data)||void 0===t?void 0:t.id,{getTrackEventData:g}=er(),f=Ye()("ghq-AssistWidgetHeader",{"ghq-is-error":a,"ghq-is-loading":o}),v=a?$t.ZP.Fruitpunch:$t.ZP.Marmalade,E={activitySubtype:Xn.EditorAssistWidget,cardId:m,collectionId:p,hasSelectedContent:u,suggestionId:s};return r.createElement("div",{className:f},r.createElement(hr.MM,{appendage:r.createElement(We.ZP,{aria:d("modals.assist.aria.close"),style:We.Dd.Standard,icon:b.Z.Close,trackEvent:g({name:ir.default.AI_ASSIST_GENERATE_DISCARD_BUTTON_CLICKED,isSuccess:l,isTruncated:i,...E}),onClick:c})},r.createElement(Qt.Z,{icon:b.Z.SuggestionOutlined,color:v,size:32}),r.createElement("div",{className:"ghq-AssistWidgetHeader__details"},r.createElement("div",{className:"ghq-AssistWidgetHeader__title"},r.createElement(Zo.ZP,{level:Zo.Yx.H2,style:Zo.VH.Large},d("modals.assist.heading")),r.createElement(Rc,null)),r.createElement(Ht.Z,null,Bc(n,o)))))};const Uc=new(n(50036).Z)({headingStyle:"atx"}),zc=e=>Uc.turndown((e=>{const t=document.createElement("div");return t.innerHTML=e,Array.from(t.querySelectorAll("li + ul")).map((e=>{var t;return null===(t=e.previousElementSibling)||void 0===t?void 0:t.appendChild(e)})),Array.from(t.querySelectorAll("li + ol")).map((e=>{var t;return null===(t=e.previousElementSibling)||void 0===t?void 0:t.appendChild(e)})),t.innerHTML})(e));let Vc;!function(e){e.TopOfCard="top-of-card",e.BelowSelection="below-selection",e.Selection="selection"}(Vc||(Vc={}));const Yc=(e,t)=>{const n=f.NB.get(e,t.path);f.xv.isText(n)&&""===n.text&&f.YR.removeNodes(e,{at:t})};var jc=n(54442);const Wc=e=>{var t,n,o,l,i,s,d,h,p;let{pluginProps:m}=e;const{card:g,collectionId:v}=(0,Pn.RC)(),E=null===(t=g.editFact.data)||void 0===t?void 0:t.id,b=(0,Gt.y)(),y=null!==(n=null===(o=b.contextState.popoverData)||void 0===o||null===(l=o.actions)||void 0===l?void 0:l[0])&&void 0!==n?n:void 0,C=(0,u._7)(),N=ji(),{plaintextContent:T,hasSelectedContent:S,nodesForGenerativeActions:k}=lr(),{serializeElement:x}=m,L=()=>{var e;const{actions:t,customPrompt:n}=null!==(e=b.contextState.popoverData)&&void 0!==e?e:{};if(!E||!t)return;const r=t.includes(Ui.CustomPrompt);let a="";if(o=t[0],Object.values(Fi).includes(o))a=T;else{const e=k.map((e=>x(e,x))).join("");a=r?"".concat(n,":").concat(zc(e)):zc(e)}var o;N.mutate({collectionId:v,cardId:E,actions:r?[]:t,promptIncluded:r,content:a})};r.useEffect((()=>{L()}),[]);const _=()=>{b.setContextState((e=>({...e,popoverMode:"default",popoverData:{...e.popoverData,actions:void 0}}))),u.F3.focus(C)},{containerRef:I}=(0,jc.Z)({shouldTrapFocus:!0,onEscape:()=>{_()}}),w=e=>{var t;const{editorValue:n,isError:r}=Mc({content:null===(t=N.data)||void 0===t?void 0:t.content,pluginProps:m});if(r)return _();const a=n;if(null==a||!a.length)return _();switch(e){case Vc.TopOfCard:(e=>{let{editor:t,nodes:n}=e;t&&(f.YR.insertNodes(t,n,{at:[1]}),f.YR.select(t,{anchor:f.ML.start(t,[1]),focus:f.ML.end(t,[n.length])}))})({editor:C,nodes:a});break;case Vc.BelowSelection:S&&(e=>{var t,n,r,a;let{editor:o,nodes:l}=e;if(!o.selection)return;const i=f.e6.end(o.selection),s=(null===(t=o.selection)||void 0===t?void 0:t.anchor.offset)<(null===(n=o.selection)||void 0===n?void 0:n.focus.offset)?null===(r=o.selection)||void 0===r?void 0:r.focus:null===(a=o.selection)||void 0===a?void 0:a.anchor;f.YR.insertNodes(o,l,{at:i,select:!0}),Yc(o,i),f.YR.select(o,{anchor:s,focus:o.selection.focus})})({editor:C,nodes:a});break;case Vc.Selection:S&&(e=>{let{editor:t,nodes:n}=e;if(!t.selection)return;const r=t.selection,a=f.e6.start(r);let o;f.YR.insertNodes(t,n,{select:!0}),o=a;const l=f.NB.get(t,a.path);if(!f.xv.isText(l)){const e=f.ML.nodes(t,{at:a,match:f.xv.isText});o={path:Array.from(e)[0][1],offset:0}}f.YR.select(t,{anchor:o,focus:f.ML.end(t,t.selection)}),Yc(t,o)})({editor:C,nodes:a})}_()};return r.createElement(a.Z,{id:a.J.assistWidget,render:()=>r.createElement(c,null)},r.createElement("div",{className:"ghq-AssistWidget",ref:I},r.createElement(hr.ZP,{scrollable:!0,modifier:hr.QV.Bordered},r.createElement(Hc,{action:y,isError:N.isError,isLoading:N.isLoading,isSuccess:N.isSuccess,isTruncated:!(null===(i=N.data)||void 0===i||!i.truncated),suggestionId:null===(s=N.data)||void 0===s?void 0:s.suggestionId,onClose:_}),r.createElement(Ac,{isLoading:N.isLoading,isError:N.isError,content:null===(d=N.data)||void 0===d?void 0:d.content,error:N.error}),r.createElement(pr,{isError:N.isError,isLoading:N.isLoading,isSuccess:N.isSuccess,isTruncated:!(null===(h=N.data)||void 0===h||!h.truncated),suggestionId:null===(p=N.data)||void 0===p?void 0:p.suggestionId,onAddBelowSelection:()=>w(Vc.BelowSelection),onAddToTop:()=>w(Vc.TopOfCard),onClose:_,onReplaceSelection:()=>w(Vc.Selection),onRetry:L}))))};var Gc=e=>{let{pluginProps:t}=e;return"guruAIAssist"!==(0,Gt.y)().contextState.popoverMode?null:r.createElement(Wc,{pluginProps:t})};const Kc=[Xo,Ts,Ec,hn,Te,st,hl,Dl,Nc,xc,bo,Wn,co,Et,ln,_l,Vs,Il,El,(e,t)=>({...e,renderOutside:()=>r.createElement(Gc,{pluginProps:e})})];var $c=e=>{let{shown:t,message:n,className:a,target:o,editor:l}=e;if(!t)return r.createElement("noscript",null);let i=null;try{i=u.F3.toDOMNode(l,o)}catch(e){return r.createElement("noscript",null)}const s=i.closest(".ghq-next-fact-editor__editor"),c=s?parseFloat(getComputedStyle(s).paddingTop):25,d=s?parseFloat(getComputedStyle(s).paddingLeft):25;let h=c;if(a.includes("p")){var p;const e=null==s||null===(p=s.firstElementChild)||void 0===p?void 0:p.firstElementChild;if(e){const t=e.getBoundingClientRect().height+parseFloat(getComputedStyle(e).marginBottom);h+=t<76?60:t}else h+=60}else h+=12;const m={position:"absolute",top:h,left:i.offsetLeft+d,height:i.offsetHeight,maxWidth:i.offsetWidth},g=Ye()("ghq-next-fact-editor__content-placeholder",a);return r.createElement("div",{className:g,style:m,"data-testid":"editor-placeholder"},r.createElement("span",{dangerouslySetInnerHTML:{__html:ne.Z.getRawHTML(n)}}))},Qc=n(91572);function Jc(){return Jc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Jc.apply(this,arguments)}const Xc=e=>{var t,n,a,o;let{editableProps:l,isTemplate:i,isMultiplayer:s,readOnly:c}=e;const d=(0,u.ui)();if(!(((null==d||null===(t=d.sharedRoot)||void 0===t?void 0:t.length)||0)>0)&&s)return r.createElement("div",{className:"ghq-next-fact-editor__loading"},r.createElement(Jt.ZP,{size:Jt.wx.Medium}));const h=null===(n=d.children)||void 0===n?void 0:n[0],p=null==h||null===(a=h.children)||void 0===a?void 0:a[0],m=""===(null==p?void 0:p.text),g=null===(o=d.children)||void 0===o?void 0:o.slice(1),v=!g.some((e=>f.W_.isElement(e)&&!f.ML.isEmpty(d,e)||f.W_.isElement(e)&&"p"!==e.type)),E=!!Qc.Z.isEdge()||!c;return r.createElement("div",{className:"ghq-next-fact-editor__editor ghq-next-fact-editor"},r.createElement(u.CX,Jc({spellCheck:!0,autoFocus:!0,readOnly:c,className:Ye()("ghq-slate-editor",{notranslate:E})},l)),!c&&h&&r.createElement(r.Fragment,null,r.createElement($c,{message:"Enter a Title",editor:d,target:h,shown:m,className:"ghq-next-fact-editor__title"}),r.createElement($c,{message:i?"Use this area to set the stage for the styling of this Card Template. \n Authors may elect to make changes to these styles when creating Cards from this Template.":"Type away! You can also type `/` for Quick Commands",shown:v,editor:d,target:g[0],className:"ghq-next-card-content__p"})))};function ed(){const[,e]=(0,r.useReducer)((e=>e+1),0),t=(0,r.useRef)(null),n=()=>{t.current&&(cancelAnimationFrame(t.current),t.current=0)};return(0,r.useEffect)(n),(0,r.useEffect)((()=>n),[]),(0,r.useCallback)((function(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n?e():t.current||(t.current=requestAnimationFrame(e))}),[])}function td(e,t){const n=(0,r.useRef)(t);n.current=t;const[a]=(0,r.useState)((()=>new ResizeObserver((()=>{n.current()}))));(0,r.useEffect)((()=>{if(null==e||!e.current)return;const{current:t}=e;return a.observe(t),()=>a.unobserve(t)}),[a,e])}const nd=new WeakMap;function rd(e,t){if(!t.relativeSelection)return null;let n=nd.get(e.children);n||(n=new WeakMap,nd.set(e.children,n));let r=n.get(t);return void 0===r&&(r=(0,vr.$P)(e.sharedRoot,e,t.relativeSelection),n.set(t,r)),r}function ad(e,t,n){let{yOffset:r,xOffset:a,shouldGenerateOverlay:o}=n;const[l,i]=f.e6.edges(t),s=u.F3.toDOMRange(e,t),c=[],d=f.ML.nodes(e,{at:t,match:(e,t)=>f.xv.isText(e)&&(!o||o(e,t))});let h=null;const p=f.e6.isBackward(t);for(const[n,o]of d){const d=u.F3.toDOMNode(e,n),m=f.y$.equals(o,l.path),g=f.y$.equals(o,i.path);let v=null;if(m||g){const e=document.createRange();e.selectNode(d),m&&e.setStart(s.startContainer,s.startOffset),g&&e.setEnd(s.endContainer,s.endOffset),v=e.getClientRects()}else v=d.getClientRects();const E=p?m:g;for(let e=0;e<v.length;e++){const n=v.item(e);if(!n)continue;const o=E&&(p?0===e:e===v.length-1),l=n.top-r,i=n.left-a;o&&(h={height:n.height,top:l,left:i+(p||f.e6.isCollapsed(t)?0:n.width)}),c.push({width:n.width,height:n.height,top:l,left:i})}}return{selectionRects:c,caretPosition:h}}const od=Object.freeze([]);function ld(){return ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ld.apply(this,arguments)}function id(e){let{caretPosition:t,data:n}=e;const a={...t};return n?r.createElement("div",{style:a,className:"ghq-MultiplayerCursor__caret a11y-color-combo--".concat(n.color)},r.createElement("div",{className:"ghq-MultiplayerCursor__label a11y-color-combo--".concat(n.color)},null==n?void 0:n.firstName," ",null==n?void 0:n.lastName)):null}function sd(e){let{data:t,selectionRects:n,caretPosition:a}=e;return t?r.createElement(r.Fragment,null,n.map(((e,n)=>r.createElement("div",{style:{...e},className:"ghq-RemoteSelection a11y-color-combo--".concat(t.color),key:"".concat(t.id,"-").concat(n)}))),a&&r.createElement(id,{caretPosition:a,data:t})):null}function cd(e){let{containerRef:t}=e;const n=function(){var e;let{containerRef:t,shouldGenerateOverlay:n,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const o=(0,u._7)(),l=(0,Or.D)((e=>e.setCursors));if(!vr._5.isCursorEditor(o))throw new Error("Cannot use useSyncExternalStore outside the context of a RemoteCursorEditor");const i=ed(),[s,c]=(0,r.useState)([]);(0,r.useEffect)((()=>(l(s.filter((e=>null!=e&&null!=e.data)).map((e=>e.data))),()=>{l([])})),[s]),(0,r.useEffect)((()=>{const e=e=>{const{added:t,updated:n,removed:r}=e;t.length>0&&c((e=>e.concat(t.map((e=>vr._5.cursorState(o,e)))))),r.length>0&&c((e=>e.filter((e=>!r.includes(e.clientId))))),n.length>0&&c((e=>{const t=e.map((e=>e.clientId)),r=n.filter((e=>t.includes(e))),a=n.filter((e=>!t.includes(e)));let l=e;return a.length>0&&(l=l.concat(a.map((e=>vr._5.cursorState(o,e))))),r.length>0&&(l=l.map((e=>r.includes(e.clientId)?vr._5.cursorState(o,e.clientId):e))),l}))};return vr._5.on(o,"change",e),()=>vr._5.off(o,"change",e)}),[]);const d=(0,r.useRef)(new WeakMap),[h,p]=(0,r.useState)({}),m=!("refreshOnResize"in a)||null===(e=a.refreshOnResize)||void 0===e||e;td(m?t:void 0,(()=>{d.current=new WeakMap,i("debounced"!==m)})),(0,r.useLayoutEffect)((()=>{var e,r,a;if(t&&!t.current)return;const l=null==t||null===(e=t.current)||void 0===e?void 0:e.getBoundingClientRect(),i=null!==(r=null==l?void 0:l.x)&&void 0!==r?r:0,c=null!==(a=null==l?void 0:l.y)&&void 0!==a?a:0;let u=Object.keys(h).length!==Object.keys(s).length;const m=Object.fromEntries(Object.entries(s).map((e=>{let[t,r]=e;const a=r.relativeSelection&&rd(o,r);if(!a)return[t,od];const l=d.current.get(a);if(l)return[t,l];const s=ad(o,a,{xOffset:i,yOffset:c,shouldGenerateOverlay:n});return u=!0,d.current.set(a,s),[t,s]})));u&&p(m)}));const g=(0,r.useMemo)((()=>Object.entries(s).map((e=>{var t,n;let[r,a]=e;const l=a.relativeSelection&&rd(o,a),i=h[r];return{...a,range:l,caretPosition:null!==(t=null==i?void 0:i.caretPosition)&&void 0!==t?t:null,selectionRects:null!==(n=null==i?void 0:i.selectionRects)&&void 0!==n?n:od}}))),[s,o,h]);return g}({containerRef:t});return r.createElement(r.Fragment,null,n.map(((e,t)=>r.createElement(sd,ld({key:e.clientId},e)))))}function dd(e){let{containerRef:t}=e;const{provider:n,isBootstrapping:a}=(0,Or.D)();return n&&!a?r.createElement(cd,{containerRef:t}):null}var ud=n(57645);function hd(){const e=wi.map(((e,t)=>{const{label:n,keyboardCommand:a}=e;return r.createElement(gd,{key:t,label:n,commands:a})})),t=di.map(((e,t)=>{const{label:n,keyboardCommand:a}=e;return r.createElement(gd,{key:t,label:n,commands:a})})),n=xi.map(((e,t)=>{const{label:n,keyboardCommand:a}=e;return r.createElement(gd,{key:t,label:n,commands:a})})),a=Ei.map(((e,t)=>{const{label:n,keyboardCommand:a}=e;return r.createElement(gd,{key:t,label:n,commands:a})})),o=Mi.map(((e,t)=>{const{label:n,keyboardCommand:a}=e;return r.createElement(gd,{key:t,label:n,commands:a})}));return r.createElement(ud.x,{id:"keyboard-shortcuts"},r.createElement(fd,{label:"General"},e),r.createElement(fd,{label:"Format"},t),r.createElement(fd,{label:"Style"},a),r.createElement(fd,{label:"Insert"},n),r.createElement(fd,{label:"Table"},o))}function pd(){const e=di.filter((e=>e.markdownCommand)).map(((e,t)=>{const{label:n,markdownCommand:a}=e;return r.createElement(gd,{key:t,label:n,commands:a})})),t=xi.filter((e=>e.markdownCommand)).map(((e,t)=>{const{label:n,markdownCommand:a}=e;return r.createElement(gd,{key:t,label:n,commands:a})})),n=Ei.filter((e=>e.markdownCommand)).map(((e,t)=>{const{label:n,markdownCommand:a}=e;return r.createElement(gd,{key:t,label:n,commands:a})}));return r.createElement(ud.x,{id:"markdown-shortcuts"},r.createElement(fd,{label:"Format"},e),r.createElement(fd,{label:"Style"},n),r.createElement(fd,{label:"Insert"},t))}function md(e){let{last:t,children:n}=e;return r.createElement("span",{className:"ghq-next-fact-editor-guide-shortcut-command"},r.createElement("span",{className:"ghq-next-fact-editor-guide-shortcut-command__highlighted"},n),r.createElement("span",{className:"ghq-next-fact-editor-guide-shortcut-command__plus"},t?"":"+"))}function gd(e){let{label:t,commands:n}=e;const a=n.map(((e,t)=>r.createElement(md,{key:t,last:t===n.length-1},e)));return r.createElement("div",{className:"ghq-next-fact-editor-guide-shortcut"},t,r.createElement("div",{className:"ghq-next-fact-editor-guide-shortcut__commands"},a))}function fd(e){let{label:t,children:n}=e;return r.createElement("div",{className:"ghq-next-fact-editor-guide-shortcuts ghq-card-content"},r.createElement("div",{className:"ghq-next-fact-editor-guide-shortcuts__label"},t),n)}var vd=e=>{let{onClose:t,className:n}=e;const[a,o]=r.useState("keyboard-shortcuts"),l=[{id:"keyboard-shortcuts",content:r.createElement("span",null,"Shortcuts")},{id:"markdown-shortcuts",content:r.createElement("span",null,"Markdown")}],i=Ye()("ghq-next-fact-editor-guide",n);return r.createElement("div",{className:i,onMouseDown:e=>{e.preventDefault()}},r.createElement(Nn.Z,{tooltipped:{message:"Close Guide"},className:"ghq-next-fact-editor-guide__close",icon:"close-arrow-right",size:20,onClick:t}),r.createElement("div",{className:"ghq-next-fact-editor-guide__title"},"Help Guide"),r.createElement(ud.m,{activeTab:a,tabs:l,onChange:e=>{o(e)}},r.createElement(hd,null),r.createElement(pd,null)))};var Ed=(e,t)=>e?r.createElement(jl.default,{unmountOnExit:!0,timeout:{enter:0,exit:500}},(e=>r.createElement(vd,{className:"ghq-is-".concat(e),onClose:t}))):null,bd=n(45429),yd=n(64519);var Cd=n(80028);var Nd=(e,t)=>{try{if((0,or.Aw)("At the top of initializeNextEditorValue."),!(e=>!!e.data)(e)){if((0,or.Aw)("We are looking at a PreviewFact."),!t)throw new Error("Cannot properly initialize Card preview content without a pluginProps argument.");return(0,or.Aw)("Parsing HTML content field into expected JSON value."),{value:[{type:"title",children:[{text:e.preferredPhrase}]},..._c(e.content,t)],entities:{}}}(0,or.Aw)("We are looking at a BaseFact.");const{editFact:{data:a},editorSession:{drafts:o,editingDraftId:l}={},isNew:i,meta:{createdFromTemplateGallery:s,contentFromTemplate:c}={}}=e;if(!a)throw new Error("Cannot properly initialize Card content without editFact.data.");const d=bd.C.isViewUnpublished({fact:e})&&o&&l,u=(d?o[l].contentSchemaVersion:null)===Cd.Z,h=s||c;if(a.contentSchemaVersion!==Cd.Z&&!i||d&&!u||h){if((0,or.Aw)("We need to run this Card through conversion."),!t)throw new Error("Cannot convert Card content without a pluginProps argument.");if(d&&(0,or.Aw)("We are converting a Draft."),h&&(0,or.Aw)("We are converting a Template derivative."),(0,or.Aw)("Parsing HTML content field into expected JSON format."),d&&!o[l])throw new Error("Trying to convert draft but draft does not seem to exist.");let e=a.preferredPhrase,n=a.content;const r=n&&n!==(null==c?void 0:c.content);return d?(e=o[l].title,n=o[l].content):c&&!r&&(e=c.cardTitle,n=c.content),{value:[{type:"title",children:[{text:e||""}]},..._c(n,t)],entities:{}}}if((0,or.Aw)("This Card does not need to be converted."),i&&!a.preferredPhrase&&!e.clipperURLSource)return(0,or.Aw)("This is a new Card - returning default value."),{value:yd.L,entities:{}};if(e.clipperURLSource&&e.data.content)return(0,or.Aw)("This Card is being populated via the Knowledge Clipper"),{value:[{type:"title",children:[{text:""}]},..._c(e.data.content,t)],entities:{}};if(!a.jsonContent&&a.preferredPhrase&&!a.content)return(0,or.Aw)("This is a Question - returning Card title and default content."),{value:[{type:"title",children:[{text:a.preferredPhrase||""}]},(0,Dr.c)()],entities:{}};if(!a.jsonContent){if((0,or.Aw)("This Card does not have a jsonContent field defined."),!t)throw new Error("Cannot parse Card content from Card without `jsonContent` field without a pluginProps argument");return(0,or.Aw)("Parsing HTML content field into expected JSON format."),{value:[{type:"title",children:[{text:a.preferredPhrase||""}]},..._c(a.content,t)],entities:{}}}if(a.jsonContent.includes('"object":"value"'))return(0,or.Aw)("This card is on the latest schema version, but its jsonContent appears to be on the legacy format. Trying to parse content instead."),{value:[{type:"title",children:[{text:a.preferredPhrase||""}]},..._c(a.content,t)],entities:{}};{var n;(0,or.Aw)("This Card is perfect just the way it is - returning jsonContent field.");const e=JSON.parse(a.jsonContent),o=(r=(e=>e.value.map((e=>("markdown"===e.type&&0===e.children.length?e.children=[{type:"markdown-line",children:[{text:""}]}]:"table"===e.type&&e.children.map((t=>{t.children.map((t=>{"td"===t.type&&0===t.children.length?t.children=[{type:"p",children:[{text:""}]}]:"td"===t.type&&t.children.map(((t,n)=>{"table"===t.type?e=t:"markdown"===t.type&&0===t.children.length&&(t.children=[{type:"markdown-line",children:[{text:""}]}])}))}))})),e))))(e),(0,m.fw)(r,(e=>{if((0,v.jI)(e)){const t=e;(0,da.TG)(t.url)&&(t.url=(0,da.x5)(t.url))}})),r);return 0===Object.keys(e.entities).length&&Object.keys(e.entities).length!==(null===(n=a.attachments)||void 0===n?void 0:n.length)&&a.content?((0,or.Aw)("This Card has been converted, but has an empty entities object. Trying to parse content instead."),{value:[{type:"title",children:[{text:a.preferredPhrase||""}]},..._c(a.content,t)],entities:{}}):{value:o,entities:e.entities}}}catch(t){throw new Error("Error processing initializeNextEditorValue for card id ".concat(e.id,": ").concat(t))}var r};const Td=e=>{const{selection:t}=e;if(!t)return;const n={path:t.anchor.path,offset:0},r={path:t.focus.path,offset:0};f.YR.delete(e,{at:t.anchor.path}),f.YR.setSelection(e,{anchor:n,focus:r})},Sd=(e,t,n)=>[{name:"Paragraph",icon:b.Z.FormatParagraph,onSelect:()=>(Td(e),h.$4.setParagraph(e))},{name:"Large Heading",icon:b.Z.FormatHeader1,aliases:["h1","Heading 1"],onSelect:()=>(Td(e),h.$4.toggleHeading(e,1))},{name:"Medium Heading",icon:b.Z.FormatHeader2,aliases:["h2","Heading 2"],onSelect:()=>(Td(e),h.$4.toggleHeading(e,2))},{name:"Small Heading",icon:b.Z.FormatHeader3,aliases:["h3","Heading 3"],onSelect:()=>(Td(e),h.$4.toggleHeading(e,3))},{name:"Numbered List",icon:b.Z.FormatListNumbered,onSelect:()=>(Td(e),L.action(e,n))},{name:"Bulleted List",icon:b.Z.FormatListBulleted,onSelect:()=>(Td(e),x.action(e,n))},{name:"Block Quote",icon:b.Z.FormatQuote,aliases:["quote"],onSelect:()=>(Td(e),h.$4.setBlockQuote(e))},{name:"Code Block",icon:b.Z.Code,onSelect:()=>{Td(e),He.action(e,n)}},{name:"Video",icon:b.Z.Video,onSelect:()=>(Td(e),Cs.action(e,n))},{name:"Table",icon:b.Z.IconTable,onSelect:()=>(Td(e),ps.action(e,n))},{icon:b.Z.Link,name:"Link",onSelect:()=>(Td(e),cl.action(e,n))},{name:"File",icon:b.Z.Clip,aliases:["attachment"],onSelect:()=>(Td(e),Yn.action(e,n))},{name:"Image",icon:b.Z.Photo,aliases:["picture"],onSelect:()=>(Td(e),$o.action(e,n))},{icon:b.Z.Guru,name:"Guru Card",onSelect:()=>(Td(e),io.action(e,n))},{name:"Divider",icon:b.Z.HorizontalRule,aliases:["horizontal rule"],onSelect:()=>(Td(e),ht.action(e,n))},{name:"Iframe",icon:b.Z.EmbedIframe,onSelect:()=>(Td(e),an.action(e,n))},{name:"Markdown",icon:b.Z.InsertCustomHtml,onSelect:()=>(Td(e),bl.action(e,n))},{name:"Toggle Help Guide",icon:b.Z.Shortcuts,onSelect:()=>(Td(e),t())}];var kd;const xd="UP",Ld="DOWN",_d="KEYDOWN",Id={className:jt().string,defaultHighlightedIndex:jt().any,selectable:jt().bool,focusable:jt().bool,embedded:jt().bool,stickyHover:jt().bool,noArrowKeys:jt().bool,selected:jt().bool,highlighted:jt().bool,highlightedBy:jt().string,style:jt().object,onLockParentMenu:jt().func,onUnlockParentMenu:jt().func,onExitMenuTop:jt().func,onExitMenuBottom:jt().func};var wd=(0,Ma.Z)(((kd=class extends r.Component{constructor(e){super(e),this.componentDidUpdate=()=>{const{highlighted:e,selectable:t,embedded:n,selectableIndex:r,defaultHighlightedIndex:a,parentIsLocked:o,onLockParentMenu:l}=this.props,{highlightedIndex:i,locked:s}=this.state,c=t?e:!s;if(n&&t&&!e&&-1!==i&&this.setState({highlightedIndex:-1}),c&&!this.highlightedTargetExists(i)){if(i===a)return;n?(a===Ld&&this.setState({highlightedIndex:0}),a===xd&&this.setState({defaultHighlightedIndex:this.getLastSelectableIndex()})):this.setState({highlightedIndex:a})}t&&e&&!o&&l(r)},this.highlightedTargetExists=e=>{const{children:t}=this.props;let n=0,a=!1;return r.Children.forEach(t,(t=>{Ia()(t,"props.selectable")&&(e===n&&(a=!0),n+=1)})),a},this.getLastSelectableIndex=()=>{const{children:e}=this.props;let t=-1;return r.Children.forEach(e,(e=>{Ia()(e,"props.selectable")&&(t+=1)})),t},this.handleMouseDown=e=>{this.props.focusable&&e.preventDefault()},this.handleChildHighlighted=e=>{const{onLockParentMenu:t,selectableIndex:n,parentIsLocked:r}=this.props;t&&!r&&t(n),this.setState({highlightedIndex:e,highlightedBy:"HOVER",locked:!1})},this.handleClickOutside=()=>{this.props.onClickOutside()},this.handleLockMenu=e=>{this.setState({locked:!0,highlightedIndex:e})},this.handleUnlockMenu=()=>{this.setState({locked:!1})},this.handleSelectNext=(e,t)=>{const{selectable:n,highlighted:r,onUnlockParentMenu:a,onExitMenuBottom:o}=this.props,{highlightedIndex:l,locked:i}=this.state;if(!t&&(n&&!r||i))return;e&&e.preventDefault();const s=l+1;this.highlightedTargetExists(s)?this.setState({highlightedIndex:s,direction:Ld,highlightedBy:_d}):a&&o&&(o(),a(),this.setState({highlightedIndex:-1,highlightedBy:_d}))},this.handleArrowDown=e=>{const{noArrowKeys:t}=this.props;t||this.handleSelectNext(e)},this.handleTab=e=>{this.handleSelectNext(e)},this.handleSelectLast=(e,t)=>{const{selectable:n,highlighted:r,onUnlockParentMenu:a,onExitMenuTop:o}=this.props,{highlightedIndex:l,locked:i}=this.state;if(!t&&(n&&!r||i))return;e&&e.preventDefault();const s=l-1;this.highlightedTargetExists(s)?this.setState({highlightedIndex:s,highlightedBy:_d,direction:xd}):a&&o&&(o(),a(),this.setState({highlightedIndex:-1,highlightedBy:_d}))},this.handleArrowUp=e=>{const{noArrowKeys:t}=this.props;t||this.handleSelectLast(e)},this.handleShiftTab=e=>{this.handleSelectLast(e)},this.getManipulatedChildren=()=>{const{children:e,stickyHover:t}=this.props,{highlightedIndex:n,highlightedBy:a,direction:o,locked:l}=this.state;let i=0;return r.Children.map(e,(e=>{if(!Ia()(e,"props.selectable"))return e;if(i!==n){const n=(0,r.cloneElement)(e,{selectableIndex:i,stickyHover:t,parentIsLocked:l,onLockParentMenu:this.handleLockMenu,onUnlockParentMenu:this.handleUnlockMenu,onHover:this.handleChildHighlighted});return i+=1,n}const s=(0,r.cloneElement)(e,{selectableIndex:i,highlightedBy:a,stickyHover:t,highlighted:!0,defaultHighlightedIndex:o,parentIsLocked:l,onLockParentMenu:this.handleLockMenu,onUnlockParentMenu:this.handleUnlockMenu,onExitMenuTop:this.handleSelectLast.bind(null,null,!0),onExitMenuBottom:this.handleSelectNext.bind(null,null,!0),onHover:this.handleChildHighlighted});return i+=1,s}))};const{defaultHighlightedIndex:t}=this.props;let n=t;n===Ld&&(n=0),n===xd&&(n=this.getLastSelectableIndex()),this.state={highlightedIndex:n,highlightedBy:"",locked:!1,direction:null}}render(){const{className:e,embedded:t,style:n}=this.props,a=Ye()("ghq-next-fact-editor-menu",e,{"ghq-is-embedded":t,"ghq-is-mobile":(0,Da.tq)()});return r.createElement("div",{style:n,className:a,onMouseDown:this.handleMouseDown},this.getManipulatedChildren())}}).propTypes=Id,kd.defaultProps={defaultHighlightedIndex:-1,stickyHover:!0,style:{}},kd),{phase:!0});const Md=(0,Ma.Z)((0,wa.Z)(class extends r.Component{constructor(){super(...arguments),this.componentDidMount=()=>{this.scrollOnKeydownHighlight()},this.componentDidUpdate=()=>{this.scrollOnKeydownHighlight()},this.scrollOnKeydownHighlight=()=>{const{highlightedBy:e,highlighted:t}=this.props;e===_d&&t&&(0,Pa.n5)(this.item)},this.handleSelect=e=>{const{value:t,onSelect:n,selectable:r}=this.props;r&&n&&n(t,e)},this.handleMouseDown=e=>{e.preventDefault()},this.handleEnter=e=>{const{highlighted:t,value:n,selectable:r,onSelect:a}=this.props;t&&r&&(e.stopImmediatePropagation(),e.preventDefault(),a(n))},this.handleHover=()=>{const{selectableIndex:e,stickyHover:t,selectable:n,showTooltip:r,onHover:a}=this.props;r(this.item),t&&n&&a(e)}}render(){const{ariaLabel:e,className:t,children:n,selected:a,selectable:o,highlighted:l,disabled:i,hideTooltip:s,dataTestId:c,dataEventId:d}=this.props,u=Ye()("ghq-next-fact-editor-menu-item Button-sage Button-sage--icon",t,{"ghq-is-selected":a,"ghq-is-selectable":o,"ghq-is-highlighted":l,"ghq-is-disabled":i,"ghq-is-mobile":(0,Da.tq)()});return r.createElement("button",{disabled:i,"data-testid":c,ref:e=>{this.item=e},"aria-label":e,"data-eventid":d,type:"button",className:u,onMouseDown:this.handleMouseDown,onMouseEnter:this.handleHover,onFocus:this.handleHover,onMouseLeave:s,onBlur:s,onClick:this.handleSelect},n)}}),{phase:!0});var Pd=e=>{let{editor:t,commands:n}=e;const[a,o]=(0,r.useState)(),l=n.map((e=>{const{icon:t,name:n,onSelect:a}=e;return r.createElement(Md,{selectable:!0,key:n,onSelect:a},r.createElement(Qt.Z,{icon:t}),r.createElement("span",null,n))})),i=r.createElement(jl.default,{unmountOnExit:!0,timeout:{enter:0,exit:500}},(e=>r.createElement(wd,{className:"ghq-next-fact-editor-inline-filter-menu",defaultHighlightedIndex:0},e))(l));return(0,r.useEffect)((()=>{const{selection:e}=t;if(!e)return;const[n]=f.ML.above(t,{match:v._x})||[];null!=n&&o(u.F3.toDOMNode(t,n))}),[t]),null==a?null:r.createElement(Ha.Z,{poll:!0,sameWidthAsTarget:!0,target:a},r.createElement(Gl(),null,i))};var Dd=e=>{let{toggleGuide:t}=e;const n=(0,Gt.y)(),a=(0,u.ui)(),{selection:o}=a,[l,i]=r.useState((0,m.Al)(a)),s=ua(a)?Sd(a,t,n).filter((e=>"Table"!==e.name)):Sd(a,t,n),[c,d]=r.useState(s);return r.useEffect((()=>{if(o)if((0,m.uH)(a)){const[e]=f.ML.above(a,{match:v._x})||[];if(null==e)return;const t=(e=>e.substring(1).toLowerCase().replace(" ",""))(f.NB.string(e));i(!0);const n=s.filter((e=>e.name.toLowerCase().replace(" ","").includes(t)||e.aliases&&e.aliases.some((e=>e.replace(" ","").includes(t)))));d(n),n.length||i(!1)}else i(!1)}),[o]),l?r.createElement(Pd,{editor:a,commands:c}):null},Ad=n(14293),Od=n.n(Ad);const Rd=e=>{let{message:t,onClose:n}=e;return r.createElement("div",{"data-testid":"Draft alert message"},r.createElement(fr.Z,{type:fr.N.Alert,onClose:n},t))};var Zd=e=>{let{alertMessage:t,isArchived:n}=e;const[a,o]=(0,r.useState)(!Od()(t)),l=n?void 0:()=>o(!1);return(0,r.useEffect)((()=>{o(!Od()(t))}),[t]),a?r.createElement("div",{className:"FactEditorAlerts"},a&&r.createElement(Rd,{message:t,onClose:l})):null},qd=n(21112),Fd=n.n(qd),Bd=n(43177),Hd=n(53442);class Ud extends r.PureComponent{render(){const{text:e,subText:t,className:n}=this.props,a=Ye()("ghq-InputLabel",n),o=t?r.createElement("div",{className:"ghq-InputLabel__text"},t):null;return r.createElement("div",{className:a},r.createElement("div",{className:"ghq-InputLabel__heading"},e),o)}}Ud.propTypes={className:jt().string,text:jt().string.isRequired,subText:jt().string};var zd=Ud;var Vd=(0,Pn.ey)((e=>{var t;let{card:n,canClose:a,onClose:o}=e;const l=Ia()(n,"meta.templateTitle",""),i=Ia()(n,"meta.templateDescription",""),s=300-(null==i?void 0:i.length),c=Ye()("ghq-NextTemplateEditorToolbar__description-char-cap",{"ghq-is-error":s<0});return r.createElement("div",{className:"ghq-NextTemplateEditorToolbar"},r.createElement("div",{className:"ghq-NextTemplateEditorToolbar__close"},a&&r.createElement(Nn.Z,{icon:"close",size:16,onClick:o})),r.createElement("div",{className:"ghq-NextTemplateEditorToolbar__title"},null!=n&&null!==(t=n.meta)&&void 0!==t&&t.contentFromTemplate?r.createElement(r.Fragment,null,"Edit Template"," ",r.createElement(Nn.Z,{className:"ghq-NextTemplateEditorToolbar__delete",icon:"delete",size:20,tooltipped:{message:"Delete Template",preferredXPosition:"right",preferredYPosition:"center"},onClick:()=>{Dn.Z.startCustomConfirmKey(n.id,"deleteTemplate")}})):"Create Template"),r.createElement("div",{className:"ghq-NextTemplateEditorToolbar__subsection"},r.createElement("div",{className:"ghq-NextTemplateEditorToolbar__template-title"},r.createElement(zd,{className:"ghq-NextTemplateEditorToolbar__input-label",text:"Template Title"}),r.createElement(Hd.Z,{autofocus:!0,className:"ghq-NextTemplateEditorToolbar__input",type:"text",placeholder:"ex. FAQs, Case Study, etc.",value:l,handleInputChange:(e,t)=>{Dn.Z.mergeMeta(n.id,{templateTitle:t})}})),r.createElement("div",{className:"ghq-NextTemplateEditorToolbar__template-description"},r.createElement(zd,{className:"ghq-NextTemplateEditorToolbar__input-label",text:"Template Description"}),r.createElement(Hd.Z,{className:"ghq-NextTemplateEditorToolbar__input",type:"text",placeholder:"ex. Use this template when creating a new FAQ Card",value:i,handleInputChange:(e,t)=>{Dn.Z.mergeMeta(n.id,{templateDescription:t})}}),r.createElement("div",{className:c},s,"/",300))))}));class Yd extends r.PureComponent{render(){const{verificationState:e,className:t}=this.props,n=Ye()("ghq-NextFactEditorToolbarColorBar",t,{"ghq-is-verified":e===An.TRUSTED||""===e,"ghq-needs-verification":e===An.NEEDS_VERIFICATION});return r.createElement("div",{className:n})}}Yd.propTypes={verificationState:jt().string,className:jt().string},Yd.defaultProps={verificationState:""};var jd=n(73935),Wd=n(32950),Gd=n(65185);const Kd={block:jt().any};class $d extends r.Component{render(){const{block:e}=this.props;if(!e)return null;switch(e.type){case Kl.BULLETED_LIST:case Kl.NUMBERED_LIST:return r.createElement(Ss,this.props);default:return null}}}$d.propTypes=Kd;const Qd=e=>{const t=e.toUpperCase(),n=(e=>Pi[e].keyboardShortCommand.join(""))(Kl[t]);return"".concat(e," - ").concat(n)};var Jd=e=>{var t,n,a,o;let{editor:l}=e;const i=0===((null===(t=l.history)||void 0===t||null===(n=t.undos)||void 0===n?void 0:n.length)||0),s=0===((null===(a=l.history)||void 0===a||null===(o=a.redos)||void 0===o?void 0:o.length)||0);return r.createElement("div",{className:"ghq-NextFactEditorToolbarHistory"},r.createElement(We.ZP,{disabled:i,tooltipPosition:We.DU.Top,style:We.Dd.Standard,aria:"undo",icon:b.Z.Undo,tooltipLabel:Qd("Undo"),iconSize:16,onClick:l.undo}),r.createElement(We.ZP,{disabled:s,tooltipPosition:We.DU.Top,style:We.Dd.Standard,aria:"redo",icon:b.Z.Redo,tooltipLabel:Qd("Redo"),iconSize:16,onClick:l.redo}))};const{TOOLBAR_INSERT:Xd}=Kl;var eu=()=>{const[e,t]=r.useState(!1),n=(0,u._7)(),a=(0,xn.Z)((()=>t(!1))),o=r.useRef(),l=(0,yt.tC)(n);return r.createElement("div",{"data-testid":"Toolbar insert dropdown",className:"ghq-NextFactEditorToolbarInsertDropdown",ref:a},r.createElement(We.ZP,{ariaHasPopup:!0,ariaExpanded:e,tooltipPosition:We.DU.Top,style:We.Dd.Standard,aria:"moreOptions",icon:b.Z.DotsVertical,ref:o,tooltipLabel:"More options",disabled:l,onClick:()=>{t((e=>!e))}}),r.createElement(_s,{openedMenu:Xd,open:e,target:o.current,onClose:()=>t(!1)}))};const tu=(0,Zl.eE)(),nu={label:r.createElement("span",null,"Toggle Guide"),keyboardCommand:tu?["\u2318","?"]:["ctrl","?"]}.keyboardCommand.join("");var ru,au=e=>{let{guideOpen:t,setPopoverAnchorTarget:n,onToggleGuide:a}=e;return r.createElement("div",{className:"toggle-help__wrapper"},r.createElement(We.ZP,{ariaHasPopup:!0,ariaExpanded:t,shape:We.e7.Square,style:We.Dd.Standard,tooltipPosition:We.DU.Top,iconSize:16,ref:n,aria:"toggleEditorHelp",icon:b.Z.CircleQuestion,tooltipLabel:"Toggle Help Guide - ".concat(nu),onClick:a}),r.createElement("div",{className:"pendo-editor-hook",datatype:"pendoEditorHook"}))};!function(e){e.None="none",e.Tight="tight",e.Relaxed="relaxed"}(ru||(ru={}));const ou=e=>{let{spacing:t=ru.None}=e;const n=Ye()("VerticalDivider-sage",t&&"VerticalDivider-sage--spacing-".concat(t.toLowerCase()));return r.createElement("div",{className:n})};ou.spacing=ru;var lu=ou;var iu=e=>{let{id:t,editor:n,guideOpen:a,insertIsCollapsed:o,removeHelpIcon:l,removeFormatAndInsertLabels:i,onToggleGuide:s,actions:c}=e;const[,d]=r.useState(),h=(0,u.ui)(),[p]=(0,Fs.Z)(ql.Z.GEN_AI_FULLCARD_SUMMARY_ALLOWED),m=Ye()("ghq-NextFactEditorToolbarLowerToolbar",{"ghq-is-small":i}),g=o?r.createElement(eu,null):r.createElement(Ps,{editor:h,actions:c}),f=o?null:r.createElement(lu,{spacing:lu.spacing.Tight}),v=l?null:r.createElement(lu,{spacing:lu.spacing.Tight}),E=l?null:r.createElement(au,{guideOpen:a,setPopoverAnchorTarget:e=>{const n=(0,jd.findDOMNode)(e);Wd.Z.mergeData(t,{anchorProps:{target:n,preferredXPosition:Gd.pX,preferredYPosition:Gd.ru}})},onToggleGuide:s});return r.createElement("div",{ref:d,className:m},r.createElement(Jd,{editor:n}),f,r.createElement(ws,null),f,r.createElement(qs,{editor:n}),p&&!Zl.ZP.isExtension()&&r.createElement(r.Fragment,null,r.createElement(lu,{spacing:lu.spacing.Tight}),r.createElement(Is,{openedMenu:_e.ToolbarAssist})),f,r.createElement("div",{className:"ghq-NextFactEditorToolbarLowerToolbar__insert-menu"},g),null,r.createElement($d,null),v,E)};var su=()=>{const e=(0,u._7)(),t=[Pl,fo,vo,Eo,x,L,ye,He];return r.createElement("div",{className:"ghq-next-fact-editor-mobile-format-menu"},r.createElement(Ms,{isCursorOnLink:(0,m.dx)({editor:e}),activeMarks:(0,m.wf)({editor:e}),disabled:(0,m.fe)({editor:e}),hasMultiBlocksSelected:(0,m.iL)({editor:e}),items:t,iconSize:20,onSelect:t=>t(e)}))};var cu=()=>{const e=(0,u._7)(),t=[$o,Cs,ps,cl,Yn,io,ht,an,bl];return r.createElement("div",{className:"ghq-next-fact-editor-expanded-insert-toolbar-menu"},r.createElement(Ms,{isCursorOnLink:(0,m.dx)({editor:e}),activeMarks:(0,m.wf)({editor:e}),disabled:(0,m.fe)({editor:e}),hasMultiBlocksSelected:(0,m.iL)({editor:e}),items:t,onSelect:t=>t(e)}))};const du="MOBILE_TOOLBAR_INSERT",uu="MOBILE_TOOLBAR_FORMAT";var hu=()=>{const e=(0,u._7)(),[t,n]=r.useState(null),a=()=>{n(null)},o=e=>{(t||e)&&t!==e&&n(e)},l=()=>{o(uu)},i=()=>{o(du)};switch(t){case du:return r.createElement("div",{className:"ghq-NextFactEditorMobileToolbar"},r.createElement("div",{className:"ghq-NextFactEditorMobileToolbar__insert-menu"},r.createElement(cu,null)),r.createElement(lu,{spacing:lu.spacing.Relaxed}),r.createElement(We.ZP,{style:We.Dd.Standard,aria:"Close",icon:b.Z.Close,onClick:a}));case uu:return r.createElement("div",{className:"ghq-NextFactEditorMobileToolbar"},r.createElement("div",{className:"ghq-NextFactEditorMobileToolbar__format-menu"},r.createElement(su,null)),r.createElement(lu,{spacing:lu.spacing.Relaxed}),r.createElement(We.ZP,{style:We.Dd.Standard,aria:"Close",icon:b.Z.Close,onClick:a}));default:return r.createElement("div",{className:"ghq-NextFactEditorMobileToolbar"},r.createElement(We.ZP,{style:We.Dd.Standard,aria:"Format paragraph",icon:b.Z.FormatParagraph,onClick:l}),r.createElement(lu,{spacing:lu.spacing.Relaxed}),r.createElement("div",{className:"ghq-NextFactEditorMobileToolbar__style-menu"},r.createElement(qs,{className:"ghq-next-fact-editor-mobile-style-menu",editor:e})),r.createElement(lu,{spacing:lu.spacing.Relaxed}),r.createElement(We.ZP,{style:We.Dd.Standard,aria:"More options",icon:b.Z.DotsVertical,onClick:i}))}},pu=n(8509),mu=n(14381),gu=n(49768),fu=n(43387);var vu=n(40979);var Eu=e=>{let{isVerifierOrVerifierGroup:t,showNotifyFollowersCheckbox:n,isVerificationChecked:a,isNotifyFollowersChecked:o,followersCount:l,handleVerifyCheckbox:i,handleNotifyFollowersCheckbox:s}=e;const c=r.createElement("div",null,"Notify ".concat(l," followers"));return r.createElement("div",{className:"PublishCardOptions"},t&&r.createElement(vu.Z,{label:"Verify Card",name:"verify option",isChecked:a,onChange:i}),n&&r.createElement("div",{className:"PublishCardOptions__notify"},r.createElement(vu.Z,{label:c,name:"notify option",isChecked:o,onChange:s})))},bu=n(54793),yu=n(85731),Cu=n(46440),Nu=n(95394);var Tu=e=>{var t,n;let{onClose:a,popoverRef:o,triggerRef:l}=e;const{card:i}=(0,Pn.RC)(),{data:{id:s}}=i,{handlePublish:c}=(0,Cu.d)(),{isVerificationChecked:d,handleVerifyCheckbox:u,isVerifierOrVerifierGroup:h}=(e=>{const{id:t}=e,[{data:{email:n}}]=(0,Ca.Z)(),[a,o]=(0,r.useState)(!0),l=fu.Z.getBySearchId(t),i=l.data.filter((e=>"user-group"===e.type)),s=i.length?i[0].id:null,c=s?gu.Z.getFilter(s):null,d=l.data.some((e=>{if("user"===e.type)return e.user.email===n}))||c&&c.items.data.some((e=>e.user.email===n)),u=(0,r.useCallback)((()=>{o(!a)}),[a]);return{isVerifierOrVerifierGroup:d,isVerificationChecked:a,handleVerifyCheckbox:u}})(i),[p,m]=(0,r.useState)(""),[g,f]=(0,r.useState)(!0),[v,E]=(0,bu.Z)(s),y=null!==(t=null===(n=v.data.analytics)||void 0===n?void 0:n.followers)&&void 0!==t?t:0,C=y>0,N=C&&g;(0,r.useEffect)((()=>{E.post({pathVars:[s]})}),[]),(0,yu.Z)({anchor:o,target:l});return r.createElement("div",{className:"PublishCardMenu",ref:o},r.createElement("div",{className:"PublishCardMenu__top-header"},r.createElement("p",{className:"PublishCardMenu__top-header-info"},"Publish Card"),r.createElement(We.ZP,{style:We.Dd.Standard,icon:b.Z.Close,aria:"close menu",onClick:a})),r.createElement(Eu,{handleVerifyCheckbox:u,isVerificationChecked:d,isVerifierOrVerifierGroup:h,handleNotifyFollowersCheckbox:()=>{f(!g)},isNotifyFollowersChecked:N,followersCount:y,showNotifyFollowersCheckbox:C}),r.createElement("div",{className:"PublishCardMenu__text-area"},r.createElement(Nu.Z,{label:(T="Publish Card Message",r.createElement(Ds.Z,null,T)),placeholder:"Add a message...",name:"revisionNote",value:p,maxCharacterCount:350,onChange:m})),r.createElement(Bt.ZP,{label:"Publish Card",size:Bt.qE.Medium,style:Bt.ZJ.Outline,theme:Bt.bn.Dark,onClick:()=>{c({notifyFollowers:N,verifyCard:d,revisionNote:p})}}));var T},Su=n(20456);var ku=()=>{const{popoverRef:e,triggerRef:t}=(0,Su.Z)({containerClass:".PublishCardMenu"}),{existingCardActionButtons:n,isPublishMenuOpen:a,setIsPublishMenuOpen:o}=(0,Cu.d)();return r.createElement(r.Fragment,null,r.createElement("div",{className:"PublishCardButtons"},n.map(((e,n)=>{let{label:a,disabled:o,theme:l,style:i,onClick:s}=e;return r.createElement(Bt.ZP,{key:n,label:a,disabled:o,theme:l,style:i,ref:1===n?t:void 0,onClick:s})}))),a&&r.createElement(Tu,{popoverRef:e,triggerRef:t,onClose:()=>o(!a)}))},xu=n(67411),Lu=n(91781),_u=n(27008),Iu=n(97061);function wu(){return wu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wu.apply(this,arguments)}var Mu=e=>{let{filterTerm:t,setFilterTerm:n,setSelectedCollaborators:a,selectedCollaborators:o,draftId:l}=e;const{draftCollaborators:i}=(0,Lu.ZP)({draftId:l,eligible:!0,search:t}),s=(0,r.useCallback)(Rl()((e=>n(e)),400),[]);return r.createElement(Iu.ZP,{multiSelect:!0,searchable:!0,serverSideFiltering:!0,persistFilterTerm:!0,label:"",name:"add-collaborators",placeholder:"Add people or groups...",maxPopoverHeight:Iu.sI.Small,value:o,onChange:e=>{a(e)},onInputChange:e=>{s(e)}},null==i?void 0:i.map((e=>{var t;const n=e.user?_u.Z.getNameFromModel(e.user):null===(t=e.userGroup)||void 0===t?void 0:t.name,a=e.user?{avatar:e.user.profilePicUrl,initials:_u.Z.getUsersInitials(e.user),avatarDescription:_u.Z.getNameFromModel(e.user)}:{icon:b.Z.AccountMultiple};return r.createElement(Iu.Jq,wu({key:e.id,value:JSON.stringify(e)},a),null!=n?n:"")})))},Pu=n(36930),Du=n(85695),Au=n(77917);var Ou=e=>{var t;let{onClose:n,popoverRef:a,triggerRef:o}=e;const{t:l}=(0,Kn.$G)(),{card:i}=(0,Pn.RC)(),c=null===(t=i.editorSession)||void 0===t?void 0:t.editingDraftId,[d,u]=(0,r.useState)(""),[h,p]=(0,r.useState)(""),[m,g]=(0,r.useState)([]),{draftCollaborators:f,addCollaborators:v,fetchNextPageOfContributors:E,hasNextPageOfContributors:y}=(0,Lu.ZP)({draftId:c,onPostSuccess:()=>{mn.Z.createToast({content:"Draft shared.",id:"fact-card-".concat(i.id)}),n()}}),C=m.length>0;(0,yu.Z)({anchor:a,target:o});const N=i.isNew?l("modals.shareDraft.newCardHelperText"):l("modals.shareDraft.publishedCardHelperText");return r.createElement("section",{className:"ghq-ShareDraftMenu",ref:a},r.createElement("div",{className:"ghq-ShareDraftMenu__top-header"},r.createElement("p",{className:"ghq-ShareDraftMenu__top-header-info"},l("modals.shareDraft.heading")),r.createElement(We.ZP,{style:We.Dd.Outline,icon:b.Z.Close,aria:"close menu",onClick:n})),r.createElement(Mu,{filterTerm:d,setFilterTerm:u,setSelectedCollaborators:g,selectedCollaborators:m,draftId:c}),C&&r.createElement(Nu.Z,{label:l("modals.shareDraft.textboxLabel"),placeholder:l("modals.shareDraft.textboxPlaceholder"),name:"message",value:h,onChange:p}),r.createElement("div",{className:"ghq-ShareDraftMenu__share-actions"},r.createElement(Bt.ZP,{disabled:!C,style:Bt.ZJ.Outline,theme:Bt.bn.Dark,label:l("modals.shareDraft.sendInviteButton"),size:Bt.qE.Small,onClick:()=>{const e=m.map((e=>JSON.parse(e)));v({draftId:c,collaborators:e,message:h})}})),r.createElement("div",{className:"ghq-ShareDraftMenu__contributors-container"},r.createElement(hr.ZP,{trimmed:!0,scrollable:!0,modifier:hr.QV.Filled,maxHeight:200},r.createElement(hr.R3,null,r.createElement("div",{className:"ghq-ShareDraftMenu__contributors-container-contents"},r.createElement("div",{className:"ghq-ShareDraftMenu__contributors-heading"},r.createElement(s.ZP,{style:s.Lx.Small,level:s.y5.H3},l("modals.shareDraft.contributorsHeader"))),null==f?void 0:f.map((e=>{var t,n;const a=e.type===Pu.l.user,o=a?_u.Z.getNameFromModel(e.user):null===(t=e.userGroup)||void 0===t?void 0:t.name;return r.createElement("div",{className:"ghq-ShareDraftMenu__contributors",key:e.id},a?r.createElement(Du.Z,{src:null===(n=e.user)||void 0===n?void 0:n.profilePicUrl,alt:o},o):r.createElement(Au.ZP,{icon:b.Z.Shared},o))})),y&&r.createElement(xu.h,{onEnter:()=>E()}))))),r.createElement("div",{className:"ghq-ShareDraftMenu__info-text"},r.createElement(Ht.Z,{style:Ht.W.Dim},N),r.createElement(We.ZP,{icon:b.Z.Link,dataTestId:"copy-draft-link",aria:l("modals.shareDraft.draftlinkTooltip"),tooltipLabel:l("modals.shareDraft.draftlinkTooltip"),tooltipPosition:We.DU.Left,style:We.Dd.Standard,onClick:()=>{const e="".concat(Sa.ZP.APP_URL,"/draft/").concat(c);bn.Z.copy(e),mn.Z.createToast({content:"Draft link copied.",id:"fact-card-".concat(i.id)}),n()}})))};var Ru=()=>{const{popoverRef:e,triggerRef:t,showContainer:n,updateContainer:a}=(0,Su.Z)({containerClass:".ghq-ShareDraftMenu"});return r.createElement(r.Fragment,null,r.createElement("div",{className:"ghq-ShareDraftButton"},r.createElement(We.ZP,{icon:b.Z.UserAdd,aria:"share draft",ref:t,onClick:()=>a(!n)})),n&&r.createElement(Ou,{popoverRef:e,triggerRef:t,onClose:()=>a(!1)}))},Zu=n(30381),qu=n.n(Zu);function Fu(){return r.createElement("p",{className:"ghq-NextFactEditorToolbarAutosaveIndicator__disabled"},"Autosave is OFF"," ",r.createElement(Nn.Z,{className:"ghq-NextFactEditorToolbarAutosaveIndicator__info",size:15,icon:"circle-question",tooltipped:{message:"A draft version of this Card exists. Autosave is turned off to ensure your draft isn't inadvertently updated. Be sure to manually save your changes!"}}))}function Bu(e){const t=!e.disabled&&!e.hasSwitcher;return!(e.autosaving||e.lastAutosaved||e.disabled)?null:r.createElement("span",{"data-testid":"Fact Editor Toolbar Autosave Indicator",className:Ye()("ghq-NextFactEditorToolbarAutosaveIndicator",e.className)},e.disabled?r.createElement(Fu,null):r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"ghq-NextFactEditorToolbarAutosaveIndictor__divider"}),r.createElement("span",{className:"ghq-NextFactEditorToolbarAutosaveIndicator__message"},e.autosaving?"Autosaving...":"Autosaved ".concat(qu()(e.lastAutosaved).format("h:mma")))))}var Hu=n(69209);var Uu=e=>{var t,n,a,o;let{autosaving:l,lastAutosaved:i,card:s}=e;const c=s.data.id,d=null===(t=s.meta)||void 0===t?void 0:t.isLegacyDraft,u=null===(n=s.editorSession)||void 0===n?void 0:n.hasCreatedDraftWhileEditing,h=null===(a=s.editorSession)||void 0===a?void 0:a.editingDraftId,p=h&&(null===(o=s.editorSession)||void 0===o?void 0:o.drafts[h]),m=p&&p.lastModified,g=p&&p.lastModifiedBy,f=qu()(m).locale("en").fromNow(),v=g&&_u.Z.getNameFromModel(g),E=!(e=>{let{card:t,autosaving:n,lastAutosaved:r}=e;const a=t.editorSession&&!bd.C.canAutoSave({editorSession:t.editorSession});return!(n||r||a)})({card:s,autosaving:l,lastAutosaved:i}),y=E?"(you)":"",C=l?"Saving...":"Last edit was saved ".concat(f," by ").concat(v," ").concat(y),[,N]=(0,Hu.Z)({filterId:s.id,preventOnLoad:!0});return(0,r.useEffect)((()=>()=>{c&&N.resetFilter()}),[]),r.createElement("div",{className:"ghq-NextFactEditorToolbarDraftHeader"},r.createElement(Oc.ZP,{type:Oc.Rt.Jelly,"data-testId":"draft-pill"},"Draft"),d&&r.createElement("div",{className:"ghq-NextFactEditorToolbarDraftHeader--legacy-text"},r.createElement(Ht.Z,{style:Ht.W.Dim},"Drafts save automatically as edits are made and when you close a draft.")),!u&&!d&&r.createElement(r.Fragment,null,r.createElement(Qt.Z,{icon:b.Z.AutosaveIndicator}),r.createElement("div",{className:"ghq-NextFactEditorToolbarDraftHeader--text"},r.createElement(Ht.Z,{style:Ht.W.Dim},C))))};class zu extends r.PureComponent{render(){const{maximized:e,onMaximize:t}=this.props,n=e?"collapse-window":"expand-window";return r.createElement(Nn.Z,{className:"ghq-NextFactEditorToolbarUpperToolbar__maximize",icon:n,size:16,onClick:t})}}zu.propTypes={className:jt().string,maximized:jt().bool.isRequired,onMaximize:jt().func.isRequired};var Vu=n(51575),Yu=n(13037);const ju=e=>{let{icon:t,label:n}=e;return r.createElement(r.Fragment,null,r.createElement(Nn.Z,{className:"ghq-NextFactEditorToolbarUpperToolbar__card-icon",icon:t,size:16}),""!==n&&r.createElement("span",{className:"ghq-NextFactEditorToolbarState"},n))};ju.propTypes={icon:jt().string.isRequired,label:jt().string.isRequired},ju.defaultProps={label:"",icon:"cards"};var Wu=ju;class Gu extends r.PureComponent{constructor(){super(...arguments),this.updateTitle=e=>{const t=e.value.document.getBlocks().get(0);e.moveToRangeOfNode(t).insertText(this.title.innerText)},this.handleBlur=()=>{this.title.innerText!==Fd().defaults.TITLE&&(this.title.scrollLeft=0)},this.handleMouseDown=e=>{e.stopPropagation()},this.handleEscape=e=>{document.activeElement===this.title&&(e.stopImmediatePropagation(),e.preventDefault(),this.title.innerText=this.props.title,this.title.blur(),this.title.scrollLeft=0)},this.handleEnter=e=>{document.activeElement===this.title&&this.title.innerText!==Fd().defaults.TITLE&&(e.stopImmediatePropagation(),e.preventDefault(),this.title.blur(),this.title.scrollLeft=0)}}render(){const{title:e,isDraftMode:t}=this.props;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"ghq-NextFactEditorToolbarTitle__prefix"},"DRAFT"),r.createElement("span",{contentEditable:!0,suppressContentEditableWarning:!0,ref:e=>{this.title=e},className:"ghq-NextFactEditorToolbarTitle",onMouseDown:this.handleMouseDown,onBlur:this.handleBlur},e))}}Gu.propTypes={title:jt().string};var Ku=(0,Ma.Z)(Gu,!0),$u=n(57174);const Qu=r.forwardRef(((e,t)=>{var n,a,o;let{id:l,title:i,card:s}=e;const c=null!==(n=null==s||null===(a=s.data)||void 0===a?void 0:a.hasDrafts)&&void 0!==n&&n,d=null==s?void 0:s.data.id,[u,h]=(0,Hu.Z)({filterId:d,queryParams:{cardId:d},preventOnLoad:!c||!d});r.useEffect((()=>()=>{d&&h.resetFilter(d)}),[]);const p=u.items.editData&&d&&null!==(o=u.items.editData)&&void 0!==o?o:[];const g=function(){const e={published:{label:"",icon:"cards",title:null==s?void 0:s.data.preferredPhrase,data:{title:null==s?void 0:s.data.preferredPhrase,jsonContent:null==s?void 0:s.data.jsonContent,content:null==s?void 0:s.data.content},id:null}};return p.forEach((t=>{e.draft={label:"DRAFT",icon:"draft",title:Vu.n.title({draft:t}),data:t,id:Vu.n.id({draft:t})}})),e}(),f=Object.keys(g);let v=g[f[0]];for(let e in g)g[e].id===(s&&pu.T.selectedDraftId({switcher:s.editorSession.draftSwitcher})||null)&&(v=g[e]);const E=f.length>1&&!(null!=s&&s.editorSession.hasCreatedDraftWhileEditing)&&!pu.T.isDisabled({switcher:null==s?void 0:s.editorSession.draftSwitcher}),b=(e=>{if(!e)return;const t=bd.C.isViewUnpublished({fact:e}),n=(0,m.E4)(e);return t||!n})(s),y=(e,t)=>r.createElement(r.Fragment,null,r.createElement(Wu,{icon:t.icon,label:t.label}),r.createElement(Ku,{id:e,title:t.title,isDraftMode:t.isDraftMode}));if(E){const e=r.createElement("p",{className:"ghq-NextFactEditorToolbarTitleOrMenuDropdown__selected-item"},r.createElement("span",{className:"ghq-NextFactEditorToolbarTitleOrMenuDropdown__selected-item-label"},v.label)," ",i);return r.createElement("div",{className:"ghq-NextFactEditorToolbarTitleOrMenu",ref:t},r.createElement($u.Z,{"data-testid":"fact-draft-switcher",className:"ghq-NextFactEditorToolbarTitleOrMenuDropdown",popoverFilterId:"ToolbarTitleOrMenu-drafts-".concat(d),renderSelectedItem:()=>r.createElement($u.Z.SelectedItem,{label:e,icon:v.icon}),renderDropdownToggleIcon:e=>{let{isOpen:t}=e;return r.createElement(Nn.Z,{icon:t?"chevron-up":"chevron-down",size:16})},renderMenu:e=>{let{closeMenu:t}=e;return r.createElement(Yu.ZP,null,f.map((e=>{const n=g[e];return r.createElement(Yu.sN,{selectable:!0,key:e,selected:n.id===v.id,value:e,onSelect:()=>{b?bd.C.switchDraft({fact:s,draft:n.data}):Dn.Z.startCustomConfirmKey(d,"keepDraft_switch",{switchEditorContent:n.data}),t()}},v.label===n.label?y(l,{...n,title:i}):y(l,n))})))}}))}{const e=s&&bd.C.isViewUnpublished({fact:s});return y(l,{label:"",icon:e?"draft":"cards",title:i,isDraftMode:e})}}));var Ju=(0,Pn.ey)(Qu),Xu=n(57682);const eh=()=>{const{cursors:e}=(0,Or.D)();return 0===e.length?null:r.createElement("div",{className:"ghq-MultiplayerAvatars"},e.map(((e,t)=>r.createElement("span",{className:"ghq-MultiplayerAvatar color-border--".concat(e.color),key:"".concat(e.id,"-").concat(t)},r.createElement(Xu.Z,{src:e.profilePic,size:Xu.Z.sizes.SMALL,initials:_u.Z.getUsersInitials(e),alt:"".concat(e.firstName,"'s profile picture")})))))};var th=e=>{var t;let{title:n,autosaving:a,lastAutosaved:o,onClose:l,maximized:i}=e;const[s]=(0,Fs.Z)(ql.Z.SHARED_DRAFTS_ALLOWED),[c]=(0,Fs.Z)(ql.Z.PUBLISH_MESSAGES_ALLOWED),{canClose:d,canMaximize:u,onClickMaximize:h,card:p,id:m,isMaximized:g}=(0,Pn.RC)(),f=p.meta.isLegacyDraft,v=Ye()("ghq-NextFactEditorToolbarUpperToolbar",{"ghq-can-drag":Zl.ZP.isExtension()}),[E]=(0,Fs.Z)(ql.Z.MULTIPLAYER_EDITING_ALLOWED),y=!p||p.editorSession&&!bd.C.canAutoSave({editorSession:p.editorSession}),C=p&&p.editorSession&&pu.T.isVisible({switcher:p.editorSession.draftSwitcher,drafts:p.editorSession.drafts}),N=null===(t=p.editorSession)||void 0===t?void 0:t.editingDraftId;return r.createElement("div",{className:v},s?r.createElement(Uu,{autosaving:a,lastAutosaved:o,card:p}):r.createElement(r.Fragment,null,r.createElement(Ju,{title:n}),r.createElement(Bu,{className:"ghq-NextFactEditorToolbarUpperToolbar__autosave-indicator",autosaving:a,lastAutosaved:o,disabled:y,hasSwitcher:C})),r.createElement("div",{className:"ghq-NextFactEditorToolbarUpperToolbar__options"},E&&r.createElement(eh,null),u&&r.createElement(zu,{maximized:i,onMaximize:()=>h(m,g)}),r.createElement("div",{className:"ghq-NextFactEditorToolbarUpperToolbar__buttons"},s&&N&&!f&&r.createElement(Ru,null),c?p.action===An.NEW?r.createElement(mu.Z,null):r.createElement(ku,null):null,d&&!c?r.createElement(We.ZP,{style:We.Dd.Standard,aria:"Close",icon:b.Z.Close,"data-testid":"close icon",onClick:l}):null)))};const nh={className:jt().string,actions:jt().array,id:jt().string,editor:jt().any,title:jt().string,autosaving:jt().bool,removeFormatAndInsertLabels:jt().bool,removeHelpIcon:jt().bool,insertIsCollapsed:jt().bool,lastAutosaved:jt().string,guideOpen:jt().bool,onClose:jt().func.isRequired,onToggleGuide:jt().func.isRequired};class rh extends r.Component{constructor(){super(...arguments),this.setToolbar=e=>{this.toolbar=e}}render(){const{className:e,id:t,actions:n,editor:a,title:o,autosaving:l,lastAutosaved:i,maximized:s,removeFormatAndInsertLabels:c,removeHelpIcon:d,insertIsCollapsed:u,guideOpen:h,onClose:p,onToggleGuide:m,verificationState:g,hasCardHeaderVerificationAccent:f,isTemplate:v}=this.props,E=Ye()("ghq-NextFactEditorToolbar",e);return(0,Da.tq)()?r.createElement(hu,null):r.createElement("div",{ref:this.setToolbar,className:E},f&&r.createElement(Yd,{verificationState:g}),v?r.createElement(Vd,{onClose:p}):r.createElement(th,{title:o||Fd().defaults.TITLE,autosaving:l,lastAutosaved:i,maximized:s,onClose:p}),r.createElement(iu,{id:t,actions:n,editor:a,removeFormatAndInsertLabels:c,removeHelpIcon:d,insertIsCollapsed:u,guideOpen:h,onToggleGuide:m}))}}rh.propTypes=nh;var ah=(0,Bd.Z)(((e,t,n)=>{const r=Ia()(t,"toolbar");return r?{insertIsCollapsed:r.clientWidth<=900,removeFormatAndInsertLabels:r.clientWidth<=600,removeHelpIcon:r.clientWidth<=600}:n}),(0,Pn.ey)(rh),{interval:500}),oh=n(14092);var lh=e=>{var t,n,a;let{alertMessage:o=null,autosaving:l,draftsViewCounter:i,editContent:s=Dn.Z.editContent,editJSONContent:c=Dn.Z.editJSONContent,editTitle:d=Dn.Z.editTitle,fact:h,isArchived:p,isTemplate:m,lastAutosaved:g,plugins:E,readOnly:b=!1,renderHeader:y,onClose:C}=e;const{setDisableDraftSaves:N}=(0,Pn.RC)(),[T]=(0,Fs.Z)(ql.Z.MULTIPLAYER_EDITING_ALLOWED),[S]=(0,Fs.Z)(ql.Z.SHARED_DRAFTS_ALLOWED),k=null===(t=h.meta)||void 0===t?void 0:t.isLegacyDraft,x=!m&&!b&&T&&S&&!k,L=Ta(E,x),{editor:_,editableProps:I,renderOutside:w,toolbarActions:M,serializeElement:P,renderPopover:O}=L,[R,Z]=(0,r.useState)(!1),q=(0,Gt.y)(),{contextState:F,setContextState:B}=q,H=(0,r.useMemo)((()=>(N(!0),x?{value:[],entities:{}}:Nd(h,L))),[i,null===(n=h.meta)||void 0===n?void 0:n.isTemplate,x]);(0,r.useEffect)((()=>{B((e=>({...e,entities:{...e.entities,...H.entities}})))}),[H.entities]);const U=()=>{Z((e=>!e))};(0,oh.ZP)({handleMetaBackSlash:()=>{U()}});const[z,V]=(0,r.useState)(H.value);(0,r.useEffect)((()=>{H.value!==z&&N(!1)}),[z]);const Y=(0,r.useRef)(null),j=(0,r.useRef)(z);j.current=z;const W=(0,r.useCallback)(Rl()((e=>{const t={value:e,entities:F.entities};if(V(e),e.length>0){const n=f.NB.string(e[0]);d(h.id,n);const r=JSON.stringify(t);c(h.id,r);const a=e.slice(1).map((e=>P(e,P))).join("");s(h.id,a)}}),400),[F.entities]),G=(0,r.useCallback)((e=>{W(e)}),[W,x]);(0,r.useEffect)((()=>{if(V(H.value),H.value.length>0&&(_.children=H.value),_.children.length>0){const e=f.ML.first(_,[0,0]);_.selection={anchor:{path:[0,0],offset:f.NB.string(e[0]).length},focus:{path:[0,0],offset:f.NB.string(e[0]).length}},u.F3.isFocused(_)||u.F3.focus(_),_.history={undos:[],redos:[]};Array.from(f.ML.nodes(_,{match:v.Ze,at:[]})).forEach((e=>{let[t,n]=e;fc(_,t,n)})),function(e){f.YR.unwrapNodes(e,{at:[],match:(t,n)=>{try{const[r]=f.ML.parent(e,n);return A(t)&&D(r)}catch(e){return!1}}})}(_)}}),[H]),(0,r.useEffect)((()=>{G(j.current)}),[F.entities]);const K=b?"ghq-read-only-next-fact-editor ghq-next-card-content":Ye()("ghq-next-fact-editor",{"ghq-guide-is-open":R,"ghq-is-mobile":(0,Da.tq)()}),$=Ye()("ghq-next-fact-editor__scroll-window ghq-no-new-scrollbar",{"ghq-is-mobile":(0,Da.tq)()});return r.createElement(u.mH,{editor:_,value:z,onChange:G},r.createElement("div",{"data-testid":b?"ReadOnlyInnerNextFactEditor":"InnerNextFactEditor",className:K},!b&&r.createElement(r.Fragment,null,r.createElement(ah,{id:h.id,editor:_,actions:M,verificationState:h.data.verificationState,title:null===(a=h.editFact.data)||void 0===a?void 0:a.preferredPhrase,isTemplate:m,autosaving:!x&&l,maximized:h.maximized,lastAutosaved:g,guideOpen:R,onClose:C,onToggleGuide:U}),r.createElement(Gl(),null,Ed(R,U))),b?r.createElement(r.Fragment,null,r.createElement(Zd,{alertMessage:o,isArchived:p}),y&&y(),r.createElement(Xc,{readOnly:b,isTemplate:m,isMultiplayer:x,editableProps:I}),w(),r.createElement(Ln,{popoverMode:F.popoverMode,renderPopover:O,setPopoverMode:e=>B((t=>({...t,popoverMode:e})))}),r.createElement(Po.FN,{filter:"next-fact-editor-".concat(h.id)})):r.createElement("div",{className:$},r.createElement("div",{className:"ghq-next-fact-editor__editors-and-sidebar"},r.createElement("div",{className:"ghq-next-fact-editor__content ghq-next-card-content",ref:Y},r.createElement(Zd,{alertMessage:o,isArchived:p}),y&&y(),r.createElement(Xc,{readOnly:b,isTemplate:m,isMultiplayer:x,editableProps:I}),x&&r.createElement(dd,{containerRef:Y}),r.createElement(Dd,{toggleGuide:U}))),w(),r.createElement(Ln,{popoverMode:F.popoverMode,renderPopover:O,setPopoverMode:e=>B((t=>({...t,popoverMode:e})))}),r.createElement(Po.FN,{filter:"next-fact-editor-".concat(h.id)}))))};var ih=e=>{let{alertMessage:t,autosaving:n,draftsViewCounter:o,editContent:l,editJSONContent:i,editTitle:s,fact:u,isArchived:h,isTemplate:p,lastAutosaved:m,onClose:g,plugins:f=Kc,readOnly:v,renderHeader:E}=e;return"creating_new_card"===u.messageKey?null:r.createElement(a.Z,{id:v?a.J.readOnlyNextFactEditor:a.J.nextFactEditor,render:()=>r.createElement(c,null)},r.createElement(d.Ai,{id:u.id},r.createElement(lh,{alertMessage:t,autosaving:n,draftsViewCounter:o,editContent:l,editJSONContent:i,editTitle:s,fact:u,isArchived:h,isTemplate:p,lastAutosaved:m,plugins:f,readOnly:v,renderHeader:E,onClose:g})))}},14381:function(e,t,n){var r=n(67294),a=n(46440),o=n(2803);t.Z=()=>{const{newCardActionButtons:e}=(0,a.d)();return r.createElement("div",{className:"PublishCardActionButtons"},e.map((e=>r.createElement(o.ZP,{label:e.label,disabled:e.disabled,theme:e.theme,style:e.style,onClick:e.onClick}))))}},35596:function(e,t,n){n.d(t,{F:function(){return d},U:function(){return u}});n(33948),n(15306),n(27207);var r=n(50361),a=n.n(r),o=n(43209),l=n(53694),i=n(73443),s=n(43422),c=n(50554);const d=(e,t,n)=>e.map((e=>o.xv.isText(e)?(0,c.X)(e,n):t(e,t,n))).join(""),u=e=>{let{node:t,classType:n,contentTypeValue:r,element:c,serialize:u,attributes:h={}}=e;const p='data-ghq-card-content-type="'.concat(r,'"'),m="ghq-card-content__".concat(n),g=['class="'.concat(m,'"'),p,...Object.entries(h).map((e=>{let[t,n]=e;return"".concat(t,'="').concat(n,'"')}))].join(" "),f=o.W_.isElement(t);let v;if(!(0,l.OC)(t)||o.W_.isElement(t)&&("iframe"===t.type||"video"===t.type))if(f&&"markdown"===t.type)v=(0,s.Nw)(t).replaceAll("&nbsp;"," ");else{const e=a()(t);if(e.children){const n=f&&("code-block"===t.type||"code-line"===t.type),r=f&&"p"===t.type;let a=!0;"orderedMarks"in t?a=!t.orderedMarks:!f||"iframe"!==t.type&&"video"!==t.type||(a=!1),e.children.forEach(((e,t)=>{const o=e,l=n||o.code,s=r&&/^<br(\s*\/)?>(\s*)?$/g.test(o.text);o.text&&a&&(o.text=(0,i.aM)(o.text,l,s))}))}v=o.W_.isElement(e)?d(e.children,u,c):e.text}return v?!c&&o.W_.isElement(t)&&1===t.children.length?v:!c&&o.W_.isElement(t)&&t.children.length>1?"<span>".concat(v,"</span>"):"<".concat(c," ").concat(g,">").concat(v,"</").concat(c,">"):"img"===c||"hr"===c?"<".concat(c," ").concat(g," />"):"<".concat(c," ").concat(g,"></").concat(c,">")}},2740:function(e,t,n){n.d(t,{JG:function(){return x},OY:function(){return g.OY},SY:function(){return E},S_:function(){return C},Sb:function(){return S},WY:function(){return N},Zn:function(){return v},Zt:function(){return b},ki:function(){return y},yj:function(){return k}});n(33948),n(15306);var r=n(67294),a=n(43209),o=n(59806),l=n(7813),i=n.n(l),s=n(91087),c=n(53694),d=n(32989),u=n(54911),h=n(13921),p=n(37206),m=n(48306),g=n(73443),f=n(25108);function v(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.rI;const{selection:n}=e;if(!n)return;let r;if(a.e6.isCollapsed(n))r=[{type:"code-line",children:[{text:""}]}];else{const t=a.ML.nodes(e,{at:n,match:e=>(0,c._x)(e)});r=Array.from(t).map((t=>{let[,n]=t;return{type:"code-line",children:[{text:a.ML.string(e,n)||""}]}}))}return s.$4.insertRootBlock(e,{type:"code-block",language:t,children:r})}function E(e){const{selection:t}=e;if(!t)return;const[n]=a.ML.above(e,{at:t.anchor.path,match:e=>a.W_.isElement(e)&&"code-block"===e.type})||[];return"code-block"===(null==n?void 0:n.type)||s.$4.isInside(e,"code-block")}function b(e,t){if(!t)return!1;const{next:n,curr:r}=t;if(!n||!r)return!1;if(a.ML.isEmpty(e,n.node))return a.YR.select(e,n.path),!0;const[,o]=a.ML.next(e,{at:r.path})||[];return a.YR.insertNodes(e,{type:"p",children:[{text:""}]},{at:o}),a.YR.select(e,n.path),!0}function y(e){const{selection:t}=e;if(!t)return null;const{anchor:n}=t,r=a.y$.parent(n.path),o=a.y$.parent(r),[l]=a.ML.node(e,o);return(0,c.bA)(l)?[o,r]:null}function C(e){const t={isNextEditorCodeBlock:!1,lines:[]};if(!e.clipboardData)return t;const n=e.clipboardData.getData("application/x-slate-fragment");if(!n)return t;const r=decodeURIComponent(window.atob(n));let a;try{if(a=JSON.parse(r),Array.isArray(a)){const[e]=a;return(0,c.bA)(e)?{isNextEditorCodeBlock:!0,lines:e.children}:t}return t}catch(e){var o;return null===(o=window.Rollbar)||void 0===o||o.error(e),f.error(e),t}}function N(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.Je;const n=(0,s.tV)(e,t);return!!n&&(a.ML.withoutNormalizing(e,(()=>{for(const r of n){const[,n]=r,o=a.ML.start(e,n);if(!a.e6.isExpanded(e.selection)){var t;const n=null===(t=e.selection)||void 0===t?void 0:t.anchor,r=a.ML.range(e,o,n),l=a.ML.string(e,r);if(/\S/.test(l))return void a.YR.insertText(e,"  ",{at:e.selection})}a.YR.insertText(e,"  ",{at:o})}})),!0)}function T(e,t){const[,n]=t,r=a.ML.start(e,n),o=r&&a.ML.after(e,r),l=o&&a.ML.range(e,r,o),i=a.ML.string(e,l);return!!/\s/.test(i)&&(a.YR.delete(e,{at:l}),!0)}function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.Je;const n=(0,s.tV)(e,t);return!!n&&(a.ML.withoutNormalizing(e,(()=>{for(const t of n){T(e,t)&&T(e,t)}})),!0)}function k(){var e;const t=r.useContext(h.ZP);return null==t||null===(e=t.id)||void 0===e?void 0:e.replace("-readonly","")}function x(e){let{factId:t,element:n}=e;const r=function(e){return e.children.map(a.NB.string).join("\n")}(n),l=(0,d.x)(n,((e,t)=>(0,u.$)(e,(e=>e.text))));p.Z.copyCodeBlock(l,{plain:r,forCard:!0},t),o.Z.createToast({content:"Code copied!",id:"next-fact-editor-".concat(t),type:i().SUCCESS})}},48306:function(e,t,n){n.d(t,{V1:function(){return o},V2:function(){return a},rI:function(){return r}});const r="plain",a={label:"Plain Text",value:"plain"},o=[{label:"ABAP",value:"abap"},{label:"ActionScript",value:"actionscript"},{label:"Ada",value:"ada"},{label:"Apache Configuration",value:"apacheconf"},{label:"APL",value:"apl"},{label:"AppleScript",value:"applescript"},{label:"AsciiDoc",value:"asciidoc"},{label:"ASP.NET (C#)",value:"aspnet"},{label:"AutoIt",value:"autoit"},{label:"AutoHotkey",value:"autohotkey"},{label:"Bash",value:"bash"},{label:"BASIC",value:"basic"},{label:"Batch",value:"batch"},{label:"Bro",value:"bro"},{label:"C",value:"c"},{label:"C#",value:"csharp"},{label:"C++",value:"cpp"},{label:"C-like",value:"clike"},{label:"CoffeeScript",value:"coffeescript"},{label:"CSS",value:"css"},{label:"Dart",value:"dart"},{label:"Diff",value:"diff"},{label:"Docker",value:"docker"},{label:"Elixir",value:"elixir"},{label:"Erlang",value:"erlang"},{label:"Gherkin",value:"gherkin"},{label:"Git",value:"git"},{label:"Go",value:"go"},{label:"GraphQL",value:"graphql"},{label:"Groovy",value:"groovy"},{label:"Haml",value:"haml"},{label:"Handlebars",value:"handlebars"},{label:"Haskell",value:"haskell"},{label:"HTTP",value:"http"},{label:"Inform 7",value:"inform7"},{label:"Ini",value:"ini"},{label:"J",value:"j"},{label:"Java",value:"java"},{label:"JavaScript",value:"javascript"},{label:"JSON",value:"json"},{label:"Julia",value:"julia"},{label:"Kotlin",value:"kotlin"},{label:"LaTeX",value:"latex"},{label:"Less",value:"less"},{label:"LOLCODE",value:"lolcode"},{label:"Lua",value:"lua"},{label:"Makefile",value:"makefile"},{label:"Markdown",value:"markdown"},{label:"Markup",value:"markup"},{label:"MATLAB",value:"matlab"},{label:"nginx",value:"nginx"},{label:"Objective-C",value:"objectivec"},{label:"Perl",value:"perl"},{label:"PHP",value:"php"},a,{label:"PowerShell",value:"powershell"},{label:".properties",value:"properties"},{label:"Protocol Buffers",value:"protobuf"},{label:"Puppet",value:"puppet"},{label:"Python",value:"python"},{label:"Q",value:"q"},{label:"R",value:"r"},{label:"React JSX",value:"jsx"},{label:"Ruby",value:"ruby"},{label:"Rust",value:"rust"},{label:"Sass",value:"sass"},{label:"SCSS",value:"scss"},{label:"Scala",value:"scala"},{label:"Scheme",value:"scheme"},{label:"SQL",value:"sql"},{label:"Swift",value:"swift"},{label:"Textile",value:"textile"},{label:"Twig",value:"twig"},{label:"TypeScript",value:"typescript"},{label:"vim",value:"vim"},{label:"Visual Basic",value:"visual-basic"},{label:"Wiki Markup",value:"wiki"},{label:"YAML",value:"yaml"}]},32989:function(e,t,n){n.d(t,{x:function(){return o}});var r=n(35596),a=n(48306);const o=(e,t)=>{const{label:n,value:o}=a.V1.find((t=>t.value===e.language))||a.V2;return(0,r.U)({node:e,classType:"code-block",contentTypeValue:"CODE_BLOCK",element:"pre",serialize:t,attributes:{"data-ghq-code-block-syntax":n,"data-ghq-code-block-prism":o}})}},54911:function(e,t,n){n.d(t,{$:function(){return a}});var r=n(35596);const a=(e,t)=>(0,r.U)({node:e,classType:"code-block-line",contentTypeValue:"CODE_BLOCK_LINE",element:"code",serialize:t})},3842:function(e,t,n){n.d(t,{h:function(){return o},y:function(){return l}});var r=n(91087),a=n(71733);const o=(e,t)=>{if(null===e.selection)return;const n=(0,a.Q)(e,t);r.$4.insertCardLink(e,"guru-card",t,n)};function l(e){return/^(http(s)?:\/\/)?(.*\.)?getguru\.com(:\d{4})?\/#\/facts\/[\w\d]{8}-[\w\d]{4}-[\w\d]{4}-[\w\d]{4}-[\w\d]{12}$/gi.test(e)||/^(http(s)?:\/\/)?(.*\.)?getguru\.com(:\d{4})?\/#\/card\/./gi.test(e)||/^(http(s)?:\/\/)?(.*\.)?getguru\.com(:\d{4})?\/card\/./gi.test(e)}},74001:function(e,t,n){n.d(t,{Iv:function(){return m},P3:function(){return b},Y8:function(){return E},ni:function(){return g},oH:function(){return f},u6:function(){return v}});var r=n(19904),a=n(31439),o=n(59806),l=n(33200),i=n(71643),s=n(42584),c=n.n(s),d=n(47482),u=n(6793),h=n(37206),p=n(23525);const m=e=>{let{url:t,id:n}=e;o.Z.createToast({content:"Link copied",id:"next-fact-editor-".concat(n)}),h.Z.copyLinkInCard(t,n)},g=e=>{let{factId:t,linkData:n}=e;d.ZP.getById(t)?a.Z.startContentROI(t,n):a.Z.openFact(t,{activity:c().Activities.BOARD,activityId:"",boardId:"",maximized:!0,callBack:()=>{a.Z.startContentROI(t,n)}})},f=e=>{let{card:t,id:n}=e;h.Z.copyCard(t.data,t.activity,t.activityId,h.Z.getCopyFactHeaders(t)),o.Z.createToast({content:"Card copied",id:n})},v=e=>{let{card:t}=e;const n='<iframe src="'.concat(l.ZP.EMBED_URL,"/card/").concat(t.data.slug,'" frameBorder="0" width="500" height="400" style="margin:10px;max-height:100%;max-width:100%" allowFullScreen></iframe>');u.Z.copy(n,{plain:n,plainTextOnly:!0}),o.Z.createToast({content:"Copied to clipboard",id:"fact-card-".concat(t.id)}),r.Z.postActivity({type:p.default.EMBED_CARD_COPIED,biOnly:!0,properties:{factId:t.data.id}})},E=e=>{var t;let{card:n}=e;h.Z.copySyncLink(n.data,n.activity,n.activityId,h.Z.getCopyFactHeaders(n));const r=i.jV[null===(t=n.data.syncInfo)||void 0===t?void 0:t.contentSyncType]||"External Source";o.Z.createToast({content:"".concat(r," Link copied"),id:"fact-card-".concat(n.data.id)})},b=e=>{let{card:t}=e;h.Z.copyCardLink(t,t.activity,t.activityId,h.Z.getCopyFactHeaders(t)),o.Z.createToast({content:"Card link copied",id:"fact-card-".concat(t.id)})}},71733:function(e,t,n){n.d(t,{Q:function(){return o},T8:function(){return l},TG:function(){return s},x5:function(){return c}});n(33948),n(60285),n(41637),n(15306);var r=n(43209),a=n(91087);const o=(e,t)=>{if(null===e.selection)return t;const n=r.ML.string(e,e.selection);let a=t;return n&&(a=n),a},l=(e,t)=>{if(null===e.selection)return;const n=o(e,t);a.$4.insertLink(e,"link",t,n)},i=e=>{try{return new URL(e)}catch{return new URL("https://getguru.com")}},s=e=>{const t=i(e);return"powerdms.com"===t.host&&t.pathname.toLowerCase().includes("link/dfc/document")},c=e=>{const t=i(e),n=t.pathname.replace(/^\/+|\/+$/g,"");return"".concat(t.origin,"/").concat(n,"/").concat(t.search)}},70745:function(e,t,n){n.d(t,{Q:function(){return o}});var r=n(43209),a=n(53694);function o(e,t){return Array.from(r.ML.nodes(e,{at:t,match:(e,n)=>(0,a.nq)(e)&&r.y$.isAncestor(n,t.anchor.path)&&r.y$.isAncestor(n,t.focus.path)}))}},43422:function(e,t,n){n.d(t,{qf:function(){return y},AV:function(){return p},Nw:function(){return m},OY:function(){return i.OY},$u:function(){return E},WL:function(){return b},WY:function(){return N},Zt:function(){return i.Zt},o8:function(){return u},tC:function(){return h},V5:function(){return C},j9:function(){return f},Sb:function(){return T},QH:function(){return v},az:function(){return g}});n(33948);var r=n(43209),a=n(28721),o=n(91087),l=n(53694),i=n(73443),s=n(2740),c=n(57956);function d(e){return r.W_.isElement(e)&&"markdown-line"===e.type}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[{type:"markdown-line",children:[{text:""}]}],n=arguments.length>2?arguments[2]:void 0;return n?r.YR.insertNodes(e,{type:"markdown",entityKey:(0,a.Z)(),children:t},{at:n}):o.$4.insertRootBlock(e,{type:"markdown",entityKey:(0,a.Z)(),children:t})}function h(e){const{selection:t}=e;if(!t)return;const[n]=r.ML.above(e,{at:t.anchor.path,match:e=>r.W_.isElement(e)&&"markdown"===e.type})||[];return"markdown"===(null==n?void 0:n.type)||o.$4.isInside(e,"markdown")}function p(e){const{selection:t}=e;if(!t)return null;const{anchor:n}=t,a=r.y$.parent(n.path),o=r.y$.parent(a),[i]=r.ML.node(e,o);return(0,l.ev)(i)?[o,a]:null}function m(e){const t=e.children.map(r.NB.string).join("\n");return c.Z.getRawHTML(t)}function g(e){document.body.classList["show"===e?"remove":"add"]("ghq-hide-caret")}function f(e,t){return!!e&&((0,l.ev)(e)&&function(e,t){var n;return Boolean(null===(n=e.getContextState().entities[t.entityKey])||void 0===n?void 0:n.isPreview)}(t,e))}function v(e,t){return r.YR.select(e,t),r.YR.collapse(e),!0}function E(e,t,n){const[a,o]=p(t)||[],s=(0,i.OY)(t,a);if(!s)return!1;const{curr:c,prev:d,next:u}=s;if(c&&f(c.node,n)){if(d&&"up"===e)return v(t,d.path);if(d&&"left"===e){const{path:e}=d,a=r.ML.end(t,e),o=0!==a.offset?a.offset:null;return o&&!f(c.node,n)?(r.YR.select(t,{path:e,offset:o}),!0):o||(0,l.OC)(d.node)?f(c.node,n)?(r.YR.select(t,e),r.YR.collapse(t,{edge:"end"}),!0):(r.YR.select(t,e),r.YR.collapse(t),!0):(r.YR.select(t,e),r.YR.move(t,{unit:"line"}),r.YR.collapse(t,{edge:"end"}),!0)}if(u&&"down"===e)return v(t,u.path)}if(c&&(0,l.ev)(c.node)){if(d&&"up"===e&&f(d.node,n)&&(0,i.QI)(t,c,o).isFirst)return v(t,d.path);if(u&&"down"===e&&f(u.node,n)&&(0,i.QI)(t,c,o).isLast)return v(t,u.path)}return!1}function b(e,t,n){const r=(0,i.OY)(t);if(!r)return!1;const{next:a,prev:o}=r;return a&&"down"===e&&f(a.node,n)?v(t,a.path):!(!o||"up"!==e||!f(o.node,n))&&v(t,o.path)}function y(e){if(!e.clipboardData)return[];const t=e.clipboardData.getData("application/x-slate-fragment");if(!t)return[];const n=decodeURIComponent(window.atob(t));let r;try{var a;if(r=JSON.parse(n),Array.isArray(r)){const[e]=r;return"markdown"===e.type?e.children:[]}const e=null===(a=r)||void 0===a?void 0:a.nodes[0];if("MARKDOWN_EDIT"!==e.type)return[];return e.nodes.map((e=>{if("MARKDOWN_EDIT_LINE"!==e.type)return;return{type:"markdown-line",children:[{text:e.nodes[0].leaves[0].text}]}})).filter(Boolean)}catch(e){var o;return null===(o=window.Rollbar)||void 0===o||o.error(e),[]}}function C(){return navigator.platform.toLowerCase().includes("mac")}function N(e){return(0,s.WY)(e,d)}function T(e){return(0,s.Sb)(e,d)}},39146:function(e,t,n){n.d(t,{$_:function(){return i},Jq:function(){return o},Se:function(){return r},TU:function(){return l},aV:function(){return d},pU:function(){return a},u5:function(){return c}});const r={classType:"bold",contentTypeValue:"BOLD",element:"strong",altNodeName:"b",type:"bold",attributes:{}},a={classType:"italic",contentTypeValue:"ITALIC",element:"em",altNodeName:"i",type:"italic",attributes:{}},o={classType:"strikethrough",contentTypeValue:"STRIKETHROUGH",element:"del",type:"strikethrough",attributes:{style:"text-decoration:line-through"}},l={classType:"code-snippet",contentTypeValue:"CODE_SNIPPET",element:"code",type:"code",attributes:{}},i={classType:"text-color",contentTypeValue:"TEXT_COLOR",element:"span",type:"color",attributes:{style:"color: inherit"}},s=[r,a,{classType:"underline",contentTypeValue:"UNDERLINE",element:"u",type:"underline",attributes:{style:"text-decoration:underline"}},o,{classType:"highlight",contentTypeValue:"HIGHLIGHT",element:"mark",type:"highlight",attributes:{style:"background-color:#fde892"}},l,i],c=s.reduce(((e,t)=>("altNodeName"in t&&e.push(t.altNodeName),e.push(t.element),e)),[]),d=(e,t)=>"color"!==e||t;t.ZP=s},50554:function(e,t,n){n.d(t,{X:function(){return s}});n(15306),n(27207),n(33948);var r=n(50361),a=n.n(r),o=n(35596),l=n(39146);function i(e,t,n){const r=a()(e),{color:i,text:s,orderedMarks:c}=r,d="code"===n&&s?s:s?s.replaceAll(/\r?\n/g,"<br>"):"";e.text=d;const u=Object.keys(r).filter((e=>l.ZP.find((t=>t.type===e)))),h=[],p=[];let m=[];const g=c||u,f=g.length-1;for(let e=f;e>=0;e-=1){const t=g[e],[n,r,a,o]=[e===f,e===f-1,e>0&&e<f-1,0===e];if(n)p.push({["".concat(t)]:(0,l.aV)(t,i),text:d,orderedMarks:g.slice(-1)});else if(r){(g.length<=2?h:m).push({["".concat(t)]:(0,l.aV)(t,i),children:p,orderedMarks:g.slice(-1)})}else a?(m.push({["".concat(t)]:(0,l.aV)(t,i),children:[...m],orderedMarks:g.slice(-1)}),m=m.slice(-1)):o&&h.unshift({["".concat(t)]:(0,l.aV)(t,i),children:m,orderedMarks:g.slice(-1)})}const v=g.length<=1?e:h[0],E=l.ZP.find((e=>null!=v[e.type]));if(E||v.children){const e={marksToUse:g,node:v,...E,serialize:t};return"color"===(null==E?void 0:E.type)&&(e.attributes={style:"color:".concat(null==i?void 0:i.toLowerCase())}),(0,o.U)(e)}return d}const s=(e,t)=>i(e,i,t)},72506:function(e,t,n){n.d(t,{Z:function(){return l}});n(33948);var r=n(53148),a=n(27949),o=n(25518);function l(e){const[t,n]=(0,a.Z)({store:o.Z,actions:r.Z,onGetState:t=>t.getByFactId(e)});return[t,n]}},91781:function(e,t,n){n(33948),n(99244);var r=n(85945),a=n(98596),o=n(64469);const l=new(n(27998).Z),i=e=>{let{draftId:t,collaborators:n,message:r}=e;return l.post({path:"/drafts/".concat(t,"/collaborators"),body:{collaborators:n,...r&&{message:r}}})};t.ZP=e=>{var t;const n=(0,r.NL)(),s="draftCollaborators",{data:c,isLoading:d,fetchNextPage:u,hasNextPage:h}=(0,a.N)([s,e],(t=>(e=>{let{eligible:t,search:n,draftId:r,token:a}=e;const o=t||n||a;return l.getPaginated({path:"/drafts/".concat(r,"/collaborators"),...o&&{queryParams:{...t&&{eligible:t},...n&&{search:n},...a&&{token:a}}}})})({...e,token:t.pageParam})),{getNextPageParam:e=>null==e?void 0:e.token}),p=(0,o.D)(i,{onSuccess:t=>{t&&(n.setQueryData([s,e],(e=>((e,t)=>{if(!e)return;const n=e.pages[0].data,r=e.pages[0].token;if(t.length>0&&!r){const r=[...n,...t];return{...e,pages:[{...e.pages[0],data:r}]}}})(e,t))),e.onPostSuccess&&e.onPostSuccess())}});return{draftCollaboratorsLoading:d,draftCollaborators:null!==(t=null==c?void 0:c.pages.flatMap((e=>e.data)))&&void 0!==t?t:[],addCollaborators:p.mutate,fetchNextPageOfContributors:u,hasNextPageOfContributors:h}}},69209:function(e,t,n){n.d(t,{Z:function(){return m}});n(33948);var r=n(2514),a=n(47421),o=n(29857),l=n(24839),i=n(25108);const s=o.Z.getFlux().dispatcher,c=new r.Z({name:l.Z.getName(),boundActions:{updateLocalChanges(e,t){s.dispatch({type:a.default.UPDATE_DRAFT_LIST,payload:{factId:e,updates:t}})}}}),d=o.Z.getFlux().actions[c.name];d||i.error("error creating actions");var u=d,h=n(12713),p=n(47111);function m(e){let{filterId:t=h.GLOBAL,queryParams:n,preventOnLoad:r=!1}=e;const[a,o]=(0,p.Z)({filterId:t,store:l.Z,actions:u,onMustLoad:e=>{r||e.get({queryParams:n})}});return[a,o]}},54793:function(e,t,n){n(33948);var r=n(1708),a=n(12713),o=n(47111),l=n(61067);t.Z=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.GLOBAL;const[t,n]=(0,o.Z)({filterId:e,store:l.Z,actions:r.Z});return[t,n]}},14092:function(e,t,n){n.d(t,{ZP:function(){return s}});var r=n(67294),a=n(81510),o=n(59426),l=n(53970);const i=e=>{let t="handle";const n=e.keyCode;e.ctrlKey&&(t+="Ctrl"),e.altKey&&(t+="Alt"),e.shiftKey&&(t+="Shift"),e.metaKey&&(t+="Meta");return t+(e=>{const t=o.MW[e];if(t)return-1!==["Shift","Ctrl","Alt"].indexOf(t)?"":t;return e})(n)};function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{disableListener:t=!1}=e,n=(0,l.I)();(0,r.useEffect)((()=>{function r(t){const n=i(t),r=e[n];r&&r(t)}return a.ZP.isExtension()&&n&&!t&&n.addEventListener("keydown",r,!0),t||document.body.addEventListener("keydown",r,!0),()=>{a.ZP.isExtension()&&n?n.removeEventListener("keydown",r,!0):document.body.removeEventListener("keydown",r,!0)}}),[t])}},36930:function(e,t,n){let r;n.d(t,{l:function(){return r}}),function(e){e.user="user",e.group="user-group"}(r||(r={}))},85731:function(e,t,n){var r=n(65185),a=n(71942);t.Z=e=>{let{anchor:t,target:n}=e;(0,a.Z)({anchor:t,target:n,preferredXPosition:r.R3,offsetYAmount:8})}},46440:function(e,t,n){n.d(t,{d:function(){return l},o:function(){return o}});var r=n(67294),a=n(25108);const o=(0,r.createContext)({newCardActionButtons:[],existingCardActionButtons:[],isPublishMenuOpen:!1,setIsPublishMenuOpen:e=>a.warn("No handler provided for setIsPublishMenuOpen ".concat(e)),handlePublish:()=>a.warn("No handler provided for handlePublish")}),l=()=>(0,r.useContext)(o)},57174:function(e,t,n){n(33948);var r=n(67294),a=n(94184),o=n.n(a),l=n(45697),i=n.n(l),s=n(32950),c=n(11609),d=n(92528),u=n(66934),h=n(22663),p=n(27008),m=n(57682);function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}class f extends r.Component{render(){const{renderMenu:e,closePopover:t}=this.props;return e({closeMenu:t})}}const v=(0,u.Z)((0,d.Z)(f));class E extends r.Component{constructor(){super(...arguments),this.closeMenu=()=>{const{popoverIsOpen:e,closePopover:t}=this.props;e&&t()},this.toggleMenu=()=>{const{popoverIsOpen:e,closePopover:t,openPopover:n}=this.props;e?t():n()},this.handleClickOutside=()=>this.closeMenu(),this.setPopoverAnchorTarget=e=>s.Z.mergeData(this.props.popoverFilterId,{anchorProps:{poll:!0,target:e,sameWidthAsTarget:!0}})}componentWillUnmount(){const{closePopover:e}=this.props;e()}render(){const{id:e,className:t,disabled:n,renderSelectedItem:a,renderDropdown:l,renderDropdownToggleIcon:i,renderReloader:s,renderMenu:c,popoverFilterId:d,popoverIsOpen:u}=this.props,h=o()("ghq-Dropdown",t,{"ghq-is-disabled":n}),p=o()("ghq-Dropdown__selected-item",{"ghq-is-expanded":u});return r.createElement("div",g({className:h,ref:this.setPopoverAnchorTarget},this.props["data-testid"]&&{"data-testid":this.props["data-testid"]}),l?l({toggle:this.toggleMenu,isOpen:u}):r.createElement("div",{id:e,className:p,onClick:this.toggleMenu,onKeyPress:this.toggleMenu},a({isOpen:u}),i({isOpen:u})),s&&s({isOpen:u}),r.createElement(v,{popoverFilterId:d,renderMenu:c}))}}const b=(0,h.Z)((0,u.Z)(E));b.SelectedItem=function(e){let{label:t,icon:n,image:a,placeholder:o,firstName:l,lastName:i}=e;const s=p.Z.getUsersInitials({firstName:l,lastName:i}),d=Boolean(a||s);return r.createElement(r.Fragment,null,n&&r.createElement(c.Z,{icon:n,size:18,className:"ghq-Dropdown__selected-item-icon"}),d&&r.createElement(m.Z,{className:"ghq-Dropdown__selected-item-image",size:m.Z.sizes.XSMALL,src:a,initials:s,alt:p.Z.getNameFromModel({firstName:l,lastName:i})}),t&&r.createElement("span",{className:"ghq-Dropdown__selected-item-label"},t),!t&&o&&r.createElement("span",{className:"ghq-Dropdown__selected-item-placeholder"},o))},t.Z=b,E.propTypes={className:i().string,disabled:i().bool,popoverFilterId:i().string.isRequired,popoverIsOpen:i().bool.isRequired,openPopover:i().func.isRequired,closePopover:i().func.isRequired,renderSelectedItem:i().func,renderMenu:i().func},E.defaultProps={className:"",disabled:!1,renderSelectedItem:()=>{},renderDropdownToggleIcon:()=>{},renderMenu:()=>{}},b.SelectedItem.propTypes={placeholder:i().string,label:i().oneOfType([i().string,i().node]),firstName:i().string,lastName:i().string,icon:i().string,image:i().string,"data-testid":i().string},b.SelectedItem.defaultProps={placeholder:"Choose...",label:"",firstName:"",lastName:"",icon:"",image:"","data-testid":null}},64925:function(e,t,n){n.d(t,{Z:function(){return G}});n(33948);var r=n(67294),a=n(94184),o=n.n(a),l=n(11609),i=n(81510),s=n(27356),c=n(77110),d=n(72506),u=n(2514),h=n(29857),p=n(84801),m=n(12713),g=n(27171);p.Z.register(m.CardsPaths,{GET:{path:"/cards/:cardId/paths"}});const f=new g.Z({name:m.CardsPaths,syncFilters:!1,dataType:m.OBJECT});f.createStore();var v=h.Z.addStore(f.store),E=n(25108);const b=new u.Z({name:v.getName()}),y=h.Z.getFlux().actions[b.name];y||E.error("Error creating actions");var C=y,N=n(47111);var T=e=>{let{cardId:t,isOnOneBoard:n}=e;const[a,o]=(0,N.Z)({filterId:t,store:v,actions:C,onMustLoad:e=>n&&t&&e.get({pathVars:[t]})});return r.useEffect((()=>{n||a.status===c.S.NotLoaded||o.resetFilter()}),[a.status,n]),[a,o]};let S;!function(e){e.BoardGroup="BOARD_GROUP",e.Board="BOARD",e.Section="SECTION"}(S||(S={}));var k=n(17563),x=n(1918);var L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";return e.length<=t?e:e.substring(0,t).concat(n)},_=n(32838);var I=e=>{let{cardId:t,title:n,to:a}=e,o=a;if(t){const e=a.split("?");let n={};e[1]&&(n=k.parse(e[1])),o="".concat(e[0],"?").concat(k.stringify({...n,activeCard:t}))}return r.createElement("div",{"data-testid":"breadcrumb-link-container",className:"ghq-BreadcrumbLink"},r.createElement(_.Z,{to:o,type:_.q.LowPriority,ariaLabel:n,title:n,onClick:()=>x.Z.transitionTo(o)},L(n)))},w=n(45697),M=n.n(w),P=n(73935),D=n(32950),A=n(33200),O=n(65185),R=n(66934),Z=n(70793),q=n(92528),F=n(22265);class B extends r.PureComponent{constructor(){super(...arguments),this.renderBoardTitle=e=>{const t=(0,i.p1)()?"".concat(s.FX).concat(F.Z.Boards,"/").concat(e.slug):"".concat(F.Z.Boards,"/").concat(e.slug),n=e.home?r.createElement(l.Z,{className:"ghq-CardBreadcrumbMultipleBoardsPopover__board-icon",icon:"collection-filled",color:this.props.collectionColor,size:16}):r.createElement(l.Z,{className:"ghq-CardBreadcrumbMultipleBoardsPopover__board-icon",icon:"folder",size:16}),a="home"===e.id?"".concat(e.title," (home)"):e.title;return r.createElement("div",{key:e.slug,className:"ghq-CardBreadcrumbMultipleBoardsPopover__board"},n,r.createElement(I,{title:a,to:t}))}}render(){const{boards:e,clickable:t,anchorYPosition:n,onMouseLeave:a,onMouseEnter:l}=this.props,i=n===O.ZP.BOTTOM,s=o()("ghq-CardBreadcrumbMultipleBoardsPopover",{"ghq-is-clickable":t,"ghq-is-bottom-aligned":i});return r.createElement("div",{className:s,onMouseLeave:a,onMouseEnter:l},i&&r.createElement("div",{className:"ghq-CardBreadcrumbMultipleBoardsPopover__top-pointer"}),r.createElement(Z.Z,null,e.map((e=>this.renderBoardTitle(e)))),!i&&r.createElement("div",{className:"ghq-CardBreadcrumbMultipleBoardsPopover__bottom-pointer"}))}}var H=(0,q.Z)(B);B.propTypes={boards:M().arrayOf(M().shape({slug:M().string,title:M().string})),clickable:M().bool,anchorYPosition:M().string,onMouseLeave:M().func},B.defaultProps={boards:[],clickable:!1,onMouseLeave:()=>{}};var U=n(95587);class z extends r.PureComponent{constructor(){super(...arguments),this.setPopoverAnchorTarget=e=>{const{popoverFilterId:t}=this.props;D.Z.mergeData(t,{anchorProps:{target:e,preferredXPosition:O.ZP.CENTER,preferredYPosition:O.ZP.TOP}})},this.getPopoverReference=e=>{this.popover=e},this.isHoveringPopover=()=>{var e;const t=P.findDOMNode(null===(e=this.popover)||void 0===e?void 0:e.findRootDecoratedComponentReference());if(!t)return!1;const n=Array.from(A.ZP.APP_ELEMENT.querySelectorAll(":hover"));return!!n.length&&n.some((e=>e===t||t.contains(e)))},this.openPopover=()=>{const{openPopover:e}=this.props;clearTimeout(this.timeout),e()},this.closeIfNotHoveringPopover=()=>{const{closePopover:e}=this.props;this.timeout=window.setTimeout((()=>{this.isHoveringPopover()||e()}),250)},this.handleMouseEnter=()=>{const{onMouseEnter:e}=this.props;e()},this.handleMouseLeave=()=>{const{closePopover:e,onMouseLeave:t}=this.props;e(),t()}}render(){const{boards:e,collectionColor:t,clickable:n,popoverFilterId:a}=this.props;return r.createElement("span",{ref:this.setPopoverAnchorTarget,className:"ghq-CardBreadcrumbMultipleBoards",onMouseEnter:this.openPopover,onMouseLeave:this.closeIfNotHoveringPopover},r.createElement("span",{className:"ghq-CardBreadcrumbMultipleBoards__divider"}," \u203a "),r.createElement("span",{className:"ghq-CardBreadcrumbMultipleBoards__text"},U.Z.hasNavarchyPhaseTwoAllowed()?"in multiple locations":"on multiple Boards"),r.createElement(H,{ref:this.getPopoverReference,collectionColor:t,popoverFilterId:a,clickable:n,boards:e,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter}))}}var V=(0,R.Z)(z);z.propTypes={popoverFilterId:M().string.isRequired,openPopover:M().func.isRequired,closePopover:M().func.isRequired,clickable:M().bool,boards:M().arrayOf(M().shape({title:M().string}))},z.defaultProps={clickable:!1,boards:[],onMouseEnter:()=>{},onMouseLeave:()=>{}};var Y=n(34928);class j extends r.PureComponent{constructor(){super(),this.renderSingleBoard=()=>{const{boards:e,clickable:t}=this.props,{title:n,slug:a}=e[0],l=(0,i.p1)()?"".concat(s.FX).concat(F.Z.Boards,"/").concat(a):"".concat(F.Z.Boards,"/").concat(a),c=o()("ghq-CardBreadcrumbBoardSection",{"ghq-is-clickable":t});return r.createElement("span",{className:c},r.createElement("span",{className:"ghq-CardBreadcrumbBoardSection__divider"}," \u203a "),r.createElement(I,{title:"home"in e[0]?"".concat(n," (home)"):n,to:l}))},this.popoverFilterId=(0,Y.z)("CardBreadcrumbBoardSection")}render(){const{boards:e,collectionColor:t,clickable:n,cardOpenPopover:a,cardClosePopover:o,renderEmpty:l}=this.props;return 0===e.length?U.Z.hasNavarchyPhaseTwoAllowed()?null:l():1===e.length?this.renderSingleBoard():r.createElement(V,{clickable:n,collectionColor:t,boards:e,popoverFilterId:this.popoverFilterId,onMouseEnter:a,onMouseLeave:o})}}j.propTypes={clickable:M().bool,boards:M().arrayOf(M().shape({title:M().string,slug:M().string}))},j.defaultProps={boards:[],clickable:!1,renderEmpty:()=>null};const W=e=>{let{path:t,paths:n}=e;if(!t)return"";const{slug:r,type:a}=t;switch(a){case S.BoardGroup:return(0,i.p1)()?"".concat(s.FX).concat(F.Z.BoardGroups,"/").concat(r):"".concat(F.Z.BoardGroups,"/").concat(r);case S.Board:return(0,i.p1)()?"".concat(s.FX).concat(F.Z.Boards,"/").concat(r):"".concat(F.Z.Boards,"/").concat(r);case S.Section:const e=n.find((e=>e.type===S.Board)),t=null==e?void 0:e.slug;return(0,i.p1)()?"".concat(s.FX).concat(F.Z.Boards,"/").concat(t,"/?").concat(r):"".concat(F.Z.Boards,"/").concat(t,"/?").concat(r)}};var G=e=>{var t,n,a;let{id:u,cardClosePopover:h,cardOpenPopover:p,className:m="",clickable:g=!1,collectionColor:f="",collectionName:v="",collectionSlug:E="",renderEmpty:b=(()=>null),small:y=!1}=e;const[C,N]=(0,d.Z)(u),S=C.data,[k]=T({cardId:u,isOnOneBoard:1===S.length}),x=null!==(t=null===(n=k.data)||void 0===n||null===(a=n.paths)||void 0===a?void 0:a[0].elements)&&void 0!==t?t:[],L=C.status===c.S.Loaded,_=k.status===c.S.Loaded,w=L&&_&&1===(null==S?void 0:S.length),M=o()("ghq-CardBreadcrumb",m,{"ghq-is-small":y});r.useEffect((()=>{C.status===c.S.NotLoaded&&N.loadFactBoards(u)}),[C.status]);return r.createElement("div",{className:M},r.createElement("span",{className:"ghq-CardBreadcrumb__collection"},(()=>{const e=(0,i.p1)()?"".concat(s.FX).concat(F.Z.Collections,"/").concat(E):"".concat(F.Z.Collections,"/").concat(E);return y?r.createElement(l.Z,{tooltipped:{message:v,preferredXPosition:"center",preferredYPosition:"top"},className:"ghq-CardBreadcrumb__collection-icon",icon:"collection",size:12,color:f}):r.createElement(I,{to:e,title:v})})()),w?x.map(((e,t)=>{const{name:n}=e;return r.createElement(r.Fragment,{key:t},r.createElement("span",{className:"ghq-CardBreadcrumb__divider"}," \u203a "),r.createElement(I,{cardId:u,title:n,to:W({path:e,paths:x})}))})):L?r.createElement(j,{cardOpenPopover:p,cardClosePopover:h,clickable:g,boards:S,collectionColor:f,renderEmpty:b}):r.createElement("span",{className:"ghq-CardBreadcrumb__placeholder"}," \u203a ..."))}},95879:function(e,t,n){n.d(t,{Z:function(){return v}});var r=n(67294),a=n(1070),o=n(13483),l=n.n(o),i=n(27361),s=n.n(i),c=n(42584),d=n(4439),u=n(73443),h=n(13921),p=n(61038),m=n(39429);class g extends r.Component{render(){const{before:e,after:t,oldVersionNumber:n,newVersionNumber:a,loading:o,currentVersion:l,lastTrustedVersion:i}=this.props;return o?r.createElement("div",{className:"ghq-CardDiff"},r.createElement("div",{className:"ghq-CardDiff__loader"},r.createElement(m.ZP,null))):r.createElement("div",{className:"ghq-CardDiff"},r.createElement("div",{className:"ghq-CardDiff__section"},r.createElement("div",{className:"ghq-CardDiff__section-label"},0===n?"Original":"Revision #".concat(n),n===l&&" (Current Version)",n===i&&" (Last Verified Version)"),r.createElement("div",{className:"ghq-CardDiff__section-content ghq-card-content"},r.createElement("div",{className:"ghq-CardDiff__section-content-html",dangerouslySetInnerHTML:{__html:e}}))),r.createElement("div",{className:"ghq-CardDiff__section"},r.createElement("div",{className:"ghq-CardDiff__section-label"},0===a?"Original":"Revision #".concat(a),a===l&&" (Current Version)",a===i&&" (Last Verified Version)"),r.createElement("div",{className:"ghq-CardDiff__section-content ghq-card-content"},r.createElement("div",{className:"ghq-CardDiff__section-content-html",dangerouslySetInnerHTML:{__html:t}}))))}}var f=(0,h.ey)((0,d.Z)(((e,t)=>{let{id:n}=t;const r=p.Z.getState(),a=p.Z.getById(n),o=s()(r,"data.cardDiff.removedVersion",""),i=s()(r,"data.cardDiff.addedVersion",""),{before:d,after:h}=l().diff_dual_pane((0,u.wg)(s()(o,"data.preferredPhrase",""),s()(o,"data.content","")),(0,u.wg)(s()(i,"data.preferredPhrase",""),s()(i,"data.content","")),"ghq-CardDiff__modifier");return{before:d,after:h,newVersionNumber:s()(i,"data.version","")-1,oldVersionNumber:s()(o,"data.version","")-1,loading:o.status!==c.LOADED||i.status!==c.LOADED,lastTrustedVersion:s()(a,"data.lastVerified.data.version",0)-1,currentVersion:s()(a,"data.cardVersions[0].version",0)-1}}))([p.Z],g));var v=e=>{let{onClose:t}=e;return r.createElement(a.Z,{className:"ghq-card-diff-modal",preventEscape:!0,handleClickClose:t},r.createElement(f,null))}},52341:function(e,t,n){n(33948);var r=n(67294),a=n(3486),o=n(13011),l=n(54975),i=n(27008),s=n(57682),c=n(86429),d=n(32838),u=n(21650),h=n(7350),p=n(20369);t.Z=e=>{let{fact:t}=e;const{getTrackEventData:n}=(0,p.Z)(),{lastVerifiedBy:m,lastVerified:g}=t,[f]=(0,o.Z)(a.Z.EXTENSION_PROFILES_ALLOWED);if(!g||!m)return null;const{id:v,firstName:E,lastName:b,email:y,profilePicUrl:C}=m,{onClick:N,to:T}=(0,l.k)(v,f),S=i.Z.getPersonalName(m),k=i.Z.getNameFromModel(m);return r.createElement("div",{className:"ghq-VerifierText"},r.createElement(c.Z,{size:s.Z.sizes.LARGE,profilePictureSrc:C,firstName:E,lastName:b,email:y,url:T,trackEvent:n({activitySubtype:p.Y.VerifierDetails,userId:y}),onClick:N}),r.createElement(u.ZP,null,"Last verified by"," ",r.createElement(d.Z,{type:d.q.MediumPriority,title:k,to:T,trackEvent:n({activitySubtype:p.Y.VerifierDetails,userId:y}),onClick:N},S),r.createElement("br",null),"on"," ",r.createElement("strong",null,r.createElement(h.Z,{date:g}))))}},43714:function(e,t,n){n.d(t,{Z:function(){return L}});var r=n(67294),a=n(94184),o=n.n(a),l=n(27361),i=n.n(l),s=n(30381),c=n.n(s),d=n(35874),u=n(11514),h=n(21112),p=n.n(h),m=n(42584),g=n.n(m),f=n(4439),v=n(13921),E=n(95879),b=n(61038),y=n(31223),C=n(95587),N=n(27008);var T=e=>{let{onClick:t,children:n}=e;return r.createElement("button",{className:"TextLinkButton-sage",type:"button",onClick:t},n)},S=n(7350);class k extends r.Component{constructor(e){super(e),this.state={cardDiffOpen:!1},this.escKeyPress=e=>{"Escape"===e.key&&(this.setState({cardDiffOpen:!1}),e.stopPropagation())},this.openCardDiffModal=()=>{this.cardRef.current.addEventListener("keydown",this.escKeyPress),this.setState({cardDiffOpen:!0})},this.closeCardDiffModal=()=>{this.cardRef.current.removeEventListener("keydown",this.escKeyPress,!0),this.setState({cardDiffOpen:!1})},this.showDiff=()=>{const{id:e,lastTrustedVersion:t,currentVersion:n}=this.props;d.Z.addCardDiff(e,t,n),this.openCardDiffModal()},this.renderVerificationText=()=>{const{fact:e,verifierName:t,canEdit:n}=this.props;var a=e.data||e,o=N.Z.getPersonalName(a.verificationInitiator),l=N.Z.getPersonalName(a.lastModifiedBy);const s=c().utc(a.verificationInitiationDate).format(),d=a?a.verificationState:null,u=a?a.verificationReason:null,h=a?a.verificationType:null,m=h===p().verificationIntervalType.ABSOLUTE?c().utc(i()(e,"data.nextVerificationDate")):c()(i()(e,"data.nextVerificationDate"));if(d===g().TRUSTED)return r.createElement("div",{className:"ghq-verify-reason-trusted"},r.createElement("p",null,"This Card will remain verified until")," ",r.createElement(S.Z,{date:m}));const f="This Card is unverified.";return a.lastVerified?u===g().UPDATE?r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,f)),r.createElement("div",null,r.createElement("em",null,l," edited it on ",r.createElement(S.Z,{date:s})))):u===g().NEW_VERIFIER?t?r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,f)),r.createElement("div",null,r.createElement("em",null,o," reassigned this Card to ",t," on"," ",r.createElement(S.Z,{date:s})))):r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,f)),r.createElement("div",null,r.createElement("em",null,"The previous verifier has been removed."))):u===g().REQUESTED?r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,f)),r.createElement("div",null,r.createElement("em",null,"Verification requested by ",o," on"," ",r.createElement(S.Z,{date:s})))):!u&&h===p().verificationIntervalType.ABSOLUTE&&n?r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,f)),r.createElement("div",null,r.createElement("em",null,"It expired on ",r.createElement(S.Z,{date:m}),". You\u2019ll need to schedule a new verification interval before Verifying."))):u?null:r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,f)),r.createElement("div",null,r.createElement("em",null,"It expired on ",r.createElement(S.Z,{date:m}),"."))):r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement("strong",null,f)),r.createElement("div",null,r.createElement("em",null,"This Card has not been verified since it was created.")))},this.cardRef=r.createRef()}componentDidMount(){this.props.onMount()}componentDidUpdate(){this.props.onUpdate()}render(){const{cardDiffOpen:e}=this.state,{fact:t,currentVersion:n,lastTrustedVersion:a,isSyncedNoVerification:l}=this.props,i=t.data||t,s=o()("ghq-verify-reason",{"ghq-has-knowledge-sync-verifiers":C.Z.hasKnowledgeSyncVerifiers()});return C.Z.hasKnowledgeSyncVerifiers()&&l?r.createElement("span",{className:o()("ghq-CardHeaderVerificationSyncInfo__status-text",{"ghq-has-knowledge-sync-verifiers":C.Z.hasKnowledgeSyncVerifiers()})},"This Card is Synced."):r.createElement("div",{className:s,ref:this.cardRef},r.createElement("span",null,this.renderVerificationText()),r.createElement("div",{className:"Verification-reason__text"},-1!==n&&-1!==a&&n!==a&&i.verificationState===g().NEEDS_VERIFICATION&&r.createElement(T,{onClick:this.showDiff},"View changes")),e&&r.createElement(E.Z,{onClose:this.closeCardDiffModal}))}}function x(e,t){let{history:n}=t;n&&n.status!==g().NOT_LOADED||u.Z.loadCardHistory(e)}var L=(0,v.ey)((0,f.Z)((function(e,t){let{fact:n}=t;const r=n.id.startsWith("new-")?n.data.id:n.id,a=b.Z.getById(r),o=y.Z.getByFactId(r);return{onMount:()=>x(r,{history:a}),onUpdate:()=>x(r,{history:a}),currentVersion:i()(a,"data.cardVersions[0].version",-1),lastTrustedVersion:i()(a,"data.lastVerified.data.version",-1),canEdit:o.canEdit}}))([b.Z],k))},51710:function(e,t,n){var r=n(67294),a=n(94184),o=n.n(a),l=n(72555),i=n.n(l),s=n(66678),c=n.n(s),d=n(27361),u=n.n(d),h=n(45697),p=n.n(h),m=n(77541),g=n(43396),f=n(40780),v=n(11167),E=n(1747),b=n(81510),y=n(42584),C=n(12713),N=n(14892),T=n(90315),S=n(72431),k=n(6634),x=n(36831),L=n(64804),_=n(13228),I=n(25108);const w=i()({displayName:"OmniSearch",getStoreFilterName(e){switch(e){case C.QuestionCollections:return this.props.questionId.concat(this.props.isAnsweringWithNewCard);case C.UsersCollections:return C.GLOBAL;default:return void I.error("filter not set")}},mixins:[(0,N.Z)(T.Z,S.Z,x.Z,L.Z,k.Z)],_prefixes:[{symbol:"!",searchType:"collections"},{symbol:"#",searchType:"tags"}],propTypes:{refKey:p().string.isRequired,collection:p().object,hideCollection:p().bool,hideHints:p().bool,menuAnchorProps:p().object,autoFocusOpensMenu:p().bool,bannedSearchTypes:p().arrayOf(p().string),boardId:p().string,onSearch:p().func,inputId:p().string,inputPlaceHolderText:p().string,inputPlaceHolderIcon:p().string,isAnsweringWithNewCard:p().bool},getDefaultProps:()=>({collectionId:null,bannedSearchTypes:[],boardId:null,onSearch:()=>{},onInput:()=>{},inputPlaceHolderText:"Search all Cards",inputPlaceHolderIcon:"search",isAnsweringWithNewCard:!1,hideHints:!1}),getInitialState(){const{bannedSearchTypes:e}=this.props;return{chips:[],filteredPrefixes:this._prefixes.filter((t=>!e.includes(t.searchType))),searchType:"text",inputValue:""}},getStateFromFlux(){const{refKey:e,questionId:t}=this.props,n=S.Z.getById(e),r=x.Z.getUsedCategories();return{auth:T.Z.getState(),explicit:n,categories:r,usersCollections:L.Z.getFilter(this.getStoreFilterName(C.UsersCollections)),questionCollections:t?k.Z.getFilter(this.getStoreFilterName(C.QuestionCollections)):{}}},UNSAFE_componentWillMount(){const{auth:e,questionCollections:t,explicit:n}=this.state,{questionId:r,refKey:a,hideCollection:o,collection:l}=this.props,i=c()(this.state.explicit.searchParams),s={usageParams:this._getUsedTagCategoryParams(i),questionId:r};if(f.Z.loadUsedTagCategories(s),t.status===y.NOT_LOADED&&this.getQuestionCollections(),e.status===y.LOADED&&this.getUsersCollections(),l){let{label:e=l.name,id:t,color:r}=l;const i={label:e,id:t,color:r,icon:"collection",iconSize:10,chipType:"collection"};if(!o){let e=[i];this.setState({chips:e})}const{searchParams:s,collectionIds:c}=n,d=this._chipToSearchParam(i);0===s.length&&s.push({}),s.splice(s.length-2,0,d),s[s.length-1]={type:"text",value:""};const u={usageParams:this._getUsedTagCategoryParams(s)};u.collectionIds=c.push(d.value.id),m.Z.setSearchParams(a,s),f.Z.loadUsedTagCategories(u)}},UNSAFE_componentWillUpdate(e,t){const{auth:n,searchType:r}=this.state,{auth:a,searchType:o,explicit:l}=t,{questionId:i,refKey:s}=this.props,{questionId:d}=e;i!==d&&this.getQuestionCollections();const u=S.Z.getSearchFilter(s);if(!d&&u.collectionIds.length<2&&r!==o&&"collections"!==o){const e=c()(l.searchParams),t={usageParams:this._getUsedTagCategoryParams(e),collectionId:u.collectionIds[0],questionId:i};f.Z.loadUsedTagCategories(t)}n.status!==y.LOADED&&a.status===y.LOADED&&this.getUsersCollections(a)},componentWillUnmount(){const{refKey:e}=this.props;m.Z.setSearchParams(e,[])},getUsersCollections(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.auth;v.Z.get(this.getStoreFilterName(C.UsersCollections),{pathVars:[e.data.email]})},getQuestionCollections(){const{questionId:e,isAnsweringWithNewCard:t}=this.props;e&&g.Z.get(this.getStoreFilterName(C.QuestionCollections),{pathVars:[e],queryParam:{isAnsweringWithNewCard:t.toString()}})},handleInputChange(e){const{refKey:t,onInput:n}=this.props,r=this._getSearchType(e),a=c()(this.state.explicit.searchParams);"text"===r&&(0===a.length?a.push({type:"text",value:e}):a[a.length-1]={type:"text",value:e},m.Z.setSearchParams(t,a)),this.setState({searchType:r,inputValue:e}),n(e)},_getUsedTagCategoryParams(e){let{boardId:t}=this.props;const n=[],r=[];return e.forEach((e=>{"tag"===e.type&&n.push(e.value.id),"tagcategory"===e.type&&r.push(e.value.id)})),null===t&&(t=""),{boardId:t,tagIds:n.join(","),categoryIds:r.join(",")}},_getCollectionMenuItems(){const{usersCollections:e,questionCollections:t}=this.state,{questionId:n}=this.props;return(n?t.items.editData:e.items.data).map((e=>{const t=n?e:e.collection,{name:r,description:a,id:o,color:l}=t;return{label:r,description:a,value:o,icon:"collection",type:"menu-item",meta:{label:r,id:o,color:l,iconSize:14,icon:"collection",chipType:"collection",removeChip:this.removeChip}}}))},_getTagMenuItems(){const{categories:e,chips:t}=this.state,n=[];return t.reduce(((e,t)=>"collection"===t.chipType?e+1:e),0)>1?[]:(e.data.forEach((e=>{const t={label:e.name,value:e.id,id:e.id,icon:null,type:"menu-header"};n.push(t),e.tags.forEach((e=>{const t={label:e.value,value:e.id,type:"menu-item",meta:{label:e.value,id:e.id,icon:"tag",iconSize:14,chipType:"tag",removeChip:this.removeChip}};n.push(t)}))})),n)},_chipToSearchParam:e=>({type:e.chipType,value:{id:e.id,value:e.label}}),_getSearchType(e){const{filteredPrefixes:t}=this.state,n=e.trim();return t.reduce(((e,t)=>{const{symbol:r,searchType:a}=t;return n[0]===r?a:e}),"text")},addChip(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c()(this.state.chips);const{refKey:n}=this.props;let r=c()(this.state.explicit.searchParams);const a=e.meta;if(!a)return;t.push(a);const o=this._chipToSearchParam(a);0===r.length&&r.push({}),r.splice(r.length-2,0,o),r[r.length-1]={type:"text",value:""};const l={usageParams:this._getUsedTagCategoryParams(r)};"collection"===o.type?(l.collectionId=o.value.id,t=t.filter((e=>"collection"===e.chipType)),t=t.map((e=>(e.removeChip=this.removeChip,e))),r=r.filter((e=>"tag"!==e.type&&"category"!==e.type))):t=t.map((e=>("collection"===e.chipType&&delete e.removeChip,e))),m.Z.setSearchParams(n,r),f.Z.loadUsedTagCategories(l),this.search(""),this.setState({chips:t,inputValue:"",searchType:"text",menuItems:[]}),this.props.onInput("")},removeChip(e){const{refKey:t,collection:n}=this.props;let r,a=c()(this.state.chips);a.some((t=>t.id===e&&(r=t,!0)));let o=a.filter((t=>e!==t.id)),l=c()(this.state.explicit.searchParams).filter((t=>t.value.id!==e));if(l[l.length-1]={type:"text",value:""},"collection"===r.chipType)l=l.filter((e=>"tag"!==e.type&&"category"!==e.type)),o=o.filter((e=>"collection"===e.chipType));else{o.every((e=>"collection"===e.chipType))&&!n&&(o=o.map((e=>(e.removeChip=this.removeChip,e))))}const i={usageParams:this._getUsedTagCategoryParams(l)};f.Z.loadUsedTagCategories(i),m.Z.setSearchParams(t,l),this.search(""),this.setState({chips:o,inputValue:"",searchType:"text"}),this.props.onInput("")},search(e){const{refKey:t,onSearch:n,questionId:r,collection:a}=this.props,{filteredPrefixes:o,explicit:l}=this.state;if(o.some((t=>t.symbol===e[0])))return;const{searchParams:i}=l;a&&"collection"!==u()(i,"[0].type")&&(i.unshift({type:"collection",value:{id:a.id,label:a.name}}),m.Z.setSearchParams(t,i)),m.Z.search(t,{questionId:r}),n()},renderHelperMenu(){const{inputValue:e,usersCollections:t,searchType:n}=this.state,{bannedSearchTypes:a,hideHints:l}=this.props,i={},s=this._prefixes.map((e=>e.searchType)).includes(n);if(s&&e===this._prefixes.find((e=>e.searchType===n)).symbol||!s&&""!==e)return null;let c=[];if(s){let e;switch(n){case"collections":e="Collection";break;case"tags":e="Tag"}c.push(r.createElement("li",{className:"ghq-omnisearch__helper-tip",key:1},r.createElement("span",null,e," not found. Please refine your search.")))}else l||(!a.includes("collections")&&t.items.data.length>=2&&c.push(r.createElement("li",{className:"ghq-omnisearch__helper-tip",key:1},r.createElement("span",null,"! - Search By Collection"))),a.includes("tags")||c.push(r.createElement("li",{className:"ghq-omnisearch__helper-tip",key:3},r.createElement("span",null,"# - Search By Tags"))));if(c.length){const e=o()("ghq-omnisearch__helper-menu",{"ghq-is-extension":b.ZP.isExtension()}),t=s?null:r.createElement("p",{className:"omnisearch__heading"},"Refine your search:");i.rawContent=r.createElement("div",{key:"omniempty",className:e},t,r.createElement("ul",null,c))}return i},render(){const{refKey:e,inputId:t,inputPlaceHolderText:n,inputPlaceHolderIcon:a,focusOnMount:o,menuAnchorProps:l,className:i,autoFocusOpensMenu:s,onMouseDown:c}=this.props,{auth:d,chips:u,inputValue:h,searchType:p,filteredPrefixes:m}=this.state,g=_.Z.isOnExpiredTrial(d);let f=[];"tags"===p?f=this._getTagMenuItems():"collections"===p&&(f=this._getCollectionMenuItems());const v=m.map((e=>e.symbol)),b=this.renderHelperMenu();return r.createElement(E.Z,{className:i,chips:u,handleAction:this.search,handleInputChange:this.handleInputChange,handleMenuItemSelect:this.addChip,handleBlur:this.handleOnBlur,handleFocus:this.handleOnFocus,inputValue:h,isDisabled:g,clearInput:this.handleClearInput,menuItems:f,refKey:e+"OmniSearchChipInput",noResultsItem:b,ignoredStartingCharacters:v,inputId:t,inputPlaceHolderText:n,inputPlaceHolderIcon:a,menuAnchorProps:l,focusOnMount:o,autoFocusOpensMenu:s,onMouseDown:c})}});t.Z=w},61067:function(e,t,n){var r=n(84801),a=n(12713),o=n(29857),l=n(27171);r.Z.register(a.FactsCardViewStats,{POST:{path:"/facts/:cardId/cardviewstats"}});const i=new l.Z({name:a.FactsCardViewStats,syncFilters:!1,dataType:a.OBJECT});i.createStore(),t.Z=o.Z.addStore(i.store)},61038:function(e,t,n){var r=n(4199),a=n.n(r),o=n(29857),l=n(4322),i=n(25512),s=n(25108),c=n(47421),d=n(42584);const u={cardDiff:{removedVersion:{},addedVersion:{}},cardHistories:{data:{}}};var h=a().createStore({getName:function(){return"CardHistoryStore"},initialize:function(){this._cardHistory=i.Z.create().setData(u).setStatus(d.NOT_LOADED),this._helper=new l.Z(this),this.bindActions(c.LOAD_CARD_HISTORY_START,this.onLoadCardHistoryStart,c.LOAD_CARD_HISTORY_COMPLETE,this.onLoadCardHistoryComplete,c.LOAD_CARD_HISTORY_ERROR,this.onLoadCardHistoryError,c.LOAD_CARD_HISTORY_LAST_VERIFIED_START,this.onLoadCardHistoryLastVerifiedStart,c.LOAD_CARD_HISTORY_LAST_VERIFIED_COMPLETE,this.onLoadCardHistoryLastVerifiedComplete,c.LOAD_CARD_HISTORY_LAST_VERIFIED_ERROR,this.onLoadCardHistoryLastVerifiedError,c.LOAD_CARD_HISTORY_VERSION_START,this.onLoadCardHistoryVersionStart,c.LOAD_CARD_HISTORY_VERSION_COMPLETE,this.onLoadCardHistoryVersionComplete,c.LOAD_CARD_HISTORY_VERSION_ERROR,this.onLoadCardHistoryError,c.DISCARD_CARD_DIFF,this.onDiscardCardDiff,c.LOGOUT,this.clear)},getState:function(){return this._cardHistory.clone()},getById:function(e){var t=this._helper.findById(e,this._cardHistory.data.cardHistories);return t&&(t=t.clone()),t},onLoadCardHistoryStart:function(e){var t=this._helper.findById(e.cardId,this._cardHistory.data.cardHistories);t?t.status=d.LOADING:(t=i.Z.create().setId(e.cardId).setStatus(d.LOADING).setData({id:e.cardId,lastVerified:{}}),this._cardHistory.data.cardHistories.data[e.cardId]=t),this._helper.onChange()},onLoadCardHistoryComplete:function(e){var t=this._helper.findById(e.context.cardId,this._cardHistory.data.cardHistories);t&&(t.data.cardVersions=e.data,t.status=d.LOADED),this._helper.onChange()},onLoadCardHistoryError:function(e){this._cardHistory.error=e,s.error("GOT CARD HISTORY ERROR",e),this._helper.onChange()},onLoadCardHistoryLastVerifiedStart:function(e){var t=this._helper.findById(e.cardId,this._cardHistory.data.cardHistories);t?t.data.lastVerified.status=d.LOADING:(t=i.Z.create().setId(e.cardId).setStatus(d.LOADING).setData({id:e.cardId,lastVerified:{status:d.LOADING}}),this._cardHistory.data.cardHistories[e.cardId]=t),this._helper.onChange()},onLoadCardHistoryLastVerifiedComplete:function(e){var t=this._helper.findById(e.context.cardId,this._cardHistory.data.cardHistories);t&&(t.data.lastVerified.data=e.data,t.data.lastVerified.status=d.LOADED),this._helper.onChange()},onLoadCardHistoryLastVerifiedError(e){const t=this._helper.findById(e.context.cardId,this._cardHistory.data.cardHistories);t&&(t.data.lastVerified.data={},t.data.lastVerified.status=d.LOADED),this._helper.onChange()},onLoadCardHistoryVersionStart:function(e){("removed"===e.version?this._cardHistory.data.cardDiff.removedVersion:this._cardHistory.data.cardDiff.addedVersion).status=d.LOADING,this._helper.onChange()},onLoadCardHistoryVersionComplete:function(e){var t;(t="removed"===e.context.version?this._cardHistory.data.cardDiff.removedVersion:this._cardHistory.data.cardDiff.addedVersion).data=e.data,t.status=d.LOADED,this._helper.onChange()},onDiscardCardDiff:function(){this._cardHistory.data.cardDiff={removedVersion:{},addedVersion:{}},this._helper.onChange()},clear:function(){this._cardHistory=i.Z.create().setData(u),this._helper.onChange()}});t.Z=o.Z.addStore(new h)},28642:function(e,t,n){var r=n(12713),a=n(29857);const o=new(n(27171).Z)({name:r.CardsLite,syncFilters:!1});o.createStore(),t.Z=a.Z.addStore(o.store)},49768:function(e,t,n){var r=n(12713),a=n(29857);const o=new(n(27171).Z)({name:r.GroupMembers,syncFilters:!1});o.createStore(),t.Z=a.Z.addStore(o.store)},6634:function(e,t,n){var r=n(12713),a=n(29857);const o=new(n(27171).Z)({name:r.QuestionCollections,syncFilters:!1});o.createStore(),t.Z=a.Z.addStore(o.store)},1164:function(e,t,n){n.d(t,{a8:function(){return l},sJ:function(){return i}});var r=n(67294),a=n(94184),o=n.n(a);let l,i,s;!function(e){e.Action="action",e.Default="default",e.Notice="notice"}(l||(l={})),function(e){e.Short="short",e.Tall="tall"}(i||(i={})),function(e){e.Full="full",e.Content="content"}(s||(s={}));t.ZP=e=>{let{spacing:t=i.Tall,type:n=l.Default,width:a=s.Full,children:c}=e;const d=o()("Callout-sage","Callout-sage--".concat(t),"Callout-sage--".concat(n),"Callout-sage--".concat(a));return r.createElement("div",{className:d,tabIndex:0},c)}},97061:function(e,t,n){n.d(t,{Fy:function(){return R},sI:function(){return g},Jq:function(){return A},ZP:function(){return Z}});n(33948);var r=n(67294),a=n(94184),o=n.n(a);var l=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;const a=r.useRef();r.useEffect((()=>{a.current=t}),[t]),r.useEffect((()=>{if(!(n&&n.addEventListener))return;const t=e=>a.current(e);return n.addEventListener(e,t),()=>{n.removeEventListener(e,t)}}),[e,n])},i=n(76030),s=n(65680),c=n(26965),d=n(48863),u=n(71942),h=n(45578),p=n.n(h);let m,g,f;!function(e){e.Mellow="mellow"}(m||(m={})),function(e){e.Small="small",e.Medium="medium"}(g||(g={})),function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"}(f||(f={}));const v=e=>Array.isArray(e);var E=e=>{let{model:t,value:n,isMultiSelect:r,isSearchable:a,filterTerm:o,isFilteredServerSide:l}=e;if(!(r||a&&o))return{isEmpty:!1,filteredOptions:t.options,isGroupFiltered:()=>!1,isOptionFiltered:()=>!1};let i=[];v(n)?i=n:i.push(n);const s={},c=[];t.options.forEach((e=>{const t=(e=>{let{option:t,filterTerm:n,isMultiSelect:r,selectedValues:a,isFilteredServerSide:o}=e,l=!1;return n&&!o&&(l=!t.label.toLowerCase().includes(n.toLowerCase())),r&&(l=l||a.some((e=>e===t.value))),l})({option:e,filterTerm:o,isMultiSelect:r,selectedValues:i,isFilteredServerSide:l});t||c.push(e),s[e.value]=t}));const d=e=>s[e],u={};t.groups.forEach((e=>{u[e.label]=e.options.every((e=>d(e.value)))}));return{isEmpty:c.length<1,filteredOptions:c,isGroupFiltered:e=>u[e],isOptionFiltered:d}};const b=r.createContext({}),y=()=>r.useContext(b);var C=e=>{let{name:t,requiresValue:n,listboxId:a,isDisabled:o,placeholder:l,isMultiSelect:i,isSearchable:s,enableUserDefinedOptions:c,handleUserDefinedOption:d,value:u,model:h,dropdownState:m,setDropdownState:g,focusTrigger:v,onChange:y,onChangeAppend:C,onOptionsChanged:N,children:T,isFilteredServerSide:S}=e;const{isExpanded:k,filterTerm:x,focusIndex:L,selectedOption:_,selectedMultiOptions:I}=m,{isEmpty:w,isGroupFiltered:M,isOptionFiltered:P,filteredOptions:D}=E({model:h,value:u,isMultiSelect:i,isSearchable:s,filterTerm:x,isFilteredServerSide:S}),A=D[L];return r.createElement(b.Provider,{value:{name:t,listboxId:a,requiresValue:n,selectOption:e=>{if(i){const t=null!=e&&e.value?p()([...I,e],"value"):p()([...I,...e],"value");g((e=>({...e,selectedMultiOptions:t,filterTerm:""}))),y(t.map((e=>e.value)))}else g((t=>({...t,selectedOption:e,focusIndex:D.findIndex((t=>e.value===t.value)),isExpanded:!1,filterTerm:""}))),y(e.value);v()},selectedMultiOptions:I,selectedOption:_,removeOption:e=>{if(!I.length)return;const t=[...I.slice(0,e),...I.slice(e+1)];g((e=>({...e,selectedMultiOptions:t,isExpanded:!0,focusIndex:0}))),y(t.map((e=>e.value)))},isExpanded:k,isDisabled:o,placeholder:l,filterTerm:x,isMultiSelect:i,isEmpty:w,isGroupFiltered:M,isOptionFiltered:P,isSearchable:s,value:u,focusIndex:L,focusedOption:A,updateFocus:e=>{const t=0===L,n=L===D.length-1;if(e===f.Up&&t||e===f.Down&&n)return;let r=L+e;g((e=>({...e,focusIndex:r})))},updateFocusToOption:e=>{g((t=>({...t,focusIndex:D.findIndex((t=>t.value===e))})))},selectOptionWithEnter:()=>{if(w&&!c&&!i)return;const e=D[L];if(i){const t=d(x).map((e=>({label:e,value:e})));let n;if(c&&!e&&!t.length)return;e?n=[e]:c&&t.length&&(n=t);const r=p()([...I,...n],"value");g((e=>({...e,selectedMultiOptions:r,focusIndex:e.focusIndex===D.length-1?e.focusIndex-1:e.focusIndex,filterTerm:""}))),c&&t.length?C(r.map((e=>e.value))):y(r.map((e=>e.value)))}else g((t=>({...t,selectedOption:e,focusIndex:D.findIndex((t=>e.value===t.value)),isExpanded:!1,filterTerm:""}))),y(e.value)},filteredOptions:D,setDropdownState:g,onOptionsChanged:N}},T)};var N=e=>{let{children:t,labelId:n,maxPopoverHeight:a,parentRef:l,emptyState:i="No matches were found"}=e;const{isExpanded:s,isEmpty:c,listboxId:d}=y(),h=o()("SelectDropdownPopover-sage","SelectDropdownPopover-sage--has-height-".concat(a),{"SelectDropdownPopover-sage--is-hidden":!s}),p=(0,r.useRef)();return(0,u.Z)({anchor:p,offsetYAmount:2,target:l,sameWidthAsTarget:!0}),r.createElement("div",{className:h,ref:p,onMouseDown:e=>{e.stopPropagation()}},c?r.createElement("span",{className:"SelectDropdownPopover-sage__no-matches"},i):r.createElement("ul",{id:d,"aria-labelledby":n,tabIndex:-1,role:"listbox",className:"SelectDropdownPopover-sage__options"},t))},T=n(57682),S=n(81371);var k=()=>{const{selectedOption:e,selectedMultiOptions:t,requiresValue:n,removeOption:a,isExpanded:o,isSearchable:l,isMultiSelect:i,filterTerm:c}=y(),d=!l||l&&!o&&!c,u=Boolean(e.avatar||e.initials)&&d,h=Boolean(e.icon)&&d;return i?r.createElement(r.Fragment,null,t.map(((e,t,o)=>{const l=!(n&&1===o.length);return r.createElement("span",{className:"SelectDropdownPrepend-sage",key:"".concat(e.value,"-").concat(t),onKeyDown:e=>{"Backspace"!==e.key&&"Delete"!==e.key||(e.preventDefault(),l&&a(t))}},r.createElement(S.ZP,{removable:l,iconPrependage:e.icon,onClick:()=>l?a(t):null},e.label))}))):u?r.createElement("span",{className:"SelectDropdownPrepend-sage"},r.createElement(T.Z,{alt:e.avatarDescription,initials:e.initials,size:T.Z.sizes.XSMALL,src:e.avatar})):h?r.createElement("span",{className:"SelectDropdownPrepend-sage"},r.createElement(s.Z,{icon:e.icon})):null},x=n(87159);var L=()=>{const{isSearchable:e,isMultiSelect:t,requiresValue:n,selectedMultiOptions:r,removeOption:a,isExpanded:o,filterTerm:l,updateFocus:i,selectOptionWithEnter:s,setDropdownState:c}=y();return d=>{switch(d.key){case x.R.Enter:d.preventDefault(),o?s():c((e=>({...e,isExpanded:!0})));break;case x.R.Comma:d.preventDefault(),o?e&&s():c((e=>({...e,isExpanded:!0})));break;case x.R.Space:o?e||s():c((e=>({...e,isExpanded:!0})));break;case x.R.Escape:d.preventDefault(),c((e=>({...e,isExpanded:!1,filterTerm:""})));break;case x.R.ArrowUp:d.preventDefault(),o?i(f.Up):c((e=>({...e,isExpanded:!0})));break;case x.R.ArrowDown:d.preventDefault(),o?i(f.Down):c((e=>({...e,isExpanded:!0})));break;case x.R.Backspace:case x.R.Delete:if(t&&!l){if(n&&1===r.length)return;a(r.length-1)}}}};const _=r.forwardRef(((e,t)=>{const{isMultiSelect:n,selectedMultiOptions:a,name:o,selectedOption:l,placeholder:i,isExpanded:s,isDisabled:c}=y(),d=L();let u="";if(n)u=a.length<1?i:"";else{const{label:e}=l;u=e||i}return r.createElement("button",{className:"SelectDropdownTrigger-sage","data-testid":"selectDropdownTrigger-sage",type:"button",id:o,ref:t,"aria-haspopup":"listbox","aria-expanded":s,disabled:c,onKeyDown:d},r.createElement("span",null,u))})),I=r.forwardRef(((e,t)=>{const{isMultiSelect:n,name:a,listboxId:o,isDisabled:l,selectedOption:i,selectedMultiOptions:s,isExpanded:c,filterTerm:d,placeholder:u,setDropdownState:h}=y(),{label:p}=i,m=L(),g="filter_for_dropdown_".concat(a);return r.createElement("input",{"aria-expanded":c,"aria-owns":o,"aria-haspopup":"listbox",role:"combobox","aria-autocomplete":"list","aria-controls":o,className:"SelectDropdownTrigger-sage",id:a,ref:t,autoComplete:"off",name:g,value:d,placeholder:n?s.length>0?"":u:p?c?"":p:u,type:"text",disabled:l,onChange:e=>{const{value:t}=e.target;h((e=>({...e,filterTerm:t,focusIndex:0,isExpanded:!0})))},onKeyDown:m})}));var w=r.forwardRef(((e,t)=>{const{isSearchable:n}=y();return n?r.createElement(I,{ref:t}):r.createElement(_,{ref:t})})),M=n(31745),P=n(47191);const D=e=>Array.isArray(e)?e.filter((e=>e&&"string"==typeof e)).join(""):e,A=e=>{const{value:t,isOptionFiltered:n,isMultiSelect:a,selectOption:l,setDropdownState:i,selectedOption:s,selectedMultiOptions:c,focusedOption:d,updateFocusToOption:u,isExpanded:h,onOptionsChanged:p,filterTerm:m}=y(),{avatar:g,avatarDescription:f,children:v,hasSeparator:E,icon:b,iconColor:C,customColor:N,initials:T,value:S}=e,k=t===S,x=S===(null==d?void 0:d.value);(0,r.useLayoutEffect)((()=>{if(a){var e;const n=t.indexOf(S);n>-1&&(null===(e=c[n])||void 0===e?void 0:e.value)!==S&&i((e=>{const t=[...e.selectedMultiOptions];return t[n]={avatar:g,avatarDescription:f,icon:b,initials:T,label:D(v),value:S},{...e,selectedMultiOptions:t}}))}else t!==s.value&&t===S&&i((e=>({...e,selectedOption:{avatar:g,avatarDescription:f,icon:b,initials:T,label:D(v),value:S}})))}),[t]),(0,r.useLayoutEffect)((()=>()=>{p()}),[]),(0,r.useLayoutEffect)((()=>{m!==v||k||l({avatar:g,avatarDescription:f,icon:b,initials:T,label:D(v),value:S})}),[m]);const L=r.useRef();(0,M.Z)(L.current,x&&h,{block:"nearest"});const _=o()("SelectDropdownOption-sage",{"SelectDropdownOption-sage--separated":E});return n(S)?null:r.createElement("li",{ref:L,className:_,role:"option","aria-selected":k,onMouseEnter:()=>{u(S)},onFocus:()=>{u(S)}},r.createElement(P.gs,{active:x,avatar:g,avatarDescription:f,checked:k,icon:b,iconColor:C,customColor:N,initials:T,onClick:()=>{l({avatar:g,avatarDescription:f,icon:b,initials:T,label:D(v),value:S})}},v))};var O=e=>{let{children:t,value:n}=e;const a=[],o={options:[],groups:[]},l=new Set,i=new Set;let s=0;const c=e=>{if(l.has(e.value))throw new Error("All option values must be unique");if(l.add(e.value),o.options.push(e),v(n)){const t=n.indexOf(e.value);t>-1&&(a[t]=e)}else e.value===n&&(a.push(e),s=o.options.length-1)};return r.Children.forEach(t,(e=>{if((e=>{var t;return!(null==e||null===(t=e.props)||void 0===t||!t.value)})(e)){const t=e,n={avatar:t.props.avatar,avatarDescription:t.props.avatarDescription,icon:t.props.icon,initials:t.props.initials,label:D(t.props.children),value:t.props.value};c(n)}else if((e=>{var t;return!(null==e||null===(t=e.props)||void 0===t||!t.label)})(e)){const t=e;if(i.has(t.props.label))throw new Error("All group labels must be unique");i.add(t.props.label);const n={label:e.props.label,options:r.Children.map(t.props.children,(e=>{const t={avatar:e.props.avatar,avatarDescription:e.props.avatarDescription,icon:e.props.icon,initials:e.props.initials,label:D(e.props.children),value:e.props.value};return c(t),t}))};o.groups.push(n)}})),{model:o,focusIndex:s,selectedOptions:a}};const R=e=>{let{children:t,kind:n,label:a}=e;const{name:l,isGroupFiltered:i}=y(),s="select_dropdown_".concat(l,"_").concat(a),c=o()("SelectDropdownGroup-sage",{["SelectDropdownGroup-sage--".concat(n)]:!!n});return i(a)?null:r.createElement("li",{className:c},r.createElement("div",{className:"SelectDropdownGroup-sage__label"},r.createElement("label",{htmlFor:s},a)),r.createElement("ul",{id:s,role:"group",className:"SelectDropdownGroup-sage__options"},t))};var Z=e=>{let{children:t,disabled:n=!1,errorMessage:a="",helperText:u,highlightOnEmpty:h,label:p,labelAppendage:m,maxPopoverHeight:f=g.Medium,multiSelect:E=!1,name:b,onBlur:y=(()=>{}),onChange:T,onChangeAppend:S=(()=>{}),onInputChange:x=(()=>{}),placeholder:L="",required:_=!1,requiresValue:I=!1,requirementLabel:M,searchable:P=!1,enableUserDefinedOptions:D=!1,handleUserDefinedOption:A=(()=>[]),persistFilterTerm:R=!1,serverSideFiltering:Z=!1,value:q,emptyState:F}=e;const[B,H]=(0,r.useState)({isExpanded:!1,filterTerm:"",focusIndex:0,selectedOption:{value:"",icon:void 0,label:""},selectedMultiOptions:[]}),U=r.useRef(q),z=v(q);if(E&&!z)throw new Error("Multi-select dropdown requires an array value");const V=z?q.length>0:Boolean(q),Y=r.useRef(),j=()=>{var e;return null===(e=Y.current)||void 0===e?void 0:e.focus()},W=r.useRef(null);l("mousedown",(e=>{var t;null!==(t=W.current)&&void 0!==t&&t.contains(e.target)||H((e=>({...e,isExpanded:!1})))}));const G=o()("SelectDropdown-sage FormControl-sage",{"FormControl-sage--is-disabled":n,"SelectDropdown-sage--has-errors":Boolean(a)&&!B.isExpanded,"SelectDropdown-sage--has-value":V,"SelectDropdown-sage--is-expanded":B.isExpanded,"SelectDropdown-sage--highlight-on-empty":h&&!V}),K=r.useRef({options:[],groups:[]}),$=r.useRef(!0),Q=Z&&t;(0,r.useLayoutEffect)((()=>{$.current=!1;const{model:e,focusIndex:n,selectedOptions:r}=O({children:t,value:q});K.current=e,H((e=>{const t={...e,focusIndex:Z?e.focusIndex:n};return E&&Z&&!q.length&&U.current!==q?t.selectedMultiOptions=[]:E&&!Z?t.selectedMultiOptions=r:Boolean(r[0])&&(t.selectedOption=r[0]),t})),U.current=q}),[$.current,Q]),(0,r.useEffect)((()=>{P&&x(B.filterTerm),Z&&H((e=>({...e,focusIndex:0})))}),[B.filterTerm]);const J="select_dropdown_label_".concat(b),X="select_dropdown_listbox_".concat(b);return r.createElement("div",{className:G},r.createElement(C,{name:b,requiresValue:I,listboxId:X,isDisabled:n,placeholder:L,isMultiSelect:E,isSearchable:P,enableUserDefinedOptions:D,handleUserDefinedOption:A,value:q,model:K.current,dropdownState:B,setDropdownState:H,focusTrigger:j,isFilteredServerSide:Z,onChange:T,onChangeAppend:S,onOptionsChanged:()=>{$.current=!0}},r.createElement(c.Z,{id:J,requirementLabel:M,label:p,name:b,labelAppendage:m}),r.createElement("div",{ref:W,className:"SelectDropdown-sage__container FormControl-sage__container","aria-disabled":n?"true":void 0,onMouseDown:e=>{e.preventDefault(),n||(B.isExpanded?H((e=>({...e,isExpanded:!1}))):H((e=>({...e,isExpanded:!0}))),j())},onBlur:e=>{!e.currentTarget.contains(e.relatedTarget)&&(H((e=>({...e,isExpanded:!1,filterTerm:R?e.filterTerm:""}))),y(q))},onFocus:e=>{!e.currentTarget.contains(e.relatedTarget)&&(H((e=>({...e,filterTerm:R?e.filterTerm:""}))),y(q))}},r.createElement(k,null),r.createElement(w,{ref:Y}),r.createElement("span",{className:"SelectDropdown-sage__caret"},r.createElement(s.Z,{icon:B.isExpanded?i.Z.ChevronUp:i.Z.ChevronDown,size:20})),r.createElement(N,{labelId:J,maxPopoverHeight:f,parentRef:W,emptyState:F},t)),r.createElement("input",{readOnly:!0,disabled:n,name:b,required:_,tabIndex:-1,type:"hidden",value:q}),r.createElement(d.Z,{text:a||u,hasErrors:Boolean(a)})))}},95394:function(e,t,n){var r=n(67294),a=n(94184),o=n.n(a),l=n(16790),i=n(26965),s=n(38362),c=n(48863);const d=(0,r.forwardRef)(((e,t)=>{var n;let{disabled:a,errorMessage:d,helperText:u,label:h,labelAppendage:p,name:m,onFocus:g=(()=>{}),onBlur:f=(()=>{}),onChange:v=(()=>{}),onChangeWithEvent:E,onKeyDown:b,placeholder:y="",maxCharacterCount:C,characterCountErrorMessage:N="Please use ".concat(C," characters or less."),required:T,requirementLabel:S,autofocus:k=!1,useVisuallyHiddenLabel:x=!1,value:L}=e;const _=null!==(n=null==L?void 0:L.trim())&&void 0!==n?n:"",I=!!C&&_.length>C,w=Boolean(d)||I,M=r.createRef(),P=r.useRef(),D=I?N:Boolean(d)?d:u;(0,r.useEffect)((()=>{M.current&&(P.current=M.current.scrollHeight)}),[M.current]),(0,r.useEffect)((()=>{if(M.current){const e=""===L?P.current:M.current.scrollHeight;M.current.style.height="".concat(e,"px")}}),[L]);const A=o()("TextArea-sage FormControl-sage",{"FormControl-sage--required":T,"FormControl-sage--is-disabled":a,"FormControl-sage--has-errors":w,"FormControl-sage--has-character-count":C});return r.createElement("div",{className:A},x?r.createElement(l.Z,null,r.createElement(i.Z,{labelAppendage:p,requirementLabel:S,label:h,name:m})):r.createElement(i.Z,{labelAppendage:p,requirementLabel:S,label:h,name:m}),r.createElement("div",{className:"FormControl-sage__container"},r.createElement("textarea",{autoFocus:k,ref:M,className:"FormControl-sage__input TextArea-sage__input",id:m,value:L,disabled:a,"aria-required":T,placeholder:y,onFocus:g,onBlur:e=>f(e.target.value),onChange:e=>{e.persist(),E?E(e):v(e.target.value)},onKeyDown:b}),r.createElement(s.Z,{hasErrors:I,value:_,maxCount:C})),r.createElement(c.Z,{text:D,hasErrors:w}))}));t.Z=d},7350:function(e,t,n){var r=n(67294),a=n(91857),o=n(49599),l=n(58654);t.Z=e=>{let{date:t,hideCurrentYear:n=!1,withTime:i=!1}=e;try{const e="object"==typeof t||"number"==typeof t?t:(e=>{const t=e.split("T")[1],n=(null==t?void 0:t.indexOf("-"))>0?"-":"+",r=null==t?void 0:t.split(n)[1];if(t&&null!=r&&r.length&&(null==r?void 0:r.indexOf(":"))<=0){const t=n.concat([r.slice(0,2),":",r.slice(2)].join(""));return e.slice(0,e.lastIndexOf(n)).concat(t)}return e})(t),s=new Date(e),c=n&&0===(0,a.Z)(Date.now(),s)?"MMM dd":"MMM dd, yyyy",d="h:mm a";if((0,o.Z)(s))return r.createElement("time",{className:"SageTheDate-sage",dateTime:s.toUTCString()},(0,l.Z)(s,c)," ",i?"at ".concat((0,l.Z)(s,d)):null);throw new Error("Invalid date provided")}catch(e){return window.Rollbar.error("".concat(e,": ").concat(t)),null}}},20369:function(e,t,n){n.d(t,{Y:function(){return o}});var r=n(23525),a=n(97374);let o;!function(e){e.AnnouncementUserStats="announcement-user-stats",e.AnnouncementDetails="announcement-details",e.AuthorList="author-list",e.CardHeaderAuthor="card-header-author",e.CardDetails="card-details",e.CardHistory="card-history",e.CommentDetails="comment-details",e.GroupMemberList="group-member-list",e.MembersList="members-list",e.TopVerifiers="top-verifiers",e.TopAuthors="top-authors",e.VerifierList="verifier-list",e.VerifierDetails="verifier-details",e.MyLibraryRecommendations="my-library-recommendations",e.MyLibraryFollowedAuthors="my-library-followed-authors"}(o||(o={}));t.Z=()=>{const{buildEventData:e}=(0,a.Z)();return{getTrackEventData:t=>{let{activitySubtype:n,profileId:a,userId:o}=t;return e(r.default.PROFILE_VIEWED,{activitySubtype:n,activityMetaData:[{featureName:"people_profiles",data:{profileId:a,userId:o}}]})}}}}}]);