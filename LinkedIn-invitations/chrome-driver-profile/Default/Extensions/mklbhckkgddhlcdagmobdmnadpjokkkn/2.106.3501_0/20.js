"use strict";(self.webpackChunkguru_ui=self.webpackChunkguru_ui||[]).push([[20],{79266:function(e,t,r){r.r(t),r.d(t,{KCSReportItem:function(){return I},KCSReports:function(){return k},getPlatformFromSource:function(){return S}});r(33948);var s=r(67294),n=r(94184),i=r.n(n),o=r(27361),a=r.n(o),c=r(30381),d=r.n(c),l=r(67411),p=r(70724),h=r(7364),u=r(11609),v=r(46745),m=r(91512),g=r(4439),f=r(46763),P=r(10744),E=r(17233),w=r(27008),Z=r(23525);class I extends s.Component{constructor(){super(...arguments),this.state={isDetailsToggled:!1},this.toggleDetails=()=>{this.setState({isDetailsToggled:!this.state.isDetailsToggled})}}render(){const{isDetailsToggled:e}=this.state,{item:t,index:r}=this.props,n=w.Z.getNameFromModel(t.user);return s.createElement("div",{className:"ghq-KnowledgeReports__card-item"},s.createElement(f.Z,{activity:Z.default.KCS_FACT_OPENED,key:r,id:t.card.id,fact:t.card,popoverFilterId:"".concat(t.card.id,"-popover-kcs-preview")}),s.createElement("div",{className:"ghq-KnowledgeReports__details-label",onClick:this.toggleDetails},"Details",s.createElement(u.Z,{icon:e?"chevron-down":"chevron-right",size:16})),s.createElement(h.Z,{open:e},s.createElement("div",{className:"ghq-KnowledgeReports__accordion-text"},s.createElement("div",null,s.createElement("span",null,s.createElement("b",null,"Linked By: ")," ",n)),s.createElement("div",null,s.createElement("b",null,"Date:")," "," ".concat(d()(t.date).format("MMM D YYYY"))))))}}class k extends s.Component{constructor(){super(...arguments),this.componentDidMount=()=>{const{kcsId:e,platform:t}=this.props;t&&p.Z.get(e,{queryParams:{conversationId:e,platform:t}})},this.componentDidUpdate=e=>{this.props.kcsId&&this.props.platform&&e.kcsId!==this.props.kcsId&&p.Z.get(this.props.kcsId,{queryParams:{conversationId:this.props.kcsId,platform:this.props.platform}})},this.onEnterWaypoint=()=>{const{linkHeader:e,kcsId:t,platform:r}=this.props;r&&p.Z.get(t,{queryParams:{conversationId:t,platform:r},linkHeader:e})},this.renderReports=()=>{const{kcsId:e,linkedCards:t,linkHeader:r}=this.props;if(null===e)return s.createElement("div",{className:"ghq-KnowledgeReports__subtext ghq-warning"},"Open a ticket in your customer support tool, and the Cards linked to that ticket will populate here.");if(0===t.length)return s.createElement("div",{className:"ghq-KnowledgeReports__subtext"},"No Cards were linked to this ticket.");{const n=t.map(((e,t)=>s.createElement(I,{item:e,index:t,key:e.card.id})));return r&&n.push(s.createElement(l.h,{key:e+"waypoint",onEnter:this.onEnterWaypoint})),n}}}render(){const{kcsId:e,source:t}=this.props,r=i()("ghq-KnowledgeReports__ticket-id",{"ghq-no-ticket":null===e});return s.createElement("div",{className:"ghq-KnowledgeReports"},s.createElement("div",{className:"ghq-KnowledgeReports__title"},"Ticket Linking Reports"),s.createElement("div",{className:r},null!==e?"".concat(t," #").concat(e):"No ticket found."),this.renderReports())}}function S(e){switch(e){case v.ZP.LIVEPERSON:return m.ZP.LIVEPERSON;case v.ZP.ZENDESK:return m.ZP.ZENDESK;case v.ZP.SALESFORCE:return m.ZP.SALESFORCE;default:return null}}t.default=(0,g.Z)((()=>{const e=P.Z.getFilter("KCSScrape"),{meta:{source:t=null,conversationId:r=null}}=e,s=E.Z.getFilter(r),{items:{data:n=[]}}=s;return{kcsId:r,source:t,linkedCards:n,linkHeader:a()(s,'linkHeaders["next-page"]',!1),platform:S(t)}}))([P.Z,E.Z],k)},70724:function(e,t,r){var s=r(2514),n=r(29857),i=r(17233),o=r(25108);const a=new s.Z({name:i.Z.getName()}),c=n.Z.getFlux().actions[a.name];c||o.error("error creating actions"),t.Z=c},46763:function(e,t,r){r.d(t,{Z:function(){return R}});r(33948);var s=r(67294),n=r(94184),i=r.n(n),o=r(45697),a=r.n(o),c=r(73935),d=r(31439),l=r(32950),p=r(81510),h=r(65185),u=r(30065),v=r(54159),m=r(42584),g=r.n(m),f=r(66934),P=r(4439),E=r(47400);class w extends s.Component{constructor(){super(...arguments),this.renderListCard=()=>s.createElement(E.Z,this.props)}render(){return this.renderListCard()}}var Z=w,I=r(24839),k=r(47482),S=r(95587),y=r(5257),C=r(91717),N=r(25686);function D(){return D=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},D.apply(this,arguments)}function _(e){return e===v.Z.DRAFTS}class O extends s.Component{constructor(){super(...arguments),this.state={showPreview:!1,hovered:!1},this.setShowPreview=e=>{const{allowPreview:t,fact:r,previewMessage:s,preferences:n,savedSearchId:i}=this.props,o=(0,C.bS)(n);if(t&&!_(i)){if(e){const e=c.findDOMNode(this),t=e.getBoundingClientRect(),n=e.offsetParent?e.offsetParent.getBoundingClientRect().left:t.left,i=e.offsetParent?e.offsetParent.getBoundingClientRect().right:t.right,{top:a}=t;d.Z.loadPreview(r,!1,r.searchTerm,s,{relativeLeft:o===u.e7?n-10:null,relativeRight:o===u.XB?i+10:null,relativeTop:a})}else d.Z.discardPreview();this.setState({showPreview:e})}},this.isAlreadyOpen=()=>{const{fact:e,cards:t}=this.props,r=t.data[e.id];return!!r&&r.meta.open},this.handleMouseEnter=()=>{const{allowPreview:e,fact:t,openPopover:r,savedSearchId:s}=this.props;this.setState({hovered:!0}),p.ZP.isExtension()&&!_(s)&&(this.isAlreadyOpen()?d.Z.focusFact(t.id):e&&p.ZP.isExtension()&&(this.debouncedOpen=window.setTimeout((()=>{r()}),750)))},this.handleMouseLeave=()=>{const{closePopover:e,savedSearchId:t}=this.props;this.setState({hovered:!1}),p.ZP.isExtension()&&!_(t)&&(this.debouncedOpen&&(window.clearTimeout(this.debouncedOpen),this.debouncedOpen=null),e())},this.renderListDisplayElement=()=>{const{fact:e,activity:t,activityId:r,searchId:n,searchSessionId:i,searchPosition:o,popoverFilterId:a,previewMessage:c,...d}=this.props;return n?s.createElement(Z,{searchId:n,searchSessionId:i,card:e,loadCardMaximized:!p.ZP.isExtension(),activity:t,activityId:r,searchPosition:o,popoverFilterId:a}):s.createElement(E.Z,D({card:e,loadCardMaximized:!p.ZP.isExtension(),activity:t,activityId:r,popoverFilterId:a,previewMessage:c,searchId:n,searchSessionId:i,searchPosition:o},d))},this.setPopoverAnchorTarget=e=>{const{popoverFilterId:t,prefferedPopoverPreviewXPosition:r}=this.props;l.Z.mergeData(t,{anchorProps:{target:e,preferredXPosition:r,preferredYPosition:h.ru}})}}componentDidUpdate(){const{showPreview:e}=this.state;e&&this.isAlreadyOpen()&&this.setShowPreview(!1)}componentWillUnmount(){this.setShowPreview(!1)}render(){const{className:e,fact:t}=this.props,r=i()("ghq-factlist-container",e,"ghq-NewListDisplayCard__container-search-results"),n=!t.status||![g().NOT_LOADED,g().LOADING].includes(t.status),o=this.renderListDisplayElement();return s.createElement("div",{className:r,"data-testid":"Previewable Card",onFocus:()=>{},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},s.createElement("div",{ref:n?this.setPopoverAnchorTarget:()=>{},className:"ghq-NewListDisplayCard__inner-container"},o,s.createElement(N.FN,{className:"ghq-NewListDisplayCard__toast",filter:"PreviewableCard-".concat(t.id)})))}}var R=(0,P.Z)(((e,t)=>{const{activity:r,activityId:s,searchId:n,searchSessionId:i,searchPosition:o,fact:a,savedSearchId:c}=t,l=y.Z.getState();return{cards:k.ZP.getState(),preferences:l,onEdit:()=>{if(!k.ZP.isOpen(a.id))return d.Z.openFact(a.id,{activity:r,activityId:s,searchId:n,searchSessionId:i,searchPosition:o,editing:!0,maximized:!p.ZP.isExtension()});d.Z.setAction(a.id,g().EDITING,{needsEditFact:!0})},hideActions:_(c)}}))([I.Z,k.ZP,S.Z,y.Z],(0,f.Z)(O));O.propTypes={allowPreview:a().bool,hideActions:a().bool,prefferedPopoverPreviewXPosition:a().string},O.defaultProps={allowPreview:!1,hideActions:!1,prefferedPopoverPreviewXPosition:h.RL,openPopover:()=>{},closePopover:()=>{}}},17233:function(e,t,r){var s=r(84801),n=r(12713),i=r(29857),o=r(27171);s.Z.register(n.KCSCards,{GET:{path:"/kcs"},POST:{path:"/kcs"},DELETE:{path:"/kcs/:cardId"}});const a=new o.Z({name:n.KCSCards,syncFilters:!1});a.createStore(),t.Z=i.Z.addStore(a.store)}}]);